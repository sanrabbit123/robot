var text = {"title":"아이를 위한 심플 & 컬러풀 스타일, 광교 자연앤자이 38py 홈스타일링","space":"광교 자연앤자이","pyeong":"38","sub_titles":{"main_title":"아이를 위한 심플 & 컬러풀 스타일\n광교 자연앤자이 38py 홈스타일링","main_color_title":"광교 자연앤자이\n38py 홈스타일링","main_color_object":{"main":"#ececec","sub":"#d3d2d0","title":"#606060"},"portivec":{"main":"광교 자연앤자이 38py 홈스타일링","sub":"아이를 위한 심플 스타일, 광교 자연앤자이 홈스타일링","region":"경기 수원시","method":"아파트 홈스타일링"},"name_card":{"main":"광교 자연앤자이\n38py 스타일링","sub":"아이를 위한 심플 스타일\n광교 자연앤자이 홈스타일링"},"rev_main_title":"처음 시도해본 홈스타일링\n체계적으로 케어해주셔서 너무 좋았어요!","revivec":{"main":"체계적인 케어가 너무 좋았어요!","sub":"광교 자연앤자이 38py 홈스타일링 후기","hover":"체계적인 케어가 너무 좋았어요!","mobile":"체계적인 케어가\n너무 좋았어요!"},"rev_name_card":{"main":"체계적인 케어가\n너무 좋았어요!","sub":"광교 자연앤자이\n38py 홈스타일링 후기","subsub":"광교 자연앤자이\n홈스타일링 후기"}},"designer":"de028","p_id":"p33","p_info":{"photodae":[14,13],"photosg":{"first":1,"last":29},"slide":"1 2 7 12 13 18 19 24 27","tag":"all,모던,햇살,심플,아파트,내추럴,감성적인,컬러풀,색감있는,감성적인,모빌,텐트,아이방,30평대인테리어,아이방꾸미기,아기자기한,소품,밝은,패브릭","service":"홈스타일링","key8":"800","key9":"200414"},"r_id":"re032","r_info":{"photodae":[20,1],"order":132},"suggestion":"Designer’s\nSuggestion","contents":[{"title":"init","main_contents":"이번에 새로운 아파트로 이사하시게 된 고객님. 인테리어를 딱히 받지 않고 사시다 이번엔 깔끔하고 예쁜 집으로 꾸미고 싶어 문의를 주셨어요. 특히 아이들 방을 꾸며 애기들한테 좋은 집을 제공해주고 싶어 하셨어요. 안방의 가구와 식탁, 아빠방 책장, 책상등은 기존 가구 그대로 사용하길 원하셨고, 합리적인 예산 안에서 공간이 가성비 있게 잘 만들어지길 바라셨죠. 선호하시는 스타일은 엄청 뚜렷하진 않으셨습니다. 일단 소품을 많이 넣지 않고, 깔끔하고 따뜻한 느낌이었으면 좋겠다고 하셨어요.","smalltalk_yn":"","smalltalk_contents":"","photo_key":0},{"title":"bedroom","main_contents":"안방은 침대, 서랍장, 협탁 모두 기존 가구 그대로 사용하길 원하셨어요. 그래서 패브릭과 컬러를 중심으로 디자인해드린 부부 침실입니다. 이 곳의 메인은 커튼부터 시작한 톤 다운 컬러 디자인이에요. 연보라 커튼, 톤 다운된 핑크와 다크 그린 액자, 그레이 탁상시계, 화이트와 블루를 믹스한 베딩, 화이트로 마무리한 협탁 소품까지 이어지는 컬러의 흐름. 이 흐름에서 오는 고급스러운 느낌이 공간에 잘 입혀지도록 스타일링을 진행했어요. 컬러가 많이 들어간 디자인은 과한 느낌을 줄 수 있어서, 베딩의 디자인은 심플하고 깔끔, 절제된 프릴 디자인으로 세팅해드렸습니다.","smalltalk_yn":"+ HomeLiaison's small talk","smalltalk_contents":"쓰던 가구를 그대로 쓴다 하더라도, 공간의 톤 앤 매너 조정을 통해 분위기를 확 바꿀 수 있답니다. 특히 컬러와 텍스처의 세밀한 조정이 받춰준다면 최소한의 비용으로 놀라운 효과를 볼 수 있어요. 이러한 과정엔 패브릭이 항상 적극적으로 활용되는데, 스타일링 디자이너의 패브릭 디자인이 공간 디자인에서 얼마나 중요한 역할을 하는지 잘 보여주는 대목이죠.","photo_key":6},{"title":"kidsbedroom","main_contents":"고객님은 기존 집의 안방에서 가족 4명이 모두 함께 주무셨다고 해요. 그래서 이번 기회에 분리된 공간을 만들어 편히 주무시고 싶다고 하셨습니다. 고객님의 바람을 이루어 드리고자 자녀분들의 나이와 성별을 고려하여 아이들 침실, 놀이방으로 나누어 디자인해드렸어요.\n\n그래서 만들어진 아이들 전용 침실. 전체 컬러를 핑크 톤앤톤으로 사랑스러운 느낌으로 만들고, 방의 큰 부분을 차지하는 침대, 커튼은 오랜 시간 사용하여도 질리지 않는 베이비 핑크톤으로 통일하였어요. 침대는 같은 디자인으로 하고, 베딩은 톤 다운된 핑크 컬러와 플라워 패턴을 믹스하여 전반적인 컬러의 균형을 맞추었습니다. 서로 다른 베딩을 세팅해주어 아이들 각자만의 영역을 만들어 주었어요. 다행히 세팅된 후 아이들이 엄마와 분리되어 각자의 침대에서 너무 잘 잔다고, 고객님도 편히 주무신다고 하시더라구요^^","smalltalk_yn":"+ HomeLiaison's small talk","smalltalk_contents":"아이들을 위한 침실. 안전이 최우선시 되는 아이방인 만큼 반드시 제대로 만들어져야 하는 공간이에요. 장난감으로 범벅이 되어 있는 방에서 아이들이 잘 수는 없겠죠? 그리고 아이들도 그 방 스타일을 좋아해야 잘 잘 수 있기 때문에, 제대로 된 스타일링도 필요해요. 그리고 그렇게 잘 만들어진 공간일수록, 아이들이 더 좋아한답니다 :)","photo_key":11},{"title":"kidsroom","main_contents":"아이들을 위한 두 번째 공간!! 두 아이가 함께 놀이도 하고 공부도 할 수 있는 공간으로 디자인해드렸어요. 침실과는 조금 다른 발랄한 느낌이 나도록 옐로 컬러 커튼과 무지개 행잉, 새모빌, 컬러 달력으로 포인트를 주었습니다. 수납공간 겸 휴식 공간이 될 수 있도록 벤치 쇼파처럼 공간을 활용하였어요.\n\n놀이방이 생기니 아이들이 방에서 공부도 하고, 그림도 그리고, 놀이도 하고, 놀이방에서 머무는 시간이 많아져서 거실의 깨끗함도 유지된다고 너무 좋아하셨어요. 낮잠 잘 시간이라고 말하자 커튼을 치고 벤치 쇼파에 누워 자는 척하는 사랑스러운 아이의 사진과 함께 너무 감사하다는 고객님의 메세지도 받았답니다^^","smalltalk_yn":"+ HomeLiaison's small talk","smalltalk_contents":"아이의 놀이를 위한 별도의 방을 마련하는 건 중요한 일이에요. 아이가 있는 집에는 언제나 정리와 안전이 가장 큰 이슈가 되는데, 잘 디자인된 놀이방이 있다면 관리도 안전도 확실하게 챙길 수 있습니다. 그리고 아이에게 ‘쾌적함’을 제공해주는 것 또한 중요한 일이에요. 어렸을 때부터 형성된 쾌적한 환경에 대한 인식은, 커가면서 생각보다 많은 것에 영향을 주게 되니까요. 이렇게 아이방을 전문가에게 맡긴다는 건 아이를 위한 투자이기도 해요.","photo_key":17},{"title":"livingroom","main_contents":"거실의 전체적인 컬러는 따뜻하고 편안한 느낌을 줄 수 있는 가장 무난한 컬러인 화이트 & 베이지 스타일로 디자인하였어요. 거실은 유아 2명과 함께하는 공간이었기에 아이들의 여유로운 놀이공간 확보와, 안전까지 고려하여 미니멀하게 스타일링했습니다. 소품은 적게 하되 포인트가 될 수 있도록 그림, 인테리어 모빌은 모두 큰 사이즈로 세팅하였어요. 기존에 있던 화분 두 개는 조금 투박한 느낌의 화분이라 작고 여리한 화분을 추가했구요.\n\n처음 고객님께 거실의 쇼파와 협탁을 제외하고 티비장, 장식장은 모두 빼자고 말씀드렸을 땐 당황해하시더라구요. 그래도 이사 갈 집의 기본 붙박이장이 너무 잘 되어 있어서 수납공간이 충분하였기에, 이 부분 안내 후 디자인대로 진행하게 되었어요. 고객님도 세팅이 끝난 후에는 왜 이렇게 하셨는지 알겠다며 너무 만족해하셨구요.\n\n스타일링 중간에 아이들을 위한 텐트가 있었으면 하셔서 세상에 단 하나뿐인 인디언 텐트를 직접 제작해드렸어요. 둘째 아이가 공주공주한 걸 너무 좋아하여 공주공주한 느낌과 거실과도 어울리는 컬러감, 야외에도 사용 가능하신 실용성까지 갖춘 디자인으로 제작해드렸는데, 세팅 첫날 둘째 공주님은 텐트 안에서 안 나오셨다는 고객님의 메세지가ㅎㅎㅎㅎ 뿌듯하네요^^","smalltalk_yn":"+ HomeLiaison's small talk","smalltalk_contents":"심플함과 깨끗함, 그리고 무엇보다 넓어 보이는 느낌이 강하게 나는 거실이에요. 아이를 위한 특별한 텐트도 있어 고객님 집만의 개성도 살아 있는 거실이 되었네요. 디자이너님은 뭔가를 막 놓거나 화려한 시공 없이, 감성적인 디테일로 좋은 공간을 만들어 내셨어요. 소품의 선택과 특별한 제작으로 고객님댁만의 감성을 잘 살려내신 것이죠. 이렇게 홈스타일링을 통한다면 큰 시공 없이 충분히 좋은 공간을 맞이할 수 있답니다. 이제는 인테리어에도 홈스타일링과 같이 스마트하고 효율적인 방법이 필요해요.","photo_key":23},{"title":"kitchen","main_contents":"주방은 기존 식탁을 그대로 사용하시길 원하셔서 시계와 식탁등만 교체하였어요. 소품 하나, 컬러감으로 현관에서 거실, 거실에서 주방, 주방에서 안방 침실까지 이어지는 디자인으로 컨셉을 잡았었습니다. 주방과 안방을 이어줄 수 있는 소품으로 자개 소재를 동일하게 사용하여 공간의 일관성을 잘 맞춰 드렸어요.","smalltalk_yn":"","smalltalk_contents":"","photo_key":27},{"title":"entrance","main_contents":"현관은 집에 들어섰을 때 가장 먼저 반기는 공간으로, 집 전체적인 디자인의 느낌을 함축적으로 보여드리고 싶었던 공간이었어요. 그래서 다른 곳보다 더 많이 공들인 공간이기도 하구요. 소품은 과하지 않으며, 허전한 느낌은 들지 않도록. 따뜻한 감성은 묻어나고, 그림은 유니크하게. 요즘 가장 흔하게 사용되지만 가장 어려운 감성 인테리어 완성하기!! 막상 많은 소품이 들어간 건 아니지만 그 느낌을 만들어내는데 나름 엄청난 고민을 했어요ㅎㅎㅎ 소품의 톤은 화이트 & 베이지 컬러의 거실과 동일한 톤으로 맞추어 거실까지 자연스럽게 이어지도록 하였습니다.\n\n애착이 많이 갔던 현장이라 그런지 유독 제작도 많았던 현장이네요 ㅎㅎ 남편분과 고객님께서 이렇게까지 예쁜 집은 상상도 못 했는데 이런 예쁜 집에서 살 수 있게 해주셔서 감사하다고 말씀해주시는데, 오히려 제가 이런 감사한 표현을 해주신 고객 두 분에게 더 감사했어요. 가끔씩 뜬금없이 고객님께 오는 아이들의 사진과 메세지를 받으면서 더 힘이 났던 현장이었습니다^^","smalltalk_yn":"","smalltalk_contents":"","photo_key":29}],"reviews":[{"type":"init","contents":[{"quest":"","answer":"광교 자연앤자이 38평 아파트로 이사하며 홈스타일링 문의를 주신 채* 고객님, 일반적인 집에서만 살아오시다 이번에 제대로 집을 꾸미고 싶으셨다고 해요. 공간별 맞춤형 홈스타일링을 찾게 되셨고, 문의를 주셨습니다 :) 고객님께서 무엇보다 아이가 잘 자고, 잘 놀 수 있는 아이방을 꾸미고 싶어 하셨어요. 전체적으로 화이트우드 톤의  가구가 활용된 홈스타일링을 원하셨구요. 이 모든 니즈가 체계적으로 진행되어 너무 좋았다는 고객님의 광교 자연앤자이 38평 아파트 홈스타일링 이야기! 소개해드릴게요~"}],"photos":[]},{"type":"contents","contents":[{"quest":"안녕하세요 고객님! 처음으로 홈스타일링을 받아보셨는데, 상상하신 대로 결과물이 잘 나왔나요?","answer":"평소에 인테리어에 관심이 많지 않았어요. 그래서 항상 아주 일반적인 그냥 집에서만 살아왔죠. 하지만 지금 집은 마치 인테리어 디자이너가 사는 집처럼 너무 예뻐요 :) 정말 상상한 대로 결과물이 잘 나와서 너무 좋아요. 무엇보다 아이방을 예쁘게 해주고 싶었는데, 디자이너님이 제 취향과 스타일을 잘 캐치해주셔서 원하는 대로 잘 만들어 주셨어요. 개인적으로도 화이트 톤과 벽난로 모양의 콘솔 장식장에 대한 로망이 있었는데 이번에 그 로망을 실현할 수 있었구요."}],"photos":[1]},{"type":"contents","contents":[{"quest":"디자이너와 함께 진행한 과정은 만족스러운가요?","answer":"만족해요! 특히 저에게 없는 디자이너님의 감각과 센스를 우리집에 입힐 수 있어서 정말 만족스러웠어요. 전체 구성에 알맞게 아이방 소품을 모두 골라주셨고, 거실에 있는 액자 배치만 하더라도 보통은 중앙에 배치하려고 할 텐데, 디자이너님이 모빌과 소품의 위치를 고려해 딱 맞게 배치를 해주시더라구요. 나중엔 디자이너님의 감각이 좋아 그냥 다 믿고 맡길 수 있었고, 예산도 체계적으로 잘 사용할 수 있어 좋았어요!"},{"quest":"홈리에종에서 함께하는 과정은 어떠셨는지 궁금해요.","answer":"무엇보다 깔끔한 느낌이었어요. 전반적으로 상담을 통해 알아서 해주는 방식이었고, 적절할 때에 항상 먼저 챙겨주고 진행해주었어요. 또 예산이 어떻게 쓰일지 상세하고, 친절하게 설명해주신 점도 좋았어요. 제가 가지고 있는 예산을 체계적으로 잘 사용할 수 있을 것 같아 믿음이 갔고, 불안하게 혼자 진행하는 것보단 홈리에종과 함께하는 걸 선택하게 되었어요."}],"photos":[2,5,6]},{"type":"contents","contents":[{"quest":"기존에 가지고 계시던 가구도 많이 활용하셨나요?","answer":"기존 가구도 활용하고, 새로 산 가구와 소품도 많아요. 안방에 있는 침대와 서랍장, 식탁은 기존에 가지고 있었던 가구예요. 반면에 아이방과 놀이방 가구, 쇼파, 조명, 소품, 패브릭은 이번에 새롭게 구매했어요. 처음에는 패브릭과 소품에 이렇게 예산을 써도 되는 건가 싶기도 하고 놀라기도 했는데, 결과물을 보니 이해가 되었어요.\n\n기존 가구를 빼서 좋아진 것도 있었어요. 디자이너님이 기존에 사용하던 거실장을 빼자고 제안해 주셨을 때, 처음에는 의아했는데 거실장을 빼니 거실이 운동장처럼 넓어지게 되더라구요. 이렇게 어떤 것은 활용하고 어떤 것은 잘 버리면서, 전체적으로 쓸 수 있는 기존 가구를 잘 활용한 것 같아요. 새로운 가구도 잘 산 것 같구요!"},{"quest":"아이방이 정말 예뻐요! 이번에 아이방 가구를 새로 구매하게 된 이유가 있으신가요?","answer":"이전 집은 아이방에 가구가 없었어요. 그래서 이번엔 꼭 아이를 위해 좋은 공간을 만들어 주고 싶었어요. 그래서 그 어떤 방보다 더 많은 신경을 쓰게 되었고, 아이들이 잘 자고, 잘 놀 수 있는 집으로 만들어 지기 원했어요. 그래서 아이 침실과 놀이방에서 새로운 가구를 제일 많이 사게 된 것 같아요. 아이들이 자신의 공간을 좋아하고, 아이방 침대가 생기니 분리 수면도 자연스럽게 하고, 놀이방에서 잘 놀고 정리도 잘하게 되어서 너무 좋아요."}],"photos":[13,16,17]},{"type":"contents","contents":[{"quest":"시공은 어떻게 진행하셨나요?","answer":"도배랑 상하부장까지 필름 시공을 진행했어요. 집이 처음엔 샤시부터 몰딩까지 우드톤으로 되어있었어요. 눈에 너무 거슬려서 화이트 톤으로 꼭 바꾸고 싶었죠. 그래서 도배와 필름 시공을 진행하게 되었고, 그 과정에서도 디자이너님의 도움을 많이 받았어요. 처음 예상한 예산보다 조금 더 쓰긴 했지만, 무엇보다 결과물이 제가 원하는 대로 확실하게 나와서 매우 만족하고 있어요!"},{"quest":"아이들과 남편분의 반응도 궁금해요!","answer":"남편은 처음부터 응원해주고, 찬성했어요! 처음으로 인테리어 서비스를 받는 거다 보니, 오히려 저보다 더  기대감을 가지고 있었던 것 같아요. 홈스타일링이 다 완성되고 나서 ‘우리 집 너무 좋은 거 아니야?’라고 하더라고요ㅎㅎ  아이들은 특히 더 좋아해요! 각자 자기 침대를 사용하게 되고, 놀이방도 따로 있으니 크게 만족해하고 있답니다."}],"photos":[7,10,11]},{"type":"contents","contents":[{"quest":"라이프스타일도 변화가 있으셨나요?","answer":"이전 집은 아이방 침실이 따로 있지 않아서 아이들과 함께 잠을 잤었어요. 그래서 제대로 잠을 잔 것 같지 않았는데 지금은 아이방과 놀이방, 각자의 침대가 생기면서 자연스럽게 분리수면을 하게 되었어요. 아이들은 아이들대로 잠을 잘 자고, 저희 부부도 숙면하게 되어서 생활이 더 쾌적해졌어요ㅎㅎ 그리고 아이들도 더 안전하게 놀고, 잘 수 있어서 많이 좋아하고 있어 저도 좋답니다~"},{"quest":"홈스타일링을 고민 중이신 분들에게 조언 한마디 부탁드려요~","answer":"리모델링을 받거나 셀프 인테리어 하려 괜히 애쓰는 것보다, 망설이지 말고 홈스타일링으로 진행하는 것을 추천해요! 어설프게 하는 것보다 전문가에게 맡기니 훨씬 합리적으로 예산을 사용할 수 있었고, 결과물도 좋았어요. 무엇보다 제 시간을 벌 수 있고, 알아서 체계적으로 관리가 되니 편안했습니다 :)"}],"photos":[18,20,21,22,23]}]};

String.prototype.splice = function(start, newStr) { return this.slice(0, start) + newStr + this.slice(start); }

Folder.prototype.get_file = function (index) {
  var ka = this.getFiles();
  var file = app.open(ka[index]);
  file.layer_select = function (m) { return this.layers.getByName(m); }
  file.artboard_select = function (m) { return this.artboards.getByName(m); }
  return file;
}

File.prototype.get_file = function () {
  var file = app.open(this);
  file.layer_select = function (m) { return this.layers.getByName(m); }
  file.artboard_select = function (m) { return this.artboards.getByName(m); }
  return file;
}

var ExecMain = function (text, dir) {
  this.list = [ "desktop", "mobile" ];
  if (dir.slice(-1) !== '/') {
    this.dir = dir + '/';
  } else {
    this.dir = dir;
  }
  this.text = text;
  this.filename = {};
    
  this.folder_list = {
    main: {},
    rev: {},
  }
  this.folder_list.main.string = this.dir + "result/" + this.text.r_id + "code";
  this.folder_list.main.obj = new Folder(this.folder_list.main.string);
  this.folder_list.rev.string = this.dir + "result/" + this.text.r_id + "code/" + this.text.r_id;
  this.folder_list.rev.obj = new Folder(this.folder_list.rev.string);
      
}

var Mother = function () {
}

Mother.prototype.convertMillimeters = function (num) {
  var g = 74.0833 / 210;
  return num / g
}

Mother.prototype.colorpick = function (obj) {
  var newRGBColor = new RGBColor();
  function convert(str) {
    var result = 0;
    switch (str) {
      case "0":
        result = 0;
        break;
      case "1":
        result = 1;
        break;
      case "2":
        result = 2;
        break;
      case "3":
        result = 3;
        break;
      case "4":
        result = 4;
        break;
      case "5":
        result = 5;
        break;
      case "6":
        result = 6;
        break;
      case "7":
        result = 7;
        break;
      case "8":
        result = 8;
        break;
      case "9":
        result = 9;
        break;
      case "a":
        result = 10;
        break;
      case "b":
        result = 11;
        break;
      case "c":
        result = 12;
        break;
      case "d":
        result = 13;
        break;
      case "e":
        result = 14;
        break;
      case "f":
        result = 15;
        break;
    }
    return result;
  }
  if (typeof obj === "string") {
    newRGBColor.red = (convert(obj.slice(1, 2)) * 16) + convert(obj.slice(2, 3))
    newRGBColor.green = (convert(obj.slice(3, 4)) * 16) + convert(obj.slice(4, 5))
    newRGBColor.blue = (convert(obj.slice(5, 6)) * 16) + convert(obj.slice(6))
  } else {
    newRGBColor.red = obj.color[0];
    newRGBColor.green = obj.color[1];
    newRGBColor.blue = obj.color[2];
  }
  return newRGBColor;
}

Mother.prototype.return_bottom = function (dom) {
  var copyItem = dom.duplicate();
  var outline_group = copyItem.createOutline();
  var bottom = Math.abs(outline_group.top) + Math.abs(outline_group.height);
  outline_group.remove();
  return bottom;
}

Mother.prototype.compoundColor = function (compound, color) {
  var count = compound.pathItems.length;
  for (var i = 0; i < count; i++) {
    compound.pathItems[i].fillColor = color;
  }
}

Mother.prototype.default_para = function (dom, lineHeight) {
  var height = lineHeight || 16.8;
  dom.textRange.characterAttributes.size = 9.5;
  dom.textRange.characterAttributes.textFont = textFonts.getByName("SDGothicNeoa-eMd");
  dom.textRange.characterAttributes.horizontalScale = 98;
  dom.textRange.characterAttributes.tracking = -25;
  dom.textRange.characterAttributes.fillColor = this.colorpick("#606060");
  dom.textRange.characterAttributes.autoLeading = false;
  dom.textRange.characterAttributes.leading = height;
  for (var i = 0; i < dom.paragraphs.length; i++) {
    dom.paragraphs[i].paragraphAttributes.justification = Justification.FULLJUSTIFYLASTLINELEFT;
  }
}

Mother.prototype.copy_area = function (dom, margin, ratio, leftright) {
  var rectangle = app.activeDocument.pathItems.rectangle(((this.return_bottom(dom) + margin) * -1), dom.left, dom.width, dom.height);
  if (leftright === "right") { rectangle.left = rectangle.left + (rectangle.width * (1 - ratio)); }
  rectangle.width = rectangle.width * ratio;
  return app.activeDocument.textFrames.areaText(rectangle);
}

    
var Mileo = function (text, nameItem, boo) {
  this.text = "기본값 설정";
  if (text) {
    this.text = text;
  }
  this.nameItem = nameItem;
  this.nameItem.contents = this.text;
  this.flatform = boo;
}

Mileo.prototype.mother = new Mother();

Mileo.prototype.text_infoarray = function (str) {
  function string_toarray(str) {
    var a_arr = [];
    var objs;
    for (var i = 0; i < str.length; i++) {
      objs = {};
      objs["index"] = i;
      objs["value"] = str[i];
      if (str[i] !== " " && str[i] !== "  " && str[i] !== "\s" && str[i] !== " " && str[i] !== "\t" && str[i] !== "\n") {
        a_arr.push(objs);
      }
    }
    return a_arr;
  }
  function space_index(str) {
    var arr = [];
    var pat = /[ \n]/g;
    var k, e;
    while((e = pat.exec(str)) !== null) {
      k = e.index;
      arr.push(k);
    }
    arr.push(str.length);
    return arr;
  }
  return { string: string_toarray(str), space: space_index(str) };
}

Mileo.prototype.get_points = function () {
  var text_array = this.text_infoarray(this.text);
  var copyItem = this.nameItem.duplicate();
  var outline_group = copyItem.createOutline();
  outline_group.name = "outline_group";
  var outline_group_array_graphic = new Array(outline_group.pageItems.length);
  for (var i = 0; i < outline_group.pageItems.length; i++) {
    outline_group_array_graphic[outline_group.pageItems.length - 1 - i] = outline_group.pageItems[i];
  }

  if (text_array.string.length !== outline_group_array_graphic.length) { alert("stop! white space error") }
  var heights;
  if (text_array.string[0].value !== '.' && text_array.string[0].value !== ',' && text_array.string[0].value !== '_') {
    heights = Math.floor(outline_group_array_graphic[0].height);
  } else if (text_array.string[1].value !== '.' && text_array.string[1].value !== ',' && text_array.string[1].value !== '_') {
    heights = Math.floor(outline_group_array_graphic[1].height);
  } else if (text_array.string[2].value !== '.' && text_array.string[2].value !== ',' && text_array.string[2].value !== '_') {
    heights = Math.floor(outline_group_array_graphic[2].height);
  } else if (text_array.string[3].value !== '.' && text_array.string[3].value !== ',' && text_array.string[3].value !== '_') {
    heights = Math.floor(outline_group_array_graphic[3].height);
  } else if (text_array.string[4].value !== '.' && text_array.string[4].value !== ',' && text_array.string[4].value !== '_') {
    heights = Math.floor(outline_group_array_graphic[4].height);
  }

  var len = [];
  var len_sort = [];
  var bbagi;
  for (i = 0; i < outline_group_array_graphic.length; i++) {
    if (i !== outline_group_array_graphic.length - 1) {
      bbagi = Math.abs(Math.floor(outline_group_array_graphic[i+1].top) - Math.floor(outline_group_array_graphic[i].top));
      if (text_array.string[i+1].value === '.' || text_array.string[i+1].value === ',' || text_array.string[i+1].value === '_') {
        bbagi = Math.abs(Math.floor(outline_group_array_graphic[i+1].top + ((heights * 4)/5) - Math.floor(outline_group_array_graphic[i].top)));
      }
      if (text_array.string[i].value === '.' || text_array.string[i].value === ',' || text_array.string[i].value === '_') {
        bbagi = Math.abs(Math.floor(outline_group_array_graphic[i+1].top) - Math.floor(outline_group_array_graphic[i].top + ((heights * 4)/5)));
      }
      len.push(bbagi);
      len_sort.push(bbagi);
    } else {
      len.push(0);
      len_sort.push(0);
    }
  }
  len_sort.sort(function (a, b) { return b - a; });

  var chuga = 0;
  if (this.text.match(/\n/g)) {
    chuga += this.text.match(/\n/g).length;
  }
  var minimum = len_sort[this.nameItem.lines.length - 2 - chuga] - 1
  outline_group.remove();
  var points = [];
  for (i = 0; i < len.length; i++) { if (len[i] > minimum) {
    points.push(text_array.string[i+1].index);
  }}

  var space_point = new Array(points.length);
  for (var s = 0; s < points.length; s++) {
    for (i = 0; i < text_array.space.length; i++) { if (i !== text_array.space.length - 1) {
      if (points[s] > text_array.space[i] && points[s] < text_array.space[i+1]) {
        space_point[s] = text_array.space[i+1] - points[s] - 1;
      }
    }}
  }
  return { points: points, space_point: space_point };
}

Mileo.prototype.space = function (index) {
  var instance = this;
  var value_point_past, text_array, points, space_point, i, origin_text, result_text;
  origin_text = this.text;
  text_array = this.text_infoarray(this.text);
  points = this.get_points(this.nameItem, this.text).points;
  space_point = this.get_points(this.nameItem, this.text).space_point;
  for (i = 0; i < text_array.string.length; i++) { if (text_array.string[i].index === points[index]) {
    value_point_past = text_array.string[i].value;
  }}
  function text_nogada(text, nameItem, value_point_past, origin_text, index, minus) {
    var value_point, text_array, points, space_point, i;
    text_array = instance.text_infoarray(text);
    points = instance.get_points(nameItem, text).points;
    space_point = instance.get_points(nameItem, text).space_point;
    if (space_point[index] <= minus) {
      result_text = origin_text;
      return;
    }
    text = text.splice((points[index] + space_point[index] - minus), ' ');
    nameItem.contents = text;
    text_array = instance.text_infoarray(text);
    points = instance.get_points(nameItem, text).points;
    space_point = instance.get_points(nameItem, text).space_point;
    for (i = 0; i < text_array.string.length; i++) { if (text_array.string[i].index === points[index]) {
      value_point = text_array.string[i].value;
    }}
    if (value_point === value_point_past) {
      text = origin_text;
      nameItem.contents = text;
      text_array = instance.text_infoarray(text);
      points = instance.get_points(nameItem, text).points;
      space_point = instance.get_points(nameItem, text).space_point;
      text_nogada(text, nameItem, value_point_past, origin_text, index, minus + 1);
    } else {
      result_text = text;
      return;
    }
  }
  text_nogada(this.text, this.nameItem, value_point_past, origin_text, index, 0);
  return result_text;
}

Mileo.prototype.return_top = function () {
  var copyItem = this.nameItem.duplicate();
  var outline_group = copyItem.createOutline();
  var top = Math.abs(outline_group.top);
  outline_group.remove();
  return top;
}

Mileo.prototype.return_bottom = function () {
  var copyItem = this.nameItem.duplicate();
  var outline_group = copyItem.createOutline();
  var bottom = Math.abs(outline_group.top) + Math.abs(outline_group.height);
  outline_group.remove();
  return bottom;
}

Mileo.prototype.execute = function () {
  for (var z = 0; z < this.nameItem.lines.length - 1; z++) {
    this.text = this.space(z);
  }
  if (this.flatform !== "desktop") {
    for (var i = 0; i < this.nameItem.paragraphs.length; i++) {
      if (this.nameItem.paragraphs[i].contents === '') {
        this.nameItem.paragraphs[i].characterAttributes.autoLeading = false;
        this.nameItem.paragraphs[i].characterAttributes.leading = 16;
      }
    }
  }
}

ExecMain.prototype.mother = new Mother();
    
ExecMain.prototype.create_init = function (order) {
  var list = this.list;
  var new_file_name = {};
  var fileObj_temp = {};
  var this_ai_temp = {};
  for (var i = 0; i < list.length; i++) {
    new_file_name[list[i]] = ((list[i] === "desktop") ? '' : "mo") + "reword" + this.text.r_id + '_' + '0' + String(order + 1);
    fileObj_temp[list[i]] = new File(this.dir + "factory/template/review/" + list[i] + "/template" + ((order === 0) ? '' : 'p') +  ".ai");
    this_ai_temp[list[i]] = fileObj_temp[list[i]].get_file();
    this_ai_temp[list[i]].saveAs(new File(this.folder_list.rev.string + '/' + new_file_name[list[i]] + ".ai"));
    this_ai_temp[list[i]].close();
  }
  this.filename = new_file_name;
}

ExecMain.prototype.create = function (order, boo) {
  var fileObj = new File(this.folder_list.rev.string + '/' + this.filename[boo] + ".ai");
  var this_ai = fileObj.get_file();
  var margin = {
    desktop: {
      qa: 20.2763139294984,
      mun: 52.39212348109538,
    },
    mobile: {
      qa: 27.53133711473618,
      mun: 38.59394451040314,
    }
  }
  var nodes_name;
  if (order !== 0) { nodes_name = [ "mark_q", "mark_a", "quest", "answer" ]; }
  else { nodes_name = [ "answer" ]; }

  var temp_node, nodes = [];
  for (var i = 0; i < this.text.reviews[order].contents.length; i++) {
    nodes[i] = {}
    for (var j = 0; j < nodes_name.length; j++) {
      temp_node = this_ai.pageItems.getByName(nodes_name[j]).duplicate();
      temp_node.name = nodes_name[j] + String(i);
      nodes[i][nodes_name[j]] = {};
      nodes[i][nodes_name[j]]["node"] = temp_node;
    }
  }
  for (j = 0; j < nodes_name.length; j++) {
    this_ai.pageItems.getByName(nodes_name[j]).remove();
  }
  for (i = 0; i < nodes.length; i++) {
    for (var j = 0; j < nodes_name.length; j++) { if (nodes_name[j] !== "mark_q" && nodes_name[j] !== "mark_a") {
      nodes[i][nodes_name[j]]["instance"] = new Mileo(this.text.reviews[order].contents[i][nodes_name[j]], nodes[i][nodes_name[j]]["node"], boo);
      nodes[i][nodes_name[j]]["instance"].execute();
    }}
  }

  if (order !== 0) {
    for (i = 0; i < nodes.length; i++) {
      if (i !== 0) {
        nodes[i]["quest"]["node"].top = (nodes[i-1]["answer"]["instance"].return_bottom() + margin[boo].mun) * -1;
        nodes[i]["mark_q"]["node"].top = (nodes[i-1]["answer"]["instance"].return_bottom() + margin[boo].mun + 1.4) * -1;
      }
      nodes[i]["answer"]["node"].top = (nodes[i]["quest"]["instance"].return_bottom() + margin[boo].qa) * -1;
      nodes[i]["mark_a"]["node"].top = (nodes[i]["quest"]["instance"].return_bottom() + margin[boo].qa + 1.4) * -1;
    }
  }

  var past_art, past_rect;
  past_art = this_ai.artboard_select("art1").artboardRect;
  past_rect = this_ai.layer_select("contents").pathItems.rectangle(past_art[0], past_art[1], past_art[2], -1 * past_art[3]);
  past_rect.height = Math.abs(nodes[nodes.length - 1]["answer"]["instance"].return_bottom());

  var new_art = this_ai.artboards.add(past_rect.geometricBounds);
  past_rect.remove();
  this_ai.artboard_select("art1").remove();
  this_ai.artboards[0].name = "art1";

  this_ai.save();
  app.doScript("expandall","contents_maker");
  var exportOptions = new ExportOptionsSVG();
  exportOptions.coordinatePrecision = 7;
  app.activeDocument.exportFile(new File(this.folder_list.rev.string + '/' + this.filename[boo] + ".svg"), ExportType.SVG, exportOptions);
  this_ai.close();
}

ExecMain.prototype.start = function () {
  for (var b = 0; b < this.text.reviews.length; b++) {
    this.create_init(b);
    for (var j = 0; j < this.list.length; j++) { this.create(b, this.list[j]); }
  }
}
    
var main = new ExecMain(text, "/Users/baechang-gyu/Library/Mobile Documents/com~apple~CloudDocs/uragen/_BackRobot/contents_maker/");
main.start();
