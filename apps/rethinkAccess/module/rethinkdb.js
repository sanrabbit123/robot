const Promise=require("./promise.js"),returnErrors=function(){var t,r,e,n,o,p,c,u,i,a,l,s,y,f,_,h,R,E,extend=function(t,r){for(var e in r)m.call(r,e)&&(t[e]=r[e]);function ctor(){this.constructor=t}return ctor.prototype=r.prototype,t.prototype=new ctor,t.__super__=r.prototype,t},m={}.hasOwnProperty;return e=function(t){function ReqlCompileError(){return ReqlCompileError.__super__.constructor.apply(this,arguments)}return extend(ReqlCompileError,t),ReqlCompileError}(p=function(t){function ReqlError(t,r,e){this.name=this.constructor.name,this.msg=t,this.frames=null!=e?e.slice(0):void 0,null!=r?"."===t[t.length-1]?this.message=t.slice(0,t.length-1)+" in:\n"+y.prototype.printQuery(r)+"\n"+y.prototype.printCarrots(r,e):this.message=t+" in:\n"+y.prototype.printQuery(r)+"\n"+y.prototype.printCarrots(r,e):this.message=""+t,null!=Error.captureStackTrace&&Error.captureStackTrace(this,this)}return extend(ReqlError,t),ReqlError}(Error)),n=function(t){function ReqlDriverCompileError(){return ReqlDriverCompileError.__super__.constructor.apply(this,arguments)}return extend(ReqlDriverCompileError,t),ReqlDriverCompileError}(e),h=function(t){function ReqlServerCompileError(){return ReqlServerCompileError.__super__.constructor.apply(this,arguments)}return extend(ReqlServerCompileError,t),ReqlServerCompileError}(e),o=function(t){function ReqlDriverError(){return ReqlDriverError.__super__.constructor.apply(this,arguments)}return extend(ReqlDriverError,t),ReqlDriverError}(p),t=function(t){function ReqlAuthError(){return ReqlAuthError.__super__.constructor.apply(this,arguments)}return extend(ReqlAuthError,t),ReqlAuthError}(o),_=function(t){function ReqlRuntimeError(){return ReqlRuntimeError.__super__.constructor.apply(this,arguments)}return extend(ReqlRuntimeError,t),ReqlRuntimeError}(p),s=function(t){function ReqlQueryLogicError(){return ReqlQueryLogicError.__super__.constructor.apply(this,arguments)}return extend(ReqlQueryLogicError,t),ReqlQueryLogicError}(_),u=function(t){function ReqlNonExistenceError(){return ReqlNonExistenceError.__super__.constructor.apply(this,arguments)}return extend(ReqlNonExistenceError,t),ReqlNonExistenceError}(s),f=function(t){function ReqlResourceLimitError(){return ReqlResourceLimitError.__super__.constructor.apply(this,arguments)}return extend(ReqlResourceLimitError,t),ReqlResourceLimitError}(_),E=function(t){function ReqlUserError(){return ReqlUserError.__super__.constructor.apply(this,arguments)}return extend(ReqlUserError,t),ReqlUserError}(_),c=function(t){function ReqlInternalError(){return ReqlInternalError.__super__.constructor.apply(this,arguments)}return extend(ReqlInternalError,t),ReqlInternalError}(_),R=function(t){function ReqlTimeoutError(){return ReqlTimeoutError.__super__.constructor.apply(this,arguments)}return extend(ReqlTimeoutError,t),ReqlTimeoutError}(p),r=function(t){function ReqlAvailabilityError(){return ReqlAvailabilityError.__super__.constructor.apply(this,arguments)}return extend(ReqlAvailabilityError,t),ReqlAvailabilityError}(_),i=function(t){function ReqlOpFailedError(){return ReqlOpFailedError.__super__.constructor.apply(this,arguments)}return extend(ReqlOpFailedError,t),ReqlOpFailedError}(r),a=function(t){function ReqlOpIndeterminateError(){return ReqlOpIndeterminateError.__super__.constructor.apply(this,arguments)}return extend(ReqlOpIndeterminateError,t),ReqlOpIndeterminateError}(r),l=function(t){function ReqlPermissionError(){return ReqlPermissionError.__super__.constructor.apply(this,arguments)}return extend(ReqlPermissionError,t),ReqlPermissionError}(_),{ReqlError:p,ReqlCompileError:e,RqlCompileError:e,ReqlServerCompileError:h,ReqlDriverCompileError:n,RqlClientError:o,ReqlRuntimeError:_,RqlRuntimeError:_,RqlServerError:_,ReqlQueryLogicError:s,ReqlNonExistenceError:u,ReqlResourceLimitError:f,ReqlUserError:E,ReqlInternalError:c,ReqlTimeoutError:R,ReqlAvailabilityError:r,ReqlOpFailedError:i,ReqlOpIndeterminateError:a,ReqlPermissionError:l,ReqlDriverError:o,RqlDriverError:o,ReqlAuthError:t,printQuery:(y=function(){var t,r,e,n,o;function ReqlQueryPrinter(){}return ReqlQueryPrinter.prototype.printQuery=function(t){var r;return r=n(t),o(r)},n=function(t){var r,e,o,p,c;for(o in e=function(){var e,o,p,c;for(c=[],e=0,o=(p=t.args).length;e<o;e++)r=p[e],c.push(n(r));return c}(),p={},c=t.optargs)m.call(c,o)&&(r=c[o],p[o]=n(r));return t.compose(e,p)},ReqlQueryPrinter.prototype.printCarrots=function(t,p){var c;return c=0===p.length?[r(n(t))]:e(t,p),o(c).replace(/[^\^]/g," ")},e=function(t,o){var p,c,u,i,a,l,s;for(a in u=o.shift(),c=function(){var r,c,a,l;for(a=t.args,l=[],i=r=0,c=a.length;r<c;i=++r)p=a[i],u===i?l.push(e(p,o)):l.push(n(p));return l}(),l={},s=t.optargs)m.call(s,a)&&(p=s[a],l[a]=u===a?e(p,o):n(p));return null!=u?t.compose(c,l):r(t.compose(c,l))},t={},r=function(r){return[t,r]},o=function(r){var e,n,p,c;for(p="",e=0,n=r.length;e<n;e++)c=r[e],Array.isArray(c)?2===c.length&&c[0]===t?p+=o(c[1]).replace(/./g,"^"):p+=o(c):p+=c;return p},ReqlQueryPrinter}()).prototype.printQuery}},PROTODEF={VersionDummy:{Version:{V0_1:1063369270,V0_2:1915781601,V0_3:1601562686,V0_4:1074539808,V1_0:885177795},Protocol:{PROTOBUF:656407617,JSON:2120839367}},Query:{QueryType:{START:1,CONTINUE:2,STOP:3,NOREPLY_WAIT:4,SERVER_INFO:5},AssocPair:{}},Frame:{FrameType:{POS:1,OPT:2}},Backtrace:{},Response:{ResponseType:{SUCCESS_ATOM:1,SUCCESS_SEQUENCE:2,SUCCESS_PARTIAL:3,WAIT_COMPLETE:4,SERVER_INFO:5,CLIENT_ERROR:16,COMPILE_ERROR:17,RUNTIME_ERROR:18},ErrorType:{INTERNAL:1e6,RESOURCE_LIMIT:2e6,QUERY_LOGIC:3e6,NON_EXISTENCE:31e5,OP_FAILED:41e5,OP_INDETERMINATE:42e5,USER:5e6,PERMISSION_ERROR:6e6},ResponseNote:{SEQUENCE_FEED:1,ATOM_FEED:2,ORDER_BY_LIMIT_FEED:3,UNIONED_FEED:4,INCLUDES_STATES:5}},Datum:{DatumType:{R_NULL:1,R_BOOL:2,R_NUM:3,R_STR:4,R_ARRAY:5,R_OBJECT:6,R_JSON:7},AssocPair:{}},Term:{TermType:{DATUM:1,MAKE_ARRAY:2,MAKE_OBJ:3,VAR:10,JAVASCRIPT:11,UUID:169,HTTP:153,ERROR:12,IMPLICIT_VAR:13,DB:14,TABLE:15,GET:16,GET_ALL:78,EQ:17,NE:18,LT:19,LE:20,GT:21,GE:22,NOT:23,ADD:24,SUB:25,MUL:26,DIV:27,MOD:28,FLOOR:183,CEIL:184,ROUND:185,APPEND:29,PREPEND:80,DIFFERENCE:95,SET_INSERT:88,SET_INTERSECTION:89,SET_UNION:90,SET_DIFFERENCE:91,SLICE:30,SKIP:70,LIMIT:71,OFFSETS_OF:87,CONTAINS:93,GET_FIELD:31,KEYS:94,VALUES:186,OBJECT:143,HAS_FIELDS:32,WITH_FIELDS:96,PLUCK:33,WITHOUT:34,MERGE:35,BETWEEN_DEPRECATED:36,BETWEEN:182,REDUCE:37,MAP:38,FOLD:187,FILTER:39,CONCAT_MAP:40,ORDER_BY:41,DISTINCT:42,COUNT:43,IS_EMPTY:86,UNION:44,NTH:45,BRACKET:170,INNER_JOIN:48,OUTER_JOIN:49,EQ_JOIN:50,ZIP:72,RANGE:173,INSERT_AT:82,DELETE_AT:83,CHANGE_AT:84,SPLICE_AT:85,COERCE_TO:51,TYPE_OF:52,UPDATE:53,DELETE:54,REPLACE:55,INSERT:56,DB_CREATE:57,DB_DROP:58,DB_LIST:59,TABLE_CREATE:60,TABLE_DROP:61,TABLE_LIST:62,CONFIG:174,STATUS:175,WAIT:177,RECONFIGURE:176,REBALANCE:179,SYNC:138,GRANT:188,INDEX_CREATE:75,INDEX_DROP:76,INDEX_LIST:77,INDEX_STATUS:139,INDEX_WAIT:140,INDEX_RENAME:156,SET_WRITE_HOOK:189,GET_WRITE_HOOK:190,FUNCALL:64,BRANCH:65,OR:66,AND:67,FOR_EACH:68,FUNC:69,ASC:73,DESC:74,INFO:79,MATCH:97,UPCASE:141,DOWNCASE:142,SAMPLE:81,DEFAULT:92,JSON:98,ISO8601:99,TO_ISO8601:100,EPOCH_TIME:101,TO_EPOCH_TIME:102,NOW:103,IN_TIMEZONE:104,DURING:105,DATE:106,TIME_OF_DAY:126,TIMEZONE:127,YEAR:128,MONTH:129,DAY:130,DAY_OF_WEEK:131,DAY_OF_YEAR:132,HOURS:133,MINUTES:134,SECONDS:135,TIME:136,MONDAY:107,TUESDAY:108,WEDNESDAY:109,THURSDAY:110,FRIDAY:111,SATURDAY:112,SUNDAY:113,JANUARY:114,FEBRUARY:115,MARCH:116,APRIL:117,MAY:118,JUNE:119,JULY:120,AUGUST:121,SEPTEMBER:122,OCTOBER:123,NOVEMBER:124,DECEMBER:125,LITERAL:137,GROUP:144,SUM:145,AVG:146,MIN:147,MAX:148,SPLIT:149,UNGROUP:150,RANDOM:151,CHANGES:152,ARGS:154,BINARY:155,GEOJSON:157,TO_GEOJSON:158,POINT:159,LINE:160,POLYGON:161,DISTANCE:162,INTERSECTS:163,INCLUDES:164,CIRCLE:165,GET_INTERSECTING:166,FILL:167,GET_NEAREST:168,POLYGON_SUB:171,TO_JSON_STRING:172,MINVAL:180,MAXVAL:181,BIT_AND:191,BIT_OR:192,BIT_XOR:193,BIT_NOT:194,BIT_SAL:195,BIT_SAR:196},AssocPair:{}}},returnUtil=function(){let t,r,e,n,o,p,c,u,i,a,l,s=[].slice;return l={},r=returnErrors(),i=PROTODEF,u=i.Response.ErrorType,c=function(t){return 1===t?"":"s"},l.ar=function(t){return function(){var e;if((e=1<=arguments.length?s.call(arguments,0):[]).length!==t.length)throw new r.ReqlDriverCompileError("Expected "+t.length+" argument"+c(t.length)+" but found "+e.length+".");return t.apply(this,e)}},l.varar=function(t,e,n){return function(){var o;if(o=1<=arguments.length?s.call(arguments,0):[],null!=t&&o.length<t||null!=e&&o.length>e){if(null!=t&&null==e)throw new r.ReqlDriverCompileError("Expected "+t+" or more arguments but found "+o.length+".");if(null!=e&&null==t)throw new r.ReqlDriverCompileError("Expected "+e+" or fewer arguments but found "+o.length+".");throw new r.ReqlDriverCompileError("Expected between "+t+" and "+e+" arguments but found "+o.length+".")}return n.apply(this,o)}},l.aropt=function(t){return function(){var e,n,o,p;if(null!=(p=(e=1<=arguments.length?s.call(arguments,0):[])[n=t.length-1])&&"[object Object]"!==Object.prototype.toString.call(p)&&(p=null),n!==(o=e.length-(null!=p?1:0)))throw 1!==n?new r.ReqlDriverCompileError("Expected "+n+" arguments (not including options) but found "+o+"."):new r.ReqlDriverCompileError("Expected "+n+" argument (not including options) but found "+o+".");return t.apply(this,e)}},l.toArrayBuffer=function(t){var r,e,n,o,p;for(r=new Uint8Array(Buffer.alloc(t.length)),e=n=0,o=t.length;n<o;e=++n)p=t[e],r[e]=p;return r.buffer},l.fromCamelCase=function(t){return t.replace(/[A-Z]/g,(function(t){return"_"+t.toLowerCase()}))},l.toCamelCase=function(t){return t.replace(/_[a-z]/g,(function(t){return t[1].toUpperCase()}))},t=function(t,e){var n,o,p,c,u;switch(t.$reql_type$){case"TIME":switch(e.timeFormat){case"native":case void 0:if(null==t.epoch_time)throw new r.ReqlDriverError("pseudo-type TIME "+t+" object missing expected field 'epoch_time'.");return new Date(1e3*t.epoch_time);case"raw":return t;default:throw new r.ReqlDriverError("Unknown timeFormat run option "+e.timeFormat+".")}break;case"GROUPED_DATA":switch(e.groupFormat){case"native":case void 0:for(u=[],o=0,p=(c=t.data).length;o<p;o++)n=c[o],u.push({group:n[0],reduction:n[1]});return u;case"raw":return t;default:throw new r.ReqlDriverError("Unknown groupFormat run option "+e.groupFormat+".")}break;case"BINARY":switch(e.binaryFormat){case"native":case void 0:if(null==t.data)throw new r.ReqlDriverError("pseudo-type BINARY object missing expected field 'data'.");return Buffer.from(t.data,"base64");case"raw":return t;default:throw new r.ReqlDriverError("Unknown binaryFormat run option "+e.binaryFormat+".")}break;default:return t}},a=function(r,e){var n,o,p,c,u;if(Array.isArray(r))for(n=o=0,c=r.length;o<c;n=++o)u=r[n],r[n]=a(u,e);else if(r&&"object"==typeof r){for(p in r)u=r[p],r[p]=a(u,e);r=t(r,e)}return r},n=function(t,r){return a(t.r[0],r)},p=function(t,r){return a(t.r,r)},o=function(t,r,e){return new t(n(r),e,r.b)},e=function(t){switch(t){case u.QUERY_LOGIC:return r.ReqlQueryLogicError;case u.NON_EXISTENCE:return r.ReqlNonExistenceError;case u.RESOURCE_LIMIT:return r.ReqlResourceLimitError;case u.USER:return r.ReqlUserError;case u.INTERNAL:return r.ReqlInternalError;case u.OP_FAILED:return r.ReqlOpFailedError;case u.OP_INDETERMINATE:return r.ReqlOpIndeterminateError;case u.PERMISSION_ERROR:return r.ReqlPermissionError;default:return r.ReqlRuntimeError}},l.recursivelyConvertPseudotype=a,l.mkAtom=n,l.mkSeq=p,l.mkErr=o,l.errorClass=e,l},returnCursor=function(){var t,r,e,n,o,p,c,u,i,a,l,s,y,f,_=[].slice,extend=function(t,r){for(var e in r)h.call(r,e)&&(t[e]=r[e]);function ctor(){this.constructor=t}return ctor.prototype=r.prototype,t.prototype=new ctor,t.__super__=r.prototype,t},h={}.hasOwnProperty;return i=returnErrors(),y=returnUtil(),l=PROTODEF.Response.ResponseType,n=require("events").EventEmitter,u=y.ar,f=y.varar,y.aropt,a=y.mkErr,null==s&&(s=function(t){return setTimeout(t,0)}),p=function(){function IterableResult(t,r,e,n){var o,p;this._eachCb=(o=this._eachCb,p=this,function(){return o.apply(p,arguments)}),this._conn=t,this._token=r,this._opts=e,this._root=n,this._responses=[],this._responseIndex=0,this._outstandingRequests=1,this._iterations=0,this._endFlag=!1,this._contFlag=!1,this._closeAsap=!1,this._cont=null,this._cbQueue=[],this._closeCb=null,this._closeCbPromise=null,this.next=this._next}return IterableResult.prototype.stackSize=100,IterableResult.prototype._addResponse=function(t){if(t.t===this._type||t.t===l.SUCCESS_SEQUENCE?t.r.length>0&&this._responses.push(t):this._responses.push(t),this._outstandingRequests-=1,t.t!==this._type&&(this._endFlag=!0,null!=this._closeCb))switch(t.t){case l.COMPILE_ERROR:this._closeCb(a(i.ReqlServerCompileError,t,this._root));break;case l.CLIENT_ERROR:this._closeCb(a(i.ReqlClientError,t,this._root));break;case l.RUNTIME_ERROR:this._closeCb(a(y.errorClass(t.e),t,this._root));break;default:this._closeCb()}return this._contFlag=!1,!1===this._closeAsap?this._promptNext():this.close(this._closeCb),this},IterableResult.prototype._getCallback=function(){var t;return this._iterations+=1,t=this._cbQueue.shift(),this._iterations%this.stackSize==this.stackSize-1?function(r,e){return s((function(){return t(r,e)}))}:t},IterableResult.prototype._handleRow=function(){var t,r,e;return r=this._responses[0],e=y.recursivelyConvertPseudotype(r.r[this._responseIndex],this._opts),t=this._getCallback(),this._responseIndex+=1,this._responseIndex===r.r.length&&(this._responses.shift(),this._responseIndex=0),t(null,e)},IterableResult.prototype.bufferEmpty=function(){return 0===this._responses.length||this._responses[0].r.length<=this._responseIndex},IterableResult.prototype._promptNext=function(){var t,r,e;for(null!=this._closeCbPromise&&(t=this._getCallback())(new i.ReqlDriverError("Cursor is closed."));null!=this._cbQueue[0];){if(!0===this.bufferEmpty())return void(!0===this._endFlag?(t=this._getCallback())(new i.ReqlDriverError("No more rows in the cursor.")):this._responses.length<=1&&this._promptCont());switch(e=this._responses[0],1===this._responses.length&&this._promptCont(),e.t){case l.SUCCESS_PARTIAL:this._handleRow();break;case l.SUCCESS_SEQUENCE:0===e.r.length?this._responses.shift():this._handleRow();break;case l.COMPILE_ERROR:this._responses.shift(),(t=this._getCallback())(a(i.ReqlServerCompileError,e,this._root));break;case l.CLIENT_ERROR:this._responses.shift(),(t=this._getCallback())(a(i.ReqlClientError,e,this._root));break;case l.RUNTIME_ERROR:this._responses.shift(),t=this._getCallback(),r=y.errorClass(e.e),t(a(r,e,this._root));break;default:this._responses.shift(),(t=this._getCallback())(new i.ReqlDriverError("Unknown response type for cursor"))}}},IterableResult.prototype._promptCont=function(){if(!this._contFlag&&!this._endFlag&&this._conn.isOpen())return this._contFlag=!0,this._outstandingRequests+=1,this._conn._continueQuery(this._token)},IterableResult.prototype.hasNext=function(){throw new i.ReqlDriverError("The `hasNext` command has been removed since 1.13. Use `next` instead.")},IterableResult.prototype._next=f(0,1,(function(t){var r,e;if(null!=t&&"function"!=typeof t)throw new i.ReqlDriverError("First argument to `next` must be a function or undefined.");return e=this,r=function(t){return e._cbQueue.push(t),e._promptNext()},Promise.fromNode(r).nodeify(t)})),IterableResult.prototype.close=f(0,1,(function(t){var r;return null!=this._closeCbPromise?this._closeCbPromise.isPending()?this._closeCbPromise=this._closeCbPromise.nodeify(t):this._closeCbPromise=Promise.resolve().nodeify(t):this._endFlag?(this._closeCbPromise=Promise.resolve().nodeify(t),this._responses=[],this._responseIndex=0):this._closeCbPromise=new Promise((r=this,function(t,e){return r._closeCb=function(n){for(r._responses=[],r._responseIndex=0;r._cbQueue.length>0;)r._cbQueue.shift();return r._outstandingRequests=0,n?e(n):t()},r._closeAsap=!0,r._outstandingRequests+=1,r._conn._endQuery(r._token)})).nodeify(t),this._closeCbPromise})),IterableResult.prototype.each=f(1,2,(function(t,r){var e,n;if("function"!=typeof t)throw new i.ReqlDriverError("First argument to each must be a function.");if(null!=r&&"function"!=typeof r)throw new i.ReqlDriverError("Optional second argument to each must be a function.");return this,n=this,e=function(o,p){return null!=o?"No more rows in the cursor."===o.message?"function"==typeof r?r():void 0:t(o):!1!==t(null,p)?n._next(e):"function"==typeof r?r():void 0},this._next(e)})),IterableResult.prototype.eachAsync=f(1,3,(function(t,r,e){var n,o,p,c,u;if(null==e&&(e={concurrency:1}),"function"!=typeof t)throw new i.ReqlDriverError("First argument to eachAsync must be a function.");if(null!=r)if("object"==typeof r)e=r,r=void 0;else if("function"!=typeof r)throw new i.ReqlDriverError("Optional second argument to eachAsync must be a function or `options` object");if(!(e&&"number"==typeof e.concurrency&&e.concurrency>0))throw new i.ReqlDriverError("Optional `options.concurrency` argument to eachAsync must be a positive number");return o=[],c=function(r){var e,n,o,p;return t.length<=1?p=Promise.resolve(t(r)):(o=!1,e=!1,n=void 0,p=Promise.fromNode((function(p){return void 0!==t(r,(function(t){return o=!0,e?p(t):n=t}))?p(new i.ReqlDriverError("A two-argument row handler for eachAsync may only return undefined.")):o&&p(n),e=!0}))),p.then((function(t){if(void 0===t)return t;throw new i.ReqlDriverError("Row handler for eachAsync may only return undefined, or a Promise that resolves to undefined.")}))},u=this,p=(n=function(){return null!=u._closeCbPromise?Promise.resolve().then((function(t){throw new i.ReqlDriverError("Cursor is closed.")})):u._next().then((function(t){return o.length<e.concurrency?t:Promise.any(o).catch(Promise.AggregateError,(function(t){throw t[0]})).return(t)})).then((function(t){var r;return r=c(t).then((function(){return o.splice(o.indexOf(r),1)})),o.push(r)})).then(n).catch((function(t){if("No more rows in the cursor."!==(null!=t?t.message:void 0))throw t;return Promise.all(o)}))})().then((function(){if(null!=r)return r(null)})).catch((function(t){if(null!=r)return r(t);throw t})),null==r?p:null})),IterableResult.prototype._each=IterableResult.prototype.each,IterableResult.prototype._eachAsync=IterableResult.prototype.eachAsync,IterableResult.prototype.toArray=f(0,1,(function(t){var r,e;if(null!=t&&"function"!=typeof t)throw new i.ReqlDriverCompileError("First argument to `toArray` must be a function or undefined.");return r=[],e=function(t){r.push(t)},this.eachAsync(e).then((function(){return r})).nodeify(t)})),IterableResult.prototype._makeEmitter=function(){return this.emitter=new n,this.each=function(){throw new i.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")},this.next=function(){throw new i.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")}},IterableResult.prototype.addListener=function(t,r){var e;return null==this.emitter&&(this._makeEmitter(),s((e=this,function(){return e._each(e._eachCb)}))),this.emitter.addListener(t,r)},IterableResult.prototype.on=function(t,r){var e;return null==this.emitter&&(this._makeEmitter(),s((e=this,function(){return e._each(e._eachCb)}))),this.emitter.on(t,r)},IterableResult.prototype.once=function(t,r){var e;return null==this.emitter&&(this._makeEmitter(),s((e=this,function(){return e._each(e._eachCb)}))),this.emitter.once(t,r)},IterableResult.prototype.removeListener=function(t,r){var e;return null==this.emitter&&(this._makeEmitter(),s((e=this,function(){return e._each(e._eachCb)}))),this.emitter.removeListener(t,r)},IterableResult.prototype.removeAllListeners=function(t){var r;return null==this.emitter&&(this._makeEmitter(),s((r=this,function(){return r._each(r._eachCb)}))),this.emitter.removeAllListeners(t)},IterableResult.prototype.setMaxListeners=function(t){var r;return null==this.emitter&&(this._makeEmitter(),s((r=this,function(){return r._each(r._eachCb)}))),this.emitter.setMaxListeners(t)},IterableResult.prototype.listeners=function(t){var r;return null==this.emitter&&(this._makeEmitter(),s((r=this,function(){return r._each(r._eachCb)}))),this.emitter.listeners(t)},IterableResult.prototype.emit=function(){var t,r,e;return t=1<=arguments.length?_.call(arguments,0):[],null==this.emitter&&(this._makeEmitter(),s((e=this,function(){return e._each(e._eachCb)}))),(r=this.emitter).emit.apply(r,t)},IterableResult.prototype._eachCb=function(t,r){return null!=t?this.emitter.emit("error",t):this.emitter.emit("data",r)},IterableResult}(),e=function(t){function Cursor(){this._type=l.SUCCESS_PARTIAL,Cursor.__super__.constructor.apply(this,arguments)}return extend(Cursor,t),Cursor.prototype.toString=u((function(){return"[object Cursor]"})),Cursor}(p),o=function(t){function Feed(){this._type=l.SUCCESS_PARTIAL,Feed.__super__.constructor.apply(this,arguments)}return extend(Feed,t),Feed.prototype.hasNext=function(){throw new i.ReqlDriverError("`hasNext` is not available for feeds.")},Feed.prototype.toArray=function(){throw new i.ReqlDriverError("`toArray` is not available for feeds.")},Feed.prototype.toString=u((function(){return"[object Feed]"})),Feed}(p),function(t){function UnionedFeed(){this._type=l.SUCCESS_PARTIAL,UnionedFeed.__super__.constructor.apply(this,arguments)}return extend(UnionedFeed,t),UnionedFeed.prototype.hasNext=function(){throw new i.ReqlDriverError("`hasNext` is not available for feeds.")},UnionedFeed.prototype.toArray=function(){throw new i.ReqlDriverError("`toArray` is not available for feeds.")},UnionedFeed.prototype.toString=u((function(){return"[object UnionedFeed]"})),UnionedFeed}(p),r=function(t){function AtomFeed(){this._type=l.SUCCESS_PARTIAL,AtomFeed.__super__.constructor.apply(this,arguments)}return extend(AtomFeed,t),AtomFeed.prototype.hasNext=function(){throw new i.ReqlDriverError("`hasNext` is not available for feeds.")},AtomFeed.prototype.toArray=function(){throw new i.ReqlDriverError("`toArray` is not available for feeds.")},AtomFeed.prototype.toString=u((function(){return"[object AtomFeed]"})),AtomFeed}(p),c=function(t){function OrderByLimitFeed(){this._type=l.SUCCESS_PARTIAL,OrderByLimitFeed.__super__.constructor.apply(this,arguments)}return extend(OrderByLimitFeed,t),OrderByLimitFeed.prototype.hasNext=function(){throw new i.ReqlDriverError("`hasNext` is not available for feeds.")},OrderByLimitFeed.prototype.toArray=function(){throw new i.ReqlDriverError("`toArray` is not available for feeds.")},OrderByLimitFeed.prototype.toString=u((function(){return"[object OrderByLimitFeed]"})),OrderByLimitFeed}(p),t=function(t){function ArrayResult(){return ArrayResult.__super__.constructor.apply(this,arguments)}return extend(ArrayResult,t),ArrayResult.prototype._hasNext=u((function(){return null==this.__index&&(this.__index=0),this.__index<this.length})),ArrayResult.prototype._next=f(0,1,(function(t){var r,e;return e=this,r=function(t){var r;return null!=e._closeCbPromise&&t(new i.ReqlDriverError("Cursor is closed.")),!0===e._hasNext()?(r=e).__index%e.stackSize==e.stackSize-1?s((function(){return t(null,r[r.__index++])})):t(null,r[r.__index++]):t(new i.ReqlDriverError("No more rows in the cursor."))},Promise.fromNode(r).nodeify(t)})),ArrayResult.prototype.toArray=f(0,1,(function(t){var r,e;return e=this,r=function(t){return null!=e._closeCbPromise&&t(new i.ReqlDriverError("Cursor is closed.")),null!=e.__index?t(null,e.slice(e.__index,e.length)):t(null,e)},Promise.fromNode(r).nodeify(t)})),ArrayResult.prototype.close=f(0,1,(function(t){return this.length=0,this.__index=0,this._closeCbPromise=Promise.resolve().nodeify(t),this._closeCbPromise})),ArrayResult.prototype.makeIterable=function(t){var r,e,n;for(e in t.__proto__={},n=ArrayResult.prototype)r=n[e],"constructor"!==e&&("_next"===e?(t.__proto__.next=r,t.__proto__._next=r):t.__proto__[e]=r);return t.__proto__.__proto__=[].__proto__,t},ArrayResult}(p),{Cursor:e,Feed:o,AtomFeed:r,OrderByLimitFeed:c,makeIterable:t.prototype.makeIterable}},returnAst=function(){const isConnection=function(t){return/Connection/g.test(t.constructor.name)};let t,r,e,n,o,p,c,u,i,a,l,s,y,f,_,h,R,E,m,d,v,b,O,g,C,D,w,T,S,I,A,B,N,j,L,F,U,q,P,k,V,M,x,G,H,W,J,Y,Q,K,X,z,Z,$,tt,rt,et,nt,ot,pt,ct,ut,it,at,lt,st,yt,ft,_t,ht,Rt,Et,mt,dt,vt,bt,Ot,gt,Ct,Dt,wt,Tt,St,It,At,Bt,Nt,jt,Ft,Ut,qt,Pt,kt,Vt,Mt,xt,Ht,Wt,Jt,Yt,Qt,Kt,Xt,zt,Zt,$t,tr,rr,er,nr,or,pr,cr,ur,ir,ar,lr,sr,yr,fr,_r,hr,Rr,Er,mr,dr,vr,br,gr,Cr,Dr,wr,Tr,Sr,Ir,Ar,Br,Nr,jr,Lr,Fr,Ur,qr,Pr,kr,Vr,Mr,xr,Gr,Hr,Wr,Jr,Yr,Qr,Kr,Xr,zr,Zr,$r,te,re,ee,ne,oe,pe,ce,ue,ie,ae,le,se,ye,fe,_e,he,Re,Ee,me,de,ve,be,Oe,ge,Ce=[].slice,De={}.hasOwnProperty,extend=function(t,r){for(var e in r)De.call(r,e)&&(t[e]=r[e]);function ctor(){this.constructor=t}return ctor.prototype=r.prototype,t.prototype=new ctor,t.__super__=r.prototype,t};return Oe=returnUtil(),se=returnErrors(),Ee=PROTODEF.Term.TermType,ae=Oe.ar,ge=Oe.varar,le=Oe.aropt,me=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],me.expr.apply(me,t)},ye=function(t){var r;return void 0===t?t:(t=me.expr(t),(r=function(t){var e,n;return t instanceof Mr&&(t instanceof _t||(!!t.args.map(r).some((function(t){return t}))||!!function(){var r,o;for(e in o=[],r=t.optargs)De.call(r,e)&&(n=r[e],o.push(n));return o}().map(r).some((function(t){return t}))))})(t)?new Z({},(function(r){return t})):t)},fe=function(t){var r,e,n;if(Array.isArray(t)){for(e=0,n=t.length;e<n;e++)if(r=t[e],!0===fe(r))return!0}else if("r.row"===t)return!0;return!1},Mr=function(){function TermBase(){var t;return void 0!=={}.__proto__?((t=ae((function(r){return t.bracket(r)}))).__proto__=this.__proto__,t):this}return TermBase.prototype.showRunWarning=!0,TermBase.prototype.run=function(t,r,e){if(!0===isConnection(t)){if("function"==typeof r){if(void 0!==e)return Promise.reject(new se.ReqlDriverError("Second argument to `run` cannot be a function if a third argument is provided.")).nodeify(r);e=r,r={}}}else(null!=t?t.constructor:void 0)===Object&&(!0===this.showRunWarning&&("undefined"!=typeof process&&null!==process&&process.stderr.write("RethinkDB warning: This syntax is deprecated. Please use `run(connection[, options], callback)`."),this.showRunWarning=!1),e=r,r=t,t=t.connection,delete r.connection);return null==r&&(r={}),null!=e&&"function"!=typeof e?Promise.reject(new se.ReqlDriverError("If provided, the callback must be a function. Please use `run(connection[, options][, callback])")):!1===isConnection(t)?Promise.reject(new se.ReqlDriverError("First argument to `run` must be an open connection.")).nodeify(e):new Promise((n=this,function(e,o){var p,c,u;u=function(t,r){return null!=t?o(t):e(r)};try{return t._start(n,u,r)}catch(c){return p=c,u(p)}})).nodeify(e);var n},TermBase.prototype.toString=function(){return se.printQuery(this)},TermBase}(),yr=function(n){function RDBVal(){return RDBVal.__super__.constructor.apply(this,arguments)}return extend(RDBVal,n),RDBVal.prototype.eq=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(H,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.ne=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Xt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.lt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(qt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.le=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Nt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.gt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(at,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.ge=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}($,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.not=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(zt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.add=function(){var r;return r=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(t,[{},this].concat(Ce.call(r)),(function(){}))},RDBVal.prototype.sub=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Lr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.mul=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Kt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.div=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(V,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.mod=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Yt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitAnd=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(i,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitOr=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(l,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitXor=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(f,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitNot=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(a,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitSal=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(s,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bitSar=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(y,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.floor=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Q,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.ceil=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(R,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.round=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(vr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.append=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(e,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.prepend=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ar,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.difference=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(q,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.setInsert=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Dr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.setUnion=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Tr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.setIntersection=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(wr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.setDifference=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Cr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.slice=ge(1,3,(function(t,r,e){return null!=e?new Ar(e,this,t,r):void 0!==r?"[object Object]"!==Object.prototype.toString.call(r)||r instanceof Mr?new Ar({},this,t,r):new Ar(r,this,t):new Ar({},this,t)})),RDBVal.prototype.skip=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ir,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.limit=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(jt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.getField=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(nt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.contains=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(g,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.insertAt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(wt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.spliceAt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Br,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.deleteAt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(F,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.changeAt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(E,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.offsetsOf=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(rr,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.hasFields=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(lt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.withFields=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(pe,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.keys=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Bt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.values=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ee,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.changes=le((function(t){return new m(t,this)})),RDBVal.prototype.pluck=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(pr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.without=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ce,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.merge=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ht,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.between=le((function(t,r,e){return new c(e,this,t,r)})),RDBVal.prototype.reduce=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(mr,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.map=ge(1,null,(function(){var t,r,e;return t=2<=arguments.length?Ce.call(arguments,0,e=arguments.length-1):(e=0,[]),r=arguments[e++],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Vt,[{},this].concat(Ce.call(t),[ye(r)]),(function(){}))})),RDBVal.prototype.fold=le((function(t,r,e){return new K(e,this,t,ye(r))})),RDBVal.prototype.filter=le((function(t,r){return new Y(r,this,ye(t))})),RDBVal.prototype.concatMap=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(b,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.distinct=le((function(t){return new k(t,this)})),RDBVal.prototype.count=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(C,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.union=function(){var t,r,e,n,p;return e=1<=arguments.length?Ce.call(arguments,0):[],n={},r=e,!(p=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(p)||p instanceof Mr||(n=p,r=e.slice(0,e.length-1)),r=function(){var e,n,p;for(p=[],e=0,n=r.length;e<n;e++)(t=r[e])instanceof o||t instanceof U?p.push(t):p.push(ye(t));return p}(),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Zr,[n,this].concat(Ce.call(r)),(function(){}))},RDBVal.prototype.nth=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}($t,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.bracket=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(_,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.toJSON=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Qr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.toJsonString=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Qr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.match=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Mt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.split=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Nr,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.upcase=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}($r,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.downcase=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(M,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.isEmpty=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(St,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.innerJoin=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ct,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.outerJoin=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(or,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.eqJoin=le((function(t,r,e){return new W(e,this,ye(t),r)})),RDBVal.prototype.zip=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ie,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.coerceTo=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(v,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.ungroup=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(zr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.typeOf=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Kr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.update=le((function(t,r){return new te(r,this,ye(t))})),RDBVal.prototype.delete=le((function(t){return new L(t,this)})),RDBVal.prototype.replace=le((function(t,r){return new dr(r,this,ye(t))})),RDBVal.prototype.do=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(z,[{},ye(t.slice(-1)[0]),this].concat(Ce.call(t.slice(0,-1))),(function(){}))},RDBVal.prototype.default=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(j,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.or=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(er,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.and=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(r,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.branch=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(h,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.forEach=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(X,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.sum=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Fr,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.avg=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(p,[{},this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.info=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(gt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.sample=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(br,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.group=function(){var t,r,e,n;return e={},t=r=1<=arguments.length?Ce.call(arguments,0):[],r.length>0&&(!(n=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Mr||(e=n,t=r.slice(0,r.length-1))),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(it,[e,this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.orderBy=function(){var t,r,e,n,p;return e=1<=arguments.length?Ce.call(arguments,0):[],n={},r=e,!(p=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(p)||p instanceof Mr||(n=p,r=e.slice(0,e.length-1)),r=function(){var e,n,p;for(p=[],e=0,n=r.length;e<n;e++)(t=r[e])instanceof o||t instanceof U?p.push(t):p.push(ye(t));return p}(),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(nr,[n,this].concat(Ce.call(r)),(function(){}))},RDBVal.prototype.toGeojson=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Jr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.distance=le((function(t,r){return new P(r,this,t)})),RDBVal.prototype.intersects=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Tt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.includes=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Rt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.fill=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(J,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.polygonSub=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ir,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.tableCreate=le((function(t,r){return new Pr(r,this,t)})),RDBVal.prototype.tableDrop=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(kr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.tableList=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Vr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.config=function(){return new O({},this)},RDBVal.prototype.status=function(){return new jr({},this)},RDBVal.prototype.wait=le((function(t){return new oe(t,this)})),RDBVal.prototype.table=le((function(t,r){return new qr(r,this,t)})),RDBVal.prototype.get=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(rt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.getAll=function(){var t,r,e,n;return e={},t=r=1<=arguments.length?Ce.call(arguments,0):[],r.length>1&&(!(n=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Mr||(e=n,t=r.slice(0,r.length-1))),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(et,[e,this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.min=function(){var t,r,e,n;return e={},t=r=1<=arguments.length?Ce.call(arguments,0):[],1===r.length&&(!(n=r[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Mr||(e=n,t=[])),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Wt,[e,this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.max=function(){var t,r,e,n;return e={},t=r=1<=arguments.length?Ce.call(arguments,0):[],1===r.length&&(!(n=r[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Mr||(e=n,t=[])),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(xt,[e,this].concat(Ce.call(t.map(ye))),(function(){}))},RDBVal.prototype.insert=le((function(t,r){return new Dt(r,this,me.expr(t))})),RDBVal.prototype.setWriteHook=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Sr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.getWriteHook=function(){return new ct({},this)},RDBVal.prototype.indexCreate=ge(1,3,(function(t,r,e){return null!=e?new Et(e,this,t,ye(r)):null!=r?"[object Object]"!==Object.prototype.toString.call(r)||"function"==typeof r||r instanceof Mr?new Et({},this,t,ye(r)):new Et(r,this,t):new Et({},this,t)})),RDBVal.prototype.indexDrop=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(mt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.indexList=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(dt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.indexStatus=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(bt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.indexWait=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ot,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.indexRename=le((function(t,r,e){return new vt(e,this,t,r)})),RDBVal.prototype.reconfigure=function(t){return new Er(t,this)},RDBVal.prototype.rebalance=function(){return new Rr({},this)},RDBVal.prototype.sync=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ur,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.grant=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ut,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.toISO8601=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Yr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.toEpochTime=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Wr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.inTimezone=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ht,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.during=le((function(t,r,e){return new x(e,this,t,r)})),RDBVal.prototype.date=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(fr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.timeOfDay=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Gr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.timezone=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Hr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.year=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ue,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.month=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Qt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.day=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(w,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.dayOfWeek=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(T,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.dayOfYear=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(S,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.hours=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(st,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.minutes=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Jt,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.seconds=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(gr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.uuid=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Xr,[{},this].concat(Ce.call(t)),(function(){}))},RDBVal.prototype.getIntersecting=le((function(t,r){return new ot(r,this,t)})),RDBVal.prototype.getNearest=le((function(t,r){return new pt(r,this,t)})),RDBVal}(Mr),D=function(t){function DatumTerm(t){var r;return(r=DatumTerm.__super__.constructor.call(this)).data=t,r}return extend(DatumTerm,t),DatumTerm.prototype.args=[],DatumTerm.prototype.optargs={},DatumTerm.prototype.compose=function(){return"string"==typeof this.data?'"'+this.data+'"':""+this.data},DatumTerm.prototype.build=function(){if("number"==typeof this.data&&!isFinite(this.data))throw new TypeError("Illegal non-finite number `"+this.data.toString()+"`.");return this.data},DatumTerm}(yr),ve=function(t){var r,e,n;for(r in e={},t)De.call(t,r)&&(n=t[r],e[Oe.toCamelCase(r)]=n);return e},be=function(t){var r,e,n;for(r in e={},t)De.call(t,r)&&(n=t[r],void 0!==r&&void 0!==n&&(e[Oe.fromCamelCase(r)]=me.expr(n)));return e},sr=function(t){function RDBOp(){var t,r,e,n,o;return n=arguments[0],r=2<=arguments.length?Ce.call(arguments,1):[],(o=RDBOp.__super__.constructor.call(this)).args=function(){var n,o,p;for(p=[],e=n=0,o=r.length;n<o;e=++n){if(void 0===(t=r[e]))throw new se.ReqlDriverCompileError("Argument "+e+" to "+(this.st||this.mt)+" may not be `undefined`.");p.push(me.expr(t))}return p}.call(this),o.optargs=be(n),o}return extend(RDBOp,t),RDBOp.prototype.build=function(){var t,r,e,n,o,p,c,u,i,a;for(i=[this.tt,[]],e=0,o=(c=this.args).length;e<o;e++)r=c[e],i[1].push(r.build());for(n in p={},t=!1,u=this.optargs)De.call(u,n)&&(a=u[n],t=!0,p[n]=a.build());return t&&i.push(p),i},RDBOp.prototype.compose=function(t,r){return this.st?["r.",this.st,"(",he(t,r),")"]:(de(this.args[0])&&(t[0]=["r(",t[0],")"]),[t[0],".",this.mt,"(",he(t.slice(1),r),")"])},RDBOp}(yr),lr=function(t){function RDBConstant(){return RDBConstant.__super__.constructor.apply(this,arguments)}return extend(RDBConstant,t),RDBConstant.prototype.compose=function(t,r){return["r.",this.st]},RDBConstant}(sr),_e=function(t){var r,e,n,o,p;if(null==t[0])return[];for(p=[t[0]],e=0,n=(o=t.slice(1)).length;e<n;e++)r=o[e],p.push(", ",r);return p},Re=function(t){var r,e;return["{",_e(function(){var n;for(r in n=[],t)De.call(t,r)&&(e=t[r],n.push([JSON.stringify(r),": ",e]));return n}()),"}"]},he=function(t,r){var e;return e=[],t.length>0&&e.push(_e(t)),Object.keys(r).length>0&&(e.length>0&&e.push(", "),e.push(Re(ve(r)))),e},de=function(t){return t instanceof D||t instanceof Pt||t instanceof kt},Pt=function(t){function MakeArray(){return MakeArray.__super__.constructor.apply(this,arguments)}return extend(MakeArray,t),MakeArray.prototype.tt=Ee.MAKE_ARRAY,MakeArray.prototype.st="[...]",MakeArray.prototype.compose=function(t){return["[",_e(t),"]"]},MakeArray}(sr),kt=function(t){function MakeObject(t,r){var e,n,o;for(e in null==r&&(r=20),(n=MakeObject.__super__.constructor.call(this,{})).optargs={},t)if(De.call(t,e)){if(void 0===(o=t[e]))throw new se.ReqlDriverCompileError("Object field '"+e+"' may not be undefined");n.optargs[e]=me.expr(o,r-1)}return n}return extend(MakeObject,t),MakeObject.prototype.tt=Ee.MAKE_OBJ,MakeObject.prototype.st="{...}",MakeObject.prototype.compose=function(t,r){return Re(r)},MakeObject.prototype.build=function(){var t,r,e,n;for(t in e={},r=this.optargs)De.call(r,t)&&(n=r[t],e[t]=n.build());return e},MakeObject}(sr),ne=function(t){function Var(){return Var.__super__.constructor.apply(this,arguments)}return extend(Var,t),Var.prototype.tt=Ee.VAR,Var.prototype.compose=function(t){return["var_"+t]},Var}(sr),It=function(t){function JavaScript(){return JavaScript.__super__.constructor.apply(this,arguments)}return extend(JavaScript,t),JavaScript.prototype.tt=Ee.JAVASCRIPT,JavaScript.prototype.st="js",JavaScript}(sr),yt=function(t){function Http(){return Http.__super__.constructor.apply(this,arguments)}return extend(Http,t),Http.prototype.tt=Ee.HTTP,Http.prototype.st="http",Http}(sr),At=function(t){function Json(){return Json.__super__.constructor.apply(this,arguments)}return extend(Json,t),Json.prototype.tt=Ee.JSON,Json.prototype.st="json",Json}(sr),u=function(t){function Binary(t){var r;return t instanceof Mr?r=Binary.__super__.constructor.call(this,{},t):t instanceof Buffer&&((r=Binary.__super__.constructor.call(this)).base64_data=t.toString("base64")),r}return extend(Binary,t),Binary.prototype.tt=Ee.BINARY,Binary.prototype.st="binary",Binary.prototype.compose=function(){return 0===this.args.length?"r.binary(<data>)":Binary.__super__.compose.apply(this,arguments)},Binary.prototype.build=function(){return 0===this.args.length?{$reql_type$:"BINARY",data:this.base64_data}:Binary.__super__.build.apply(this,arguments)},Binary}(sr),n=function(t){function Args(){return Args.__super__.constructor.apply(this,arguments)}return extend(Args,t),Args.prototype.tt=Ee.ARGS,Args.prototype.st="args",Args}(sr),re=function(t){function UserError(){return UserError.__super__.constructor.apply(this,arguments)}return extend(UserError,t),UserError.prototype.tt=Ee.ERROR,UserError.prototype.st="error",UserError}(sr),_r=function(t){function Random(){return Random.__super__.constructor.apply(this,arguments)}return extend(Random,t),Random.prototype.tt=Ee.RANDOM,Random.prototype.st="random",Random}(sr),_t=function(t){function ImplicitVar(){return ImplicitVar.__super__.constructor.apply(this,arguments)}return extend(ImplicitVar,t),ImplicitVar.prototype.tt=Ee.IMPLICIT_VAR,ImplicitVar.prototype.compose=function(){return["r.row"]},ImplicitVar}(sr),I=function(t){function Db(){return Db.__super__.constructor.apply(this,arguments)}return extend(Db,t),Db.prototype.tt=Ee.DB,Db.prototype.st="db",Db}(sr),qr=function(t){function Table(){return Table.__super__.constructor.apply(this,arguments)}return extend(Table,t),Table.prototype.tt=Ee.TABLE,Table.prototype.st="table",Table.prototype.compose=function(t,r){return this.args[0]instanceof I?[t[0],".table(",he(t.slice(1),r),")"]:["r.table(",he(t,r),")"]},Table}(sr),rt=function(t){function Get(){return Get.__super__.constructor.apply(this,arguments)}return extend(Get,t),Get.prototype.tt=Ee.GET,Get.prototype.mt="get",Get}(sr),et=function(t){function GetAll(){return GetAll.__super__.constructor.apply(this,arguments)}return extend(GetAll,t),GetAll.prototype.tt=Ee.GET_ALL,GetAll.prototype.mt="getAll",GetAll}(sr),H=function(t){function Eq(){return Eq.__super__.constructor.apply(this,arguments)}return extend(Eq,t),Eq.prototype.tt=Ee.EQ,Eq.prototype.mt="eq",Eq}(sr),Xt=function(t){function Ne(){return Ne.__super__.constructor.apply(this,arguments)}return extend(Ne,t),Ne.prototype.tt=Ee.NE,Ne.prototype.mt="ne",Ne}(sr),qt=function(t){function Lt(){return Lt.__super__.constructor.apply(this,arguments)}return extend(Lt,t),Lt.prototype.tt=Ee.LT,Lt.prototype.mt="lt",Lt}(sr),Nt=function(t){function Le(){return Le.__super__.constructor.apply(this,arguments)}return extend(Le,t),Le.prototype.tt=Ee.LE,Le.prototype.mt="le",Le}(sr),at=function(t){function Gt(){return Gt.__super__.constructor.apply(this,arguments)}return extend(Gt,t),Gt.prototype.tt=Ee.GT,Gt.prototype.mt="gt",Gt}(sr),$=function(t){function Ge(){return Ge.__super__.constructor.apply(this,arguments)}return extend(Ge,t),Ge.prototype.tt=Ee.GE,Ge.prototype.mt="ge",Ge}(sr),zt=function(t){function Not(){return Not.__super__.constructor.apply(this,arguments)}return extend(Not,t),Not.prototype.tt=Ee.NOT,Not.prototype.mt="not",Not}(sr),t=function(t){function Add(){return Add.__super__.constructor.apply(this,arguments)}return extend(Add,t),Add.prototype.tt=Ee.ADD,Add.prototype.mt="add",Add}(sr),Lr=function(t){function Sub(){return Sub.__super__.constructor.apply(this,arguments)}return extend(Sub,t),Sub.prototype.tt=Ee.SUB,Sub.prototype.mt="sub",Sub}(sr),Kt=function(t){function Mul(){return Mul.__super__.constructor.apply(this,arguments)}return extend(Mul,t),Mul.prototype.tt=Ee.MUL,Mul.prototype.mt="mul",Mul}(sr),V=function(t){function Div(){return Div.__super__.constructor.apply(this,arguments)}return extend(Div,t),Div.prototype.tt=Ee.DIV,Div.prototype.mt="div",Div}(sr),Yt=function(t){function Mod(){return Mod.__super__.constructor.apply(this,arguments)}return extend(Mod,t),Mod.prototype.tt=Ee.MOD,Mod.prototype.mt="mod",Mod}(sr),i=function(t){function BitAnd(){return BitAnd.__super__.constructor.apply(this,arguments)}return extend(BitAnd,t),BitAnd.prototype.tt=Ee.BIT_AND,BitAnd.prototype.mt="bitAnd",BitAnd}(sr),l=function(t){function BitOr(){return BitOr.__super__.constructor.apply(this,arguments)}return extend(BitOr,t),BitOr.prototype.tt=Ee.BIT_OR,BitOr.prototype.mt="bitOr",BitOr}(sr),f=function(t){function BitXor(){return BitXor.__super__.constructor.apply(this,arguments)}return extend(BitXor,t),BitXor.prototype.tt=Ee.BIT_XOR,BitXor.prototype.mt="bitXor",BitXor}(sr),a=function(t){function BitNot(){return BitNot.__super__.constructor.apply(this,arguments)}return extend(BitNot,t),BitNot.prototype.tt=Ee.BIT_NOT,BitNot.prototype.mt="bitNot",BitNot}(sr),s=function(t){function BitSal(){return BitSal.__super__.constructor.apply(this,arguments)}return extend(BitSal,t),BitSal.prototype.tt=Ee.BIT_SAL,BitSal.prototype.mt="bitSal",BitSal}(sr),y=function(t){function BitSar(){return BitSar.__super__.constructor.apply(this,arguments)}return extend(BitSar,t),BitSar.prototype.tt=Ee.BIT_SAR,BitSar.prototype.mt="bitSar",BitSar}(sr),Q=function(t){function Floor(){return Floor.__super__.constructor.apply(this,arguments)}return extend(Floor,t),Floor.prototype.tt=Ee.FLOOR,Floor.prototype.mt="floor",Floor}(sr),R=function(t){function Ceil(){return Ceil.__super__.constructor.apply(this,arguments)}return extend(Ceil,t),Ceil.prototype.tt=Ee.CEIL,Ceil.prototype.mt="ceil",Ceil}(sr),vr=function(t){function Round(){return Round.__super__.constructor.apply(this,arguments)}return extend(Round,t),Round.prototype.tt=Ee.ROUND,Round.prototype.mt="round",Round}(sr),e=function(t){function Append(){return Append.__super__.constructor.apply(this,arguments)}return extend(Append,t),Append.prototype.tt=Ee.APPEND,Append.prototype.mt="append",Append}(sr),ar=function(t){function Prepend(){return Prepend.__super__.constructor.apply(this,arguments)}return extend(Prepend,t),Prepend.prototype.tt=Ee.PREPEND,Prepend.prototype.mt="prepend",Prepend}(sr),q=function(t){function Difference(){return Difference.__super__.constructor.apply(this,arguments)}return extend(Difference,t),Difference.prototype.tt=Ee.DIFFERENCE,Difference.prototype.mt="difference",Difference}(sr),Dr=function(t){function SetInsert(){return SetInsert.__super__.constructor.apply(this,arguments)}return extend(SetInsert,t),SetInsert.prototype.tt=Ee.SET_INSERT,SetInsert.prototype.mt="setInsert",SetInsert}(sr),Tr=function(t){function SetUnion(){return SetUnion.__super__.constructor.apply(this,arguments)}return extend(SetUnion,t),SetUnion.prototype.tt=Ee.SET_UNION,SetUnion.prototype.mt="setUnion",SetUnion}(sr),wr=function(t){function SetIntersection(){return SetIntersection.__super__.constructor.apply(this,arguments)}return extend(SetIntersection,t),SetIntersection.prototype.tt=Ee.SET_INTERSECTION,SetIntersection.prototype.mt="setIntersection",SetIntersection}(sr),Cr=function(t){function SetDifference(){return SetDifference.__super__.constructor.apply(this,arguments)}return extend(SetDifference,t),SetDifference.prototype.tt=Ee.SET_DIFFERENCE,SetDifference.prototype.mt="setDifference",SetDifference}(sr),Ar=function(t){function Slice(){return Slice.__super__.constructor.apply(this,arguments)}return extend(Slice,t),Slice.prototype.tt=Ee.SLICE,Slice.prototype.mt="slice",Slice}(sr),Ir=function(t){function Skip(){return Skip.__super__.constructor.apply(this,arguments)}return extend(Skip,t),Skip.prototype.tt=Ee.SKIP,Skip.prototype.mt="skip",Skip}(sr),jt=function(t){function Limit(){return Limit.__super__.constructor.apply(this,arguments)}return extend(Limit,t),Limit.prototype.tt=Ee.LIMIT,Limit.prototype.mt="limit",Limit}(sr),nt=function(t){function GetField(){return GetField.__super__.constructor.apply(this,arguments)}return extend(GetField,t),GetField.prototype.tt=Ee.GET_FIELD,GetField.prototype.mt="getField",GetField}(sr),_=function(t){function Bracket(){return Bracket.__super__.constructor.apply(this,arguments)}return extend(Bracket,t),Bracket.prototype.tt=Ee.BRACKET,Bracket.prototype.st="(...)",Bracket.prototype.compose=function(t){return[t[0],"(",t[1],")"]},Bracket}(sr),g=function(t){function Contains(){return Contains.__super__.constructor.apply(this,arguments)}return extend(Contains,t),Contains.prototype.tt=Ee.CONTAINS,Contains.prototype.mt="contains",Contains}(sr),wt=function(t){function InsertAt(){return InsertAt.__super__.constructor.apply(this,arguments)}return extend(InsertAt,t),InsertAt.prototype.tt=Ee.INSERT_AT,InsertAt.prototype.mt="insertAt",InsertAt}(sr),Br=function(t){function SpliceAt(){return SpliceAt.__super__.constructor.apply(this,arguments)}return extend(SpliceAt,t),SpliceAt.prototype.tt=Ee.SPLICE_AT,SpliceAt.prototype.mt="spliceAt",SpliceAt}(sr),F=function(t){function DeleteAt(){return DeleteAt.__super__.constructor.apply(this,arguments)}return extend(DeleteAt,t),DeleteAt.prototype.tt=Ee.DELETE_AT,DeleteAt.prototype.mt="deleteAt",DeleteAt}(sr),E=function(t){function ChangeAt(){return ChangeAt.__super__.constructor.apply(this,arguments)}return extend(ChangeAt,t),ChangeAt.prototype.tt=Ee.CHANGE_AT,ChangeAt.prototype.mt="changeAt",ChangeAt}(sr),lt=function(t){function HasFields(){return HasFields.__super__.constructor.apply(this,arguments)}return extend(HasFields,t),HasFields.prototype.tt=Ee.HAS_FIELDS,HasFields.prototype.mt="hasFields",HasFields}(sr),pe=function(t){function WithFields(){return WithFields.__super__.constructor.apply(this,arguments)}return extend(WithFields,t),WithFields.prototype.tt=Ee.WITH_FIELDS,WithFields.prototype.mt="withFields",WithFields}(sr),Bt=function(t){function Keys(){return Keys.__super__.constructor.apply(this,arguments)}return extend(Keys,t),Keys.prototype.tt=Ee.KEYS,Keys.prototype.mt="keys",Keys}(sr),ee=function(t){function Values(){return Values.__super__.constructor.apply(this,arguments)}return extend(Values,t),Values.prototype.tt=Ee.VALUES,Values.prototype.mt="values",Values}(sr),m=function(t){function Changes(){return Changes.__super__.constructor.apply(this,arguments)}return extend(Changes,t),Changes.prototype.tt=Ee.CHANGES,Changes.prototype.mt="changes",Changes}(sr),tr=function(t){function Object_(){return Object_.__super__.constructor.apply(this,arguments)}return extend(Object_,t),Object_.prototype.tt=Ee.OBJECT,Object_.prototype.mt="object",Object_}(sr),pr=function(t){function Pluck(){return Pluck.__super__.constructor.apply(this,arguments)}return extend(Pluck,t),Pluck.prototype.tt=Ee.PLUCK,Pluck.prototype.mt="pluck",Pluck}(sr),rr=function(t){function OffsetsOf(){return OffsetsOf.__super__.constructor.apply(this,arguments)}return extend(OffsetsOf,t),OffsetsOf.prototype.tt=Ee.OFFSETS_OF,OffsetsOf.prototype.mt="offsetsOf",OffsetsOf}(sr),ce=function(t){function Without(){return Without.__super__.constructor.apply(this,arguments)}return extend(Without,t),Without.prototype.tt=Ee.WITHOUT,Without.prototype.mt="without",Without}(sr),Ht=function(t){function Merge(){return Merge.__super__.constructor.apply(this,arguments)}return extend(Merge,t),Merge.prototype.tt=Ee.MERGE,Merge.prototype.mt="merge",Merge}(sr),c=function(t){function Between(){return Between.__super__.constructor.apply(this,arguments)}return extend(Between,t),Between.prototype.tt=Ee.BETWEEN,Between.prototype.mt="between",Between}(sr),mr=function(t){function Reduce(){return Reduce.__super__.constructor.apply(this,arguments)}return extend(Reduce,t),Reduce.prototype.tt=Ee.REDUCE,Reduce.prototype.mt="reduce",Reduce}(sr),Vt=function(t){function Map(){return Map.__super__.constructor.apply(this,arguments)}return extend(Map,t),Map.prototype.tt=Ee.MAP,Map.prototype.mt="map",Map}(sr),K=function(t){function Fold(){return Fold.__super__.constructor.apply(this,arguments)}return extend(Fold,t),Fold.prototype.tt=Ee.FOLD,Fold.prototype.mt="fold",Fold}(sr),Y=function(t){function Filter(){return Filter.__super__.constructor.apply(this,arguments)}return extend(Filter,t),Filter.prototype.tt=Ee.FILTER,Filter.prototype.mt="filter",Filter}(sr),b=function(t){function ConcatMap(){return ConcatMap.__super__.constructor.apply(this,arguments)}return extend(ConcatMap,t),ConcatMap.prototype.tt=Ee.CONCAT_MAP,ConcatMap.prototype.mt="concatMap",ConcatMap}(sr),nr=function(t){function OrderBy(){return OrderBy.__super__.constructor.apply(this,arguments)}return extend(OrderBy,t),OrderBy.prototype.tt=Ee.ORDER_BY,OrderBy.prototype.mt="orderBy",OrderBy}(sr),k=function(t){function Distinct(){return Distinct.__super__.constructor.apply(this,arguments)}return extend(Distinct,t),Distinct.prototype.tt=Ee.DISTINCT,Distinct.prototype.mt="distinct",Distinct}(sr),C=function(t){function Count(){return Count.__super__.constructor.apply(this,arguments)}return extend(Count,t),Count.prototype.tt=Ee.COUNT,Count.prototype.mt="count",Count}(sr),Zr=function(t){function Union(){return Union.__super__.constructor.apply(this,arguments)}return extend(Union,t),Union.prototype.tt=Ee.UNION,Union.prototype.mt="union",Union}(sr),$t=function(t){function Nth(){return Nth.__super__.constructor.apply(this,arguments)}return extend(Nth,t),Nth.prototype.tt=Ee.NTH,Nth.prototype.mt="nth",Nth}(sr),Qr=function(t){function ToJsonString(){return ToJsonString.__super__.constructor.apply(this,arguments)}return extend(ToJsonString,t),ToJsonString.prototype.tt=Ee.TO_JSON_STRING,ToJsonString.prototype.mt="toJsonString",ToJsonString}(sr),Mt=function(t){function Match(){return Match.__super__.constructor.apply(this,arguments)}return extend(Match,t),Match.prototype.tt=Ee.MATCH,Match.prototype.mt="match",Match}(sr),Nr=function(t){function Split(){return Split.__super__.constructor.apply(this,arguments)}return extend(Split,t),Split.prototype.tt=Ee.SPLIT,Split.prototype.mt="split",Split}(sr),$r=function(t){function Upcase(){return Upcase.__super__.constructor.apply(this,arguments)}return extend(Upcase,t),Upcase.prototype.tt=Ee.UPCASE,Upcase.prototype.mt="upcase",Upcase}(sr),M=function(t){function Downcase(){return Downcase.__super__.constructor.apply(this,arguments)}return extend(Downcase,t),Downcase.prototype.tt=Ee.DOWNCASE,Downcase.prototype.mt="downcase",Downcase}(sr),St=function(t){function IsEmpty(){return IsEmpty.__super__.constructor.apply(this,arguments)}return extend(IsEmpty,t),IsEmpty.prototype.tt=Ee.IS_EMPTY,IsEmpty.prototype.mt="isEmpty",IsEmpty}(sr),it=function(t){function Group(){return Group.__super__.constructor.apply(this,arguments)}return extend(Group,t),Group.prototype.tt=Ee.GROUP,Group.prototype.mt="group",Group}(sr),Fr=function(t){function Sum(){return Sum.__super__.constructor.apply(this,arguments)}return extend(Sum,t),Sum.prototype.tt=Ee.SUM,Sum.prototype.mt="sum",Sum}(sr),p=function(t){function Avg(){return Avg.__super__.constructor.apply(this,arguments)}return extend(Avg,t),Avg.prototype.tt=Ee.AVG,Avg.prototype.mt="avg",Avg}(sr),Wt=function(t){function Min(){return Min.__super__.constructor.apply(this,arguments)}return extend(Min,t),Min.prototype.tt=Ee.MIN,Min.prototype.mt="min",Min}(sr),xt=function(t){function Max(){return Max.__super__.constructor.apply(this,arguments)}return extend(Max,t),Max.prototype.tt=Ee.MAX,Max.prototype.mt="max",Max}(sr),Ct=function(t){function InnerJoin(){return InnerJoin.__super__.constructor.apply(this,arguments)}return extend(InnerJoin,t),InnerJoin.prototype.tt=Ee.INNER_JOIN,InnerJoin.prototype.mt="innerJoin",InnerJoin}(sr),or=function(t){function OuterJoin(){return OuterJoin.__super__.constructor.apply(this,arguments)}return extend(OuterJoin,t),OuterJoin.prototype.tt=Ee.OUTER_JOIN,OuterJoin.prototype.mt="outerJoin",OuterJoin}(sr),W=function(t){function EqJoin(){return EqJoin.__super__.constructor.apply(this,arguments)}return extend(EqJoin,t),EqJoin.prototype.tt=Ee.EQ_JOIN,EqJoin.prototype.mt="eqJoin",EqJoin}(sr),ie=function(t){function Zip(){return Zip.__super__.constructor.apply(this,arguments)}return extend(Zip,t),Zip.prototype.tt=Ee.ZIP,Zip.prototype.mt="zip",Zip}(sr),hr=function(t){function Range(){return Range.__super__.constructor.apply(this,arguments)}return extend(Range,t),Range.prototype.tt=Ee.RANGE,Range.prototype.st="range",Range}(sr),v=function(t){function CoerceTo(){return CoerceTo.__super__.constructor.apply(this,arguments)}return extend(CoerceTo,t),CoerceTo.prototype.tt=Ee.COERCE_TO,CoerceTo.prototype.mt="coerceTo",CoerceTo}(sr),zr=function(t){function Ungroup(){return Ungroup.__super__.constructor.apply(this,arguments)}return extend(Ungroup,t),Ungroup.prototype.tt=Ee.UNGROUP,Ungroup.prototype.mt="ungroup",Ungroup}(sr),Kr=function(t){function TypeOf(){return TypeOf.__super__.constructor.apply(this,arguments)}return extend(TypeOf,t),TypeOf.prototype.tt=Ee.TYPE_OF,TypeOf.prototype.mt="typeOf",TypeOf}(sr),gt=function(t){function Info(){return Info.__super__.constructor.apply(this,arguments)}return extend(Info,t),Info.prototype.tt=Ee.INFO,Info.prototype.mt="info",Info}(sr),br=function(t){function Sample(){return Sample.__super__.constructor.apply(this,arguments)}return extend(Sample,t),Sample.prototype.tt=Ee.SAMPLE,Sample.prototype.mt="sample",Sample}(sr),te=function(t){function Update(){return Update.__super__.constructor.apply(this,arguments)}return extend(Update,t),Update.prototype.tt=Ee.UPDATE,Update.prototype.mt="update",Update}(sr),L=function(t){function Delete(){return Delete.__super__.constructor.apply(this,arguments)}return extend(Delete,t),Delete.prototype.tt=Ee.DELETE,Delete.prototype.mt="delete",Delete}(sr),dr=function(t){function Replace(){return Replace.__super__.constructor.apply(this,arguments)}return extend(Replace,t),Replace.prototype.tt=Ee.REPLACE,Replace.prototype.mt="replace",Replace}(sr),Dt=function(t){function Insert(){return Insert.__super__.constructor.apply(this,arguments)}return extend(Insert,t),Insert.prototype.tt=Ee.INSERT,Insert.prototype.mt="insert",Insert}(sr),A=function(t){function DbCreate(){return DbCreate.__super__.constructor.apply(this,arguments)}return extend(DbCreate,t),DbCreate.prototype.tt=Ee.DB_CREATE,DbCreate.prototype.st="dbCreate",DbCreate}(sr),B=function(t){function DbDrop(){return DbDrop.__super__.constructor.apply(this,arguments)}return extend(DbDrop,t),DbDrop.prototype.tt=Ee.DB_DROP,DbDrop.prototype.st="dbDrop",DbDrop}(sr),N=function(t){function DbList(){return DbList.__super__.constructor.apply(this,arguments)}return extend(DbList,t),DbList.prototype.tt=Ee.DB_LIST,DbList.prototype.st="dbList",DbList}(sr),Pr=function(t){function TableCreate(){return TableCreate.__super__.constructor.apply(this,arguments)}return extend(TableCreate,t),TableCreate.prototype.tt=Ee.TABLE_CREATE,TableCreate.prototype.mt="tableCreate",TableCreate}(sr),kr=function(t){function TableDrop(){return TableDrop.__super__.constructor.apply(this,arguments)}return extend(TableDrop,t),TableDrop.prototype.tt=Ee.TABLE_DROP,TableDrop.prototype.mt="tableDrop",TableDrop}(sr),Vr=function(t){function TableList(){return TableList.__super__.constructor.apply(this,arguments)}return extend(TableList,t),TableList.prototype.tt=Ee.TABLE_LIST,TableList.prototype.mt="tableList",TableList}(sr),Sr=function(t){function SetWriteHook(){return SetWriteHook.__super__.constructor.apply(this,arguments)}return extend(SetWriteHook,t),SetWriteHook.prototype.tt=Ee.SET_WRITE_HOOK,SetWriteHook.prototype.mt="setWriteHook",SetWriteHook}(sr),ct=function(t){function GetWriteHook(){return GetWriteHook.__super__.constructor.apply(this,arguments)}return extend(GetWriteHook,t),GetWriteHook.prototype.tt=Ee.GET_WRITE_HOOK,GetWriteHook.prototype.mt="getWriteHook",GetWriteHook}(sr),Et=function(t){function IndexCreate(){return IndexCreate.__super__.constructor.apply(this,arguments)}return extend(IndexCreate,t),IndexCreate.prototype.tt=Ee.INDEX_CREATE,IndexCreate.prototype.mt="indexCreate",IndexCreate}(sr),mt=function(t){function IndexDrop(){return IndexDrop.__super__.constructor.apply(this,arguments)}return extend(IndexDrop,t),IndexDrop.prototype.tt=Ee.INDEX_DROP,IndexDrop.prototype.mt="indexDrop",IndexDrop}(sr),vt=function(t){function IndexRename(){return IndexRename.__super__.constructor.apply(this,arguments)}return extend(IndexRename,t),IndexRename.prototype.tt=Ee.INDEX_RENAME,IndexRename.prototype.mt="indexRename",IndexRename}(sr),dt=function(t){function IndexList(){return IndexList.__super__.constructor.apply(this,arguments)}return extend(IndexList,t),IndexList.prototype.tt=Ee.INDEX_LIST,IndexList.prototype.mt="indexList",IndexList}(sr),bt=function(t){function IndexStatus(){return IndexStatus.__super__.constructor.apply(this,arguments)}return extend(IndexStatus,t),IndexStatus.prototype.tt=Ee.INDEX_STATUS,IndexStatus.prototype.mt="indexStatus",IndexStatus}(sr),Ot=function(t){function IndexWait(){return IndexWait.__super__.constructor.apply(this,arguments)}return extend(IndexWait,t),IndexWait.prototype.tt=Ee.INDEX_WAIT,IndexWait.prototype.mt="indexWait",IndexWait}(sr),O=function(t){function Config(){return Config.__super__.constructor.apply(this,arguments)}return extend(Config,t),Config.prototype.tt=Ee.CONFIG,Config.prototype.mt="config",Config}(sr),jr=function(t){function Status(){return Status.__super__.constructor.apply(this,arguments)}return extend(Status,t),Status.prototype.tt=Ee.STATUS,Status.prototype.mt="status",Status}(sr),oe=function(t){function Wait(){return Wait.__super__.constructor.apply(this,arguments)}return extend(Wait,t),Wait.prototype.tt=Ee.WAIT,Wait.prototype.mt="wait",Wait}(sr),Er=function(t){function Reconfigure(){return Reconfigure.__super__.constructor.apply(this,arguments)}return extend(Reconfigure,t),Reconfigure.prototype.tt=Ee.RECONFIGURE,Reconfigure.prototype.mt="reconfigure",Reconfigure}(sr),Rr=function(t){function Rebalance(){return Rebalance.__super__.constructor.apply(this,arguments)}return extend(Rebalance,t),Rebalance.prototype.tt=Ee.REBALANCE,Rebalance.prototype.mt="rebalance",Rebalance}(sr),Ur=function(t){function Sync(){return Sync.__super__.constructor.apply(this,arguments)}return extend(Sync,t),Sync.prototype.tt=Ee.SYNC,Sync.prototype.mt="sync",Sync}(sr),ut=function(t){function Grant(){return Grant.__super__.constructor.apply(this,arguments)}return extend(Grant,t),Grant.prototype.tt=Ee.GRANT,Grant.prototype.mt="grant",Grant}(sr),z=function(t){function FunCall(){return FunCall.__super__.constructor.apply(this,arguments)}return extend(FunCall,t),FunCall.prototype.tt=Ee.FUNCALL,FunCall.prototype.st="do",FunCall.prototype.compose=function(t){return t.length>2?["r.do(",_e(t.slice(1)),", ",t[0],")"]:(de(this.args[1])&&(t[1]=["r(",t[1],")"]),[t[1],".do(",t[0],")"])},FunCall}(sr),j=function(t){function Default(){return Default.__super__.constructor.apply(this,arguments)}return extend(Default,t),Default.prototype.tt=Ee.DEFAULT,Default.prototype.mt="default",Default}(sr),h=function(t){function Branch(){return Branch.__super__.constructor.apply(this,arguments)}return extend(Branch,t),Branch.prototype.tt=Ee.BRANCH,Branch.prototype.st="branch",Branch}(sr),er=function(t){function Or(){return Or.__super__.constructor.apply(this,arguments)}return extend(Or,t),Or.prototype.tt=Ee.OR,Or.prototype.mt="or",Or}(sr),r=function(t){function And(){return And.__super__.constructor.apply(this,arguments)}return extend(And,t),And.prototype.tt=Ee.AND,And.prototype.mt="and",And}(sr),X=function(t){function ForEach(){return ForEach.__super__.constructor.apply(this,arguments)}return extend(ForEach,t),ForEach.prototype.tt=Ee.FOR_EACH,ForEach.prototype.mt="forEach",ForEach}(sr),Z=function(t){function Func(t,r){var e,n,o,p,c;for(n=[],e=[],c=0;c<r.length;)e.push(Func.nextVarId),n.push(new ne({},Func.nextVarId)),Func.nextVarId++,c++;if(void 0===(p=r.apply(null,n)))throw new se.ReqlDriverCompileError("Anonymous function returned `undefined`. Did you forget a `return`?");return o=function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Pt,[{}].concat(Ce.call(e)),(function(){})),Func.__super__.constructor.call(this,t,o,p)}return extend(Func,t),Func.prototype.tt=Ee.FUNC,Func.nextVarId=0,Func.prototype.compose=function(t){var r,e,n,o,p,c;if(!0===fe(t[1]))return[t[1]];for(c="",e=n=0,o=(p=t[0][1]).length;n<o;e=++n)r=p[e],c+=e%2==0?ne.prototype.compose(r):r;return["function(",c,") { return ",t[1],"; }"]},Func}(sr),o=function(t){function Asc(){return Asc.__super__.constructor.apply(this,arguments)}return extend(Asc,t),Asc.prototype.tt=Ee.ASC,Asc.prototype.st="asc",Asc}(sr),U=function(t){function Desc(){return Desc.__super__.constructor.apply(this,arguments)}return extend(Desc,t),Desc.prototype.tt=Ee.DESC,Desc.prototype.st="desc",Desc}(sr),Ut=function(t){function Literal(){return Literal.__super__.constructor.apply(this,arguments)}return extend(Literal,t),Literal.prototype.tt=Ee.LITERAL,Literal.prototype.st="literal",Literal}(sr),ft=function(t){function ISO8601(){return ISO8601.__super__.constructor.apply(this,arguments)}return extend(ISO8601,t),ISO8601.prototype.tt=Ee.ISO8601,ISO8601.prototype.st="ISO8601",ISO8601}(sr),Yr=function(t){function ToISO8601(){return ToISO8601.__super__.constructor.apply(this,arguments)}return extend(ToISO8601,t),ToISO8601.prototype.tt=Ee.TO_ISO8601,ToISO8601.prototype.mt="toISO8601",ToISO8601}(sr),G=function(t){function EpochTime(){return EpochTime.__super__.constructor.apply(this,arguments)}return extend(EpochTime,t),EpochTime.prototype.tt=Ee.EPOCH_TIME,EpochTime.prototype.st="epochTime",EpochTime}(sr),Wr=function(t){function ToEpochTime(){return ToEpochTime.__super__.constructor.apply(this,arguments)}return extend(ToEpochTime,t),ToEpochTime.prototype.tt=Ee.TO_EPOCH_TIME,ToEpochTime.prototype.mt="toEpochTime",ToEpochTime}(sr),Zt=function(t){function Now(){return Now.__super__.constructor.apply(this,arguments)}return extend(Now,t),Now.prototype.tt=Ee.NOW,Now.prototype.st="now",Now}(sr),ht=function(t){function InTimezone(){return InTimezone.__super__.constructor.apply(this,arguments)}return extend(InTimezone,t),InTimezone.prototype.tt=Ee.IN_TIMEZONE,InTimezone.prototype.mt="inTimezone",InTimezone}(sr),x=function(t){function During(){return During.__super__.constructor.apply(this,arguments)}return extend(During,t),During.prototype.tt=Ee.DURING,During.prototype.mt="during",During}(sr),fr=function(t){function RQLDate(){return RQLDate.__super__.constructor.apply(this,arguments)}return extend(RQLDate,t),RQLDate.prototype.tt=Ee.DATE,RQLDate.prototype.mt="date",RQLDate}(sr),Gr=function(t){function TimeOfDay(){return TimeOfDay.__super__.constructor.apply(this,arguments)}return extend(TimeOfDay,t),TimeOfDay.prototype.tt=Ee.TIME_OF_DAY,TimeOfDay.prototype.mt="timeOfDay",TimeOfDay}(sr),Hr=function(t){function Timezone(){return Timezone.__super__.constructor.apply(this,arguments)}return extend(Timezone,t),Timezone.prototype.tt=Ee.TIMEZONE,Timezone.prototype.mt="timezone",Timezone}(sr),ue=function(t){function Year(){return Year.__super__.constructor.apply(this,arguments)}return extend(Year,t),Year.prototype.tt=Ee.YEAR,Year.prototype.mt="year",Year}(sr),Qt=function(t){function Month(){return Month.__super__.constructor.apply(this,arguments)}return extend(Month,t),Month.prototype.tt=Ee.MONTH,Month.prototype.mt="month",Month}(sr),w=function(t){function Day(){return Day.__super__.constructor.apply(this,arguments)}return extend(Day,t),Day.prototype.tt=Ee.DAY,Day.prototype.mt="day",Day}(sr),T=function(t){function DayOfWeek(){return DayOfWeek.__super__.constructor.apply(this,arguments)}return extend(DayOfWeek,t),DayOfWeek.prototype.tt=Ee.DAY_OF_WEEK,DayOfWeek.prototype.mt="dayOfWeek",DayOfWeek}(sr),S=function(t){function DayOfYear(){return DayOfYear.__super__.constructor.apply(this,arguments)}return extend(DayOfYear,t),DayOfYear.prototype.tt=Ee.DAY_OF_YEAR,DayOfYear.prototype.mt="dayOfYear",DayOfYear}(sr),st=function(t){function Hours(){return Hours.__super__.constructor.apply(this,arguments)}return extend(Hours,t),Hours.prototype.tt=Ee.HOURS,Hours.prototype.mt="hours",Hours}(sr),Jt=function(t){function Minutes(){return Minutes.__super__.constructor.apply(this,arguments)}return extend(Minutes,t),Minutes.prototype.tt=Ee.MINUTES,Minutes.prototype.mt="minutes",Minutes}(sr),gr=function(t){function Seconds(){return Seconds.__super__.constructor.apply(this,arguments)}return extend(Seconds,t),Seconds.prototype.tt=Ee.SECONDS,Seconds.prototype.mt="seconds",Seconds}(sr),xr=function(t){function Time(){return Time.__super__.constructor.apply(this,arguments)}return extend(Time,t),Time.prototype.tt=Ee.TIME,Time.prototype.st="time",Time}(sr),tt=function(t){function Geojson(){return Geojson.__super__.constructor.apply(this,arguments)}return extend(Geojson,t),Geojson.prototype.tt=Ee.GEOJSON,Geojson.prototype.st="geojson",Geojson}(sr),Jr=function(t){function ToGeojson(){return ToGeojson.__super__.constructor.apply(this,arguments)}return extend(ToGeojson,t),ToGeojson.prototype.tt=Ee.TO_GEOJSON,ToGeojson.prototype.mt="toGeojson",ToGeojson}(sr),cr=function(t){function Point(){return Point.__super__.constructor.apply(this,arguments)}return extend(Point,t),Point.prototype.tt=Ee.POINT,Point.prototype.st="point",Point}(sr),Ft=function(t){function Line(){return Line.__super__.constructor.apply(this,arguments)}return extend(Line,t),Line.prototype.tt=Ee.LINE,Line.prototype.st="line",Line}(sr),ur=function(t){function Polygon(){return Polygon.__super__.constructor.apply(this,arguments)}return extend(Polygon,t),Polygon.prototype.tt=Ee.POLYGON,Polygon.prototype.st="polygon",Polygon}(sr),P=function(t){function Distance(){return Distance.__super__.constructor.apply(this,arguments)}return extend(Distance,t),Distance.prototype.tt=Ee.DISTANCE,Distance.prototype.mt="distance",Distance}(sr),Tt=function(t){function Intersects(){return Intersects.__super__.constructor.apply(this,arguments)}return extend(Intersects,t),Intersects.prototype.tt=Ee.INTERSECTS,Intersects.prototype.mt="intersects",Intersects}(sr),Rt=function(t){function Includes(){return Includes.__super__.constructor.apply(this,arguments)}return extend(Includes,t),Includes.prototype.tt=Ee.INCLUDES,Includes.prototype.mt="includes",Includes}(sr),d=function(t){function Circle(){return Circle.__super__.constructor.apply(this,arguments)}return extend(Circle,t),Circle.prototype.tt=Ee.CIRCLE,Circle.prototype.st="circle",Circle}(sr),ot=function(t){function GetIntersecting(){return GetIntersecting.__super__.constructor.apply(this,arguments)}return extend(GetIntersecting,t),GetIntersecting.prototype.tt=Ee.GET_INTERSECTING,GetIntersecting.prototype.mt="getIntersecting",GetIntersecting}(sr),pt=function(t){function GetNearest(){return GetNearest.__super__.constructor.apply(this,arguments)}return extend(GetNearest,t),GetNearest.prototype.tt=Ee.GET_NEAREST,GetNearest.prototype.mt="getNearest",GetNearest}(sr),J=function(t){function Fill(){return Fill.__super__.constructor.apply(this,arguments)}return extend(Fill,t),Fill.prototype.tt=Ee.FILL,Fill.prototype.mt="fill",Fill}(sr),ir=function(t){function PolygonSub(){return PolygonSub.__super__.constructor.apply(this,arguments)}return extend(PolygonSub,t),PolygonSub.prototype.tt=Ee.POLYGON_SUB,PolygonSub.prototype.mt="polygonSub",PolygonSub}(sr),Xr=function(t){function UUID(){return UUID.__super__.constructor.apply(this,arguments)}return extend(UUID,t),UUID.prototype.tt=Ee.UUID,UUID.prototype.st="uuid",UUID}(sr),me.expr=ge(1,2,(function(t,r){var e;if(null==r&&(r=20),void 0===t)throw new se.ReqlDriverCompileError("Cannot wrap undefined with r.expr().");if(r<=0)throw new se.ReqlDriverCompileError("Nesting depth limit exceeded.");if("number"!=typeof r||isNaN(r))throw new se.ReqlDriverCompileError("Second argument to `r.expr` must be a number or undefined.");return t instanceof Mr?t:"function"==typeof t?new Z({},t):t instanceof Date?new ft({},t.toISOString()):t instanceof Buffer?new u(t):Array.isArray(t)?(t=function(){var n,o,p;for(p=[],n=0,o=t.length;n<o;n++)e=t[n],p.push(me.expr(e,r-1));return p}(),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Pt,[{}].concat(Ce.call(t)),(function(){}))):"number"==typeof t?new D(t):"[object Object]"===Object.prototype.toString.call(t)?new kt(t,r):new D(t)})),me.js=le((function(t,r){return new It(r,t)})),me.http=le((function(t,r){return new yt(r,t)})),me.json=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(At,[{}].concat(Ce.call(t)),(function(){}))},me.error=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(re,[{}].concat(Ce.call(t)),(function(){}))},me.random=function(){var t,r,e,n;return e={},t=r=1<=arguments.length?Ce.call(arguments,0):[],!(n=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Mr||(e=n,t=r.slice(0,r.length-1)),function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(_r,[e].concat(Ce.call(t)),(function(){}))},me.binary=ae((function(t){return new u(t)})),me.row=new _t({}),me.table=le((function(t,r){return new qr(r,t)})),me.db=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(I,[{}].concat(Ce.call(t)),(function(){}))},me.dbCreate=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(A,[{}].concat(Ce.call(t)),(function(){}))},me.dbDrop=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(B,[{}].concat(Ce.call(t)),(function(){}))},me.dbList=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(N,[{}].concat(Ce.call(t)),(function(){}))},me.tableCreate=le((function(t,r){return new Pr(r,t)})),me.tableDrop=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(kr,[{}].concat(Ce.call(t)),(function(){}))},me.tableList=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Vr,[{}].concat(Ce.call(t)),(function(){}))},me.grant=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ut,[{}].concat(Ce.call(t)),(function(){}))},me.do=ge(1,null,(function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(z,[{},ye(t.slice(-1)[0])].concat(Ce.call(t.slice(0,-1))),(function(){}))})),me.branch=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(h,[{}].concat(Ce.call(t)),(function(){}))},me.map=ge(1,null,(function(){var t,r,e;return t=2<=arguments.length?Ce.call(arguments,0,e=arguments.length-1):(e=0,[]),r=arguments[e++],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Vt,[{}].concat(Ce.call(t),[ye(r)]),(function(){}))})),me.group=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(it,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.reduce=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(mr,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.count=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(C,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.sum=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Fr,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.avg=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(p,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.min=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Wt,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.max=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(xt,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.distinct=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(k,[{}].concat(Ce.call(t)),(function(){}))},me.contains=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(g,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.asc=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(o,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.desc=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(U,[{}].concat(Ce.call(t.map(ye))),(function(){}))},me.eq=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(H,[{}].concat(Ce.call(t)),(function(){}))},me.ne=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Xt,[{}].concat(Ce.call(t)),(function(){}))},me.lt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(qt,[{}].concat(Ce.call(t)),(function(){}))},me.le=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Nt,[{}].concat(Ce.call(t)),(function(){}))},me.gt=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(at,[{}].concat(Ce.call(t)),(function(){}))},me.ge=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}($,[{}].concat(Ce.call(t)),(function(){}))},me.or=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(er,[{}].concat(Ce.call(t)),(function(){}))},me.and=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(r,[{}].concat(Ce.call(t)),(function(){}))},me.not=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(zt,[{}].concat(Ce.call(t)),(function(){}))},me.add=function(){var r;return r=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(t,[{}].concat(Ce.call(r)),(function(){}))},me.sub=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Lr,[{}].concat(Ce.call(t)),(function(){}))},me.div=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(V,[{}].concat(Ce.call(t)),(function(){}))},me.mul=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Kt,[{}].concat(Ce.call(t)),(function(){}))},me.mod=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Yt,[{}].concat(Ce.call(t)),(function(){}))},me.bitAnd=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(i,[{}].concat(Ce.call(t)),(function(){}))},me.bitOr=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(l,[{}].concat(Ce.call(t)),(function(){}))},me.bitXor=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(f,[{}].concat(Ce.call(t)),(function(){}))},me.bitNot=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(a,[{}].concat(Ce.call(t)),(function(){}))},me.bitSal=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(s,[{}].concat(Ce.call(t)),(function(){}))},me.bitSar=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(y,[{}].concat(Ce.call(t)),(function(){}))},me.floor=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Q,[{}].concat(Ce.call(t)),(function(){}))},me.ceil=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(R,[{}].concat(Ce.call(t)),(function(){}))},me.round=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(vr,[{}].concat(Ce.call(t)),(function(){}))},me.typeOf=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Kr,[{}].concat(Ce.call(t)),(function(){}))},me.info=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(gt,[{}].concat(Ce.call(t)),(function(){}))},me.literal=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ut,[{}].concat(Ce.call(t)),(function(){}))},me.ISO8601=le((function(t,r){return new ft(r,t)})),me.epochTime=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(G,[{}].concat(Ce.call(t)),(function(){}))},me.now=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Zt,[{}].concat(Ce.call(t)),(function(){}))},me.time=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(xr,[{}].concat(Ce.call(t)),(function(){}))},me.monday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.MONDAY,_Class.prototype.st="monday",_Class}(lr)),me.tuesday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.TUESDAY,_Class.prototype.st="tuesday",_Class}(lr)),me.wednesday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.WEDNESDAY,_Class.prototype.st="wednesday",_Class}(lr)),me.thursday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.THURSDAY,_Class.prototype.st="thursday",_Class}(lr)),me.friday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.FRIDAY,_Class.prototype.st="friday",_Class}(lr)),me.saturday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.SATURDAY,_Class.prototype.st="saturday",_Class}(lr)),me.sunday=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.SUNDAY,_Class.prototype.st="sunday",_Class}(lr)),me.january=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.JANUARY,_Class.prototype.st="january",_Class}(lr)),me.february=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.FEBRUARY,_Class.prototype.st="february",_Class}(lr)),me.march=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.MARCH,_Class.prototype.st="march",_Class}(lr)),me.april=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.APRIL,_Class.prototype.st="april",_Class}(lr)),me.may=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.MAY,_Class.prototype.st="may",_Class}(lr)),me.june=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.JUNE,_Class.prototype.st="june",_Class}(lr)),me.july=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.JULY,_Class.prototype.st="july",_Class}(lr)),me.august=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.AUGUST,_Class.prototype.st="august",_Class}(lr)),me.september=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.SEPTEMBER,_Class.prototype.st="september",_Class}(lr)),me.october=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.OCTOBER,_Class.prototype.st="october",_Class}(lr)),me.november=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.NOVEMBER,_Class.prototype.st="november",_Class}(lr)),me.december=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.DECEMBER,_Class.prototype.st="december",_Class}(lr)),me.minval=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.MINVAL,_Class.prototype.st="minval",_Class}(lr)),me.maxval=new(function(t){function _Class(){return _Class.__super__.constructor.apply(this,arguments)}return extend(_Class,t),_Class.prototype.tt=Ee.MAXVAL,_Class.prototype.st="maxval",_Class}(lr)),me.object=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(tr,[{}].concat(Ce.call(t)),(function(){}))},me.args=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(n,[{}].concat(Ce.call(t)),(function(){}))},me.geojson=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(tt,[{}].concat(Ce.call(t)),(function(){}))},me.point=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(cr,[{}].concat(Ce.call(t)),(function(){}))},me.line=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Ft,[{}].concat(Ce.call(t)),(function(){}))},me.polygon=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(ur,[{}].concat(Ce.call(t)),(function(){}))},me.intersects=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Tt,[{}].concat(Ce.call(t)),(function(){}))},me.distance=le((function(t,r,e){return new P(e,t,r)})),me.circle=le((function(t,r,e){return new d(e,t,r)})),me.uuid=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Xr,[{}].concat(Ce.call(t)),(function(){}))},me.range=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(hr,[{}].concat(Ce.call(t)),(function(){}))},me.union=function(){var t;return t=1<=arguments.length?Ce.call(arguments,0):[],function(t,r,e){e.prototype=t.prototype;var n=new e,o=t.apply(n,r);return Object(o)===o?o:n}(Zr,[{}].concat(Ce.call(t)),(function(){}))},me},returnNet=function(){let t,r,e,n,o,p,c,u,i,a,l,s,y,f,_,h,R,E,m,d,v,b,O,g,C,D,extend=function(t,r){for(var e in r)w.call(r,e)&&(t[e]=r[e]);function ctor(){this.constructor=t}return ctor.prototype=r.prototype,t.prototype=new ctor,t.__super__=r.prototype,t},w={}.hasOwnProperty;return D={},f=require("net"),O=require("tls"),l=require("events"),u=require("crypto"),g=returnUtil(),a=returnErrors(),i=returnCursor(),v=PROTODEF,m=v.VersionDummy.Version.V1_0,d=0,h=v.VersionDummy.Protocol.JSON,R=v.Query.QueryType,E=v.Response.ResponseType,b=returnAst(),p=g.ar,C=g.varar,c=g.aropt,s=g.mkAtom,y=g.mkErr,D.DEFAULT_HOST="localhost",D.DEFAULT_PORT=28015,e="SUCCESS",r="ERROR: Incorrect authorization key.\n",t=function(t){function Connection(t,r){var e,n,o;void 0===t?t={}:"string"==typeof t&&(t={host:t}),this.host=t.host||exports.DEFAULT_HOST,this.port=t.port||exports.DEFAULT_PORT,this.db=t.db,this.authKey=t.authKey||this.DEFAULT_AUTH_KEY,this.timeout=t.timeout||this.DEFAULT_TIMEOUT,"boolean"==typeof t.ssl&&t.ssl?this.ssl={}:"object"==typeof t.ssl?this.ssl=t.ssl:this.ssl=!1,this.outstandingCallbacks={},this.nextToken=1,this.open=!1,this.closing=!1,this.buffer=Buffer.alloc(0),this._events=this._events||{},o=this,n=function(t){return o.removeListener("connect",e),t instanceof a.ReqlError?r(t):r(new a.ReqlDriverError("Could not connect to "+o.host+":"+o.port+".\n"+t.message))},this.once("error",n),e=function(t){return function(){return t.removeListener("error",n),t.open=!0,r(null,t)}}(this),this.once("connect",e),this._closePromise=null}return extend(Connection,t),Connection.prototype.DEFAULT_AUTH_KEY="",Connection.prototype.DEFAULT_TIMEOUT=20,Connection.prototype._data=function(t){var r,e,n,o,p;for(this.buffer=Buffer.concat([this.buffer,t]),o=[];this.buffer.length>=12&&(p=this.buffer.readUInt32LE(0)+4294967296*this.buffer.readUInt32LE(4),n=this.buffer.readUInt32LE(8),this.buffer.length>=12+n);)e=this.buffer.slice(12,n+12),r=JSON.parse(e),this._processResponse(r,p),o.push(this.buffer=this.buffer.slice(12+n));return o},Connection.prototype._delQuery=function(t){return delete this.outstandingCallbacks[t]},Connection.prototype._processResponse=function(t,r){var e,n,o,p,c,u,l,f,_,h;if(l=t.p,null!=this.outstandingCallbacks[r])if(e=(f=this.outstandingCallbacks[r]).cb,h=f.root,n=f.cursor,u=f.opts,f.feed,null!=n){if(n._addResponse(t),n._endFlag&&0===n._outstandingRequests)return this._delQuery(r)}else if(null!=e)switch(t.t){case E.COMPILE_ERROR:return e(y(a.ReqlServerCompileError,t,h)),this._delQuery(r);case E.CLIENT_ERROR:return e(y(a.ReqlDriverError,t,h)),this._delQuery(r);case E.RUNTIME_ERROR:return o=g.errorClass(t.e),e(y(o,t,h)),this._delQuery(r);case E.SUCCESS_ATOM:return t=s(t,u),Array.isArray(t)&&(t=i.makeIterable(t)),null!=l&&(t={profile:l,value:t}),e(null,t),this._delQuery(r);case E.SUCCESS_PARTIAL:for(n=null,p=0,c=(_=t.n).length;p<c;p++)switch(_[p]){case v.Response.ResponseNote.SEQUENCE_FEED:null==n&&(n=new i.Feed(this,r,u,h));break;case v.Response.ResponseNote.UNIONED_FEED:null==n&&(n=new i.UnionedFeed(this,r,u,h));break;case v.Response.ResponseNote.ATOM_FEED:null==n&&(n=new i.AtomFeed(this,r,u,h));break;case v.Response.ResponseNote.ORDER_BY_LIMIT_FEED:null==n&&(n=new i.OrderByLimitFeed(this,r,u,h))}return null==n&&(n=new i.Cursor(this,r,u,h)),this.outstandingCallbacks[r].cursor=n,e(null,null!=l?{profile:l,value:n._addResponse(t)}:n._addResponse(t));case E.SUCCESS_SEQUENCE:return n=new i.Cursor(this,r,u,h),this._delQuery(r),e(null,null!=l?{profile:l,value:n._addResponse(t)}:n._addResponse(t));case E.WAIT_COMPLETE:return this._delQuery(r),e(null,null);case E.SERVER_INFO:return this._delQuery(r),e(null,t=s(t,u));default:return e(new a.ReqlDriverError("Unknown response type"))}},Connection.prototype.close=C(0,2,(function(t,r){var e,n,o,p,c;if(null!=r){if(p=t,"[object Object]"!==Object.prototype.toString.call(p))throw new a.ReqlDriverError("First argument to two-argument `close` must be an object.");e=r}else"[object Object]"===Object.prototype.toString.call(t)?(p=t,e=null):"function"==typeof t?(p={},e=t):(p=t,e=null);for(n in p)if(w.call(p,n)&&"noreplyWait"!==n)throw new a.ReqlDriverError("First argument to two-argument `close` must be { noreplyWait: <bool> }.");return null!=this._closePromise?this._closePromise.nodeify(e):(this.closing=!0,o=(null==p.noreplyWait||p.noreplyWait)&&this.open,this._closePromise=new Promise((c=this,function(t,r){var e;return e=function(e,n){return c.open=!1,c.closing=!1,c.cancel(),null!=e?r(e):t(n)},o?c.noreplyWait(e):e()})).nodeify(e))})),Connection.prototype.noreplyWait=C(0,1,(function(t){var r,e,n;return this.open?(e=this.nextToken++,(r={}).type=R.NOREPLY_WAIT,r.token=e,new Promise((n=this,function(t,o){var p;return p=function(r,e){return r?o(r):t(e)},n.outstandingCallbacks[e]={cb:p,root:null,opts:null},n._sendQuery(r)})).nodeify(t)):new Promise((function(t,r){return r(new a.ReqlDriverError("Connection is closed."))})).nodeify(t)})),Connection.prototype.server=C(0,1,(function(t){var r,e,n;return this.open?(e=this.nextToken++,(r={}).type=R.SERVER_INFO,r.token=e,new Promise((n=this,function(t,o){var p;return p=function(r,e){return r?o(r):t(e)},n.outstandingCallbacks[e]={cb:p,root:null,opts:null},n._sendQuery(r)})).nodeify(t)):new Promise((function(t,r){return r(new a.ReqlDriverError("Connection is closed."))})).nodeify(t)})),Connection.prototype.cancel=p((function(){var t,r,e,n;for(t in e={t:E.RUNTIME_ERROR,r:["Connection is closed."],b:[]},r=this.outstandingCallbacks)w.call(r,t)&&(null!=(n=r[t]).cursor?n.cursor._addResponse(e):null!=n.cb&&n.cb(y(g.errorClass(e.e),e,n.root)));return this.outstandingCallbacks={}})),Connection.prototype.reconnect=C(0,2,(function(t,r){var e,n,o;return null!=r?(n=t,e=r):"function"==typeof t?(n={},e=t):(n=null!=t?t:{},e=r),new Promise((o=this,function(t,r){var e;return e=function(e){return o.constructor.call(o,{host:o.host,port:o.port,timeout:o.timeout,authKey:o.authKey},(function(e,n){return null!=e?r(e):t(n)}))},o.close(n,e)})).nodeify(e)})),Connection.prototype.use=p((function(t){return this.db=t})),Connection.prototype.isOpen=function(){return this.open&&!this.closing},Connection.prototype._start=function(t,r,e){var n,o,p,c;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");for(n in p=this.nextToken++,(o={}).global_optargs={},o.type=R.START,o.query=t.build(),o.token=p,e)w.call(e,n)&&(c=e[n],o.global_optargs[g.fromCamelCase(n)]=b.expr(c).build());if(null==e.db&&null==this.db||(o.global_optargs.db=b.db(e.db||this.db).build()),null!=e.noreply&&(o.global_optargs.noreply=b.expr(!!e.noreply).build()),null!=e.profile&&(o.global_optargs.profile=b.expr(!!e.profile).build()),null!=e.noreply&&e.noreply||(this.outstandingCallbacks[p]={cb:r,root:t,opts:e}),this._sendQuery(o),null!=e.noreply&&e.noreply&&"function"==typeof r)return r(null)},Connection.prototype._continueQuery=function(t){var r;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");return r={type:R.CONTINUE,token:t},this._sendQuery(r)},Connection.prototype._endQuery=function(t){var r;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");return r={type:R.STOP,token:t},this._sendQuery(r)},Connection.prototype._sendQuery=function(t){var r;return r=[t.type],void 0!==t.query&&(r.push(t.query),null!=t.global_optargs&&Object.keys(t.global_optargs).length>0&&r.push(t.global_optargs)),this._writeQuery(t.token,JSON.stringify(r))},Connection}(l.EventEmitter),_={},o=function(t){function TcpConnection(t,r){var e,n;if(!TcpConnection.isAvailable())throw new a.ReqlDriverError("TCP sockets are not available in this environment");TcpConnection.__super__.constructor.call(this,t,r),this.ssl?(this.ssl.host=this.host,this.ssl.port=this.port,this.rawSocket=O.connect(this.ssl)):this.rawSocket=f.connect(this.port,this.host),this.rawSocket.setNoDelay(),this.rawSocket.setKeepAlive(!0),e=setTimeout((n=this,function(){return n.rawSocket.destroy(),n.emit("error",new a.ReqlTimeoutError("Could not connect to "+n.host+":"+n.port+", operation timed out."))}),1e3*this.timeout),this.rawSocket.once("error",(function(){return clearTimeout(e)})),this.rawSocket.once("connect",function(r){return function(){var n,o,p,c,i,l,s,y,f,R,E,d,v,b,O,g,C,D;return(C=Buffer.alloc(4)).writeUInt32LE(m,0),Buffer.alloc(4).writeUInt32LE(h,0),v=Buffer.from(u.randomBytes(18)).toString("base64"),r.rawSocket.user=t.user,r.rawSocket.password=t.password,void 0===r.rawSocket.user&&(r.rawSocket.user="admin"),void 0===r.rawSocket.password&&(r.rawSocket.password=""),c="n="+r.rawSocket.user+",r="+v,f=JSON.stringify({protocol_version:0,authentication_method:"SCRAM-SHA-256",authentication:"n,,"+c}),E=Buffer.from("\0","binary"),r.rawSocket.write(Buffer.concat([C,Buffer.from(f.toString()),E])),g=1,R=0,y=0,b="",O="",o="",p="",n=0,D=function(t,r){var e,n,o,p;for(p=[],e=n=0,o=Math.min(t.length,r.length);0<=o?n<o:n>o;e=0<=o?++n:--n)p.push(t[e]^r[e]);return Buffer.from(p)},d=function(t,r,e){var n,o,p,c,i,a;if(n=t.toString("base64")+","+r.toString("base64")+","+e.toString(),_[n])return _[n];for((p=u.createHmac("sha256",t)).update(r),p.update("\0\0\0"),i=a=p.digest(),o=0,c=e-1;0<=c?o<c:o>c;0<=c?++o:--o)(p=u.createHmac("sha256",t)).update(i),i=p.digest(),a=D(a,i);return _[n]=a,a},i=function(t,r){var e,n,o,p,c,u;for(o=void 0,u=r,c=void 0,t.length===r.length&&(o=t,c=0),t.length!==r.length&&(o=r,c=1),e=n=0,p=Math.min(o.length,u.length);0<=p?n<p:n>p;e=0<=p?++n:--n)c|=o[e]^u[e];return 0===c},s=function(t,e){return 10<=t&&t<=20?r.emit("error",new a.ReqlAuthError(e)):r.emit("error",new a.ReqlDriverError(e))},l=function(t){var _,h,m,C,w,T,S,I,A,B,N,j,L,F,U,q,P,k,V,M,x,G,H,W;for(r.buffer=Buffer.concat([r.buffer,t]),N=0,A=j=0,F=(q=r.buffer).length;j<F;A=++j)if(0===q[A]){x=r.buffer.slice(N,A),N=A+1,G=x.toString();try{M=JSON.parse(G)}catch(S){throw S,new a.ReqlDriverError(G)}if(1===g){if(!M.success)return void s(M.error_code,M.error);if(R=M.min_protocol_version,y=M.max_protocol_version,R>0||y<0)throw new a.ReqlDriverError("Unsupported protocol version 0, expected between "+R+" and "+y+".");g=2}else if(2===g){if(!M.success)return void s(M.error_code,M.error);for(h={},L=0,U=(P=(b=M.authentication).split(",")).length;L<U;L++)A=(B=P[L]).indexOf("="),h[B.slice(0,A)]=B.slice(A+1);if(o=h.r,p=Buffer.from(h.s,"base64"),n=parseInt(h.i),o.substr(0,v.length)!==v)throw new a.ReqlAuthError("Invalid nonce from server");m="c=biws,r="+o,k=d(r.rawSocket.password,p,n),C=u.createHmac("sha256",k).update("Client Key").digest(),H=u.createHash("sha256").update(C).digest(),_=c+","+b+","+m,T=u.createHmac("sha256",H).update(_).digest(),w=D(C,T),V=u.createHmac("sha256",k).update("Server Key").digest(),O=u.createHmac("sha256",V).update(_).digest(),g=3,f=JSON.stringify({authentication:m+",p="+w.toString("base64")}),E=Buffer.from("\0","binary"),r.rawSocket.write(Buffer.concat([Buffer.from(f.toString()),E]))}else{if(3!==g)throw new a.ReqlDriverError("Unexpected handshake state");if(!M.success)return void s(M.error_code,M.error);if(I=M.authentication.indexOf("="),W=M.authentication.slice(I+1),!i(W,O.toString("base64")))throw new a.ReqlAuthError("Invalid server signature");g=4,r.rawSocket.removeListener("data",l),r.rawSocket.on("data",(function(t){return r._data(t)})),clearTimeout(e),r.emit("connect")}}return r.buffer=r.buffer.slice(N+1)},r.rawSocket.on("data",l)}}(this)),this.rawSocket.on("error",function(t){return function(r){return t.emit("error",r)}}(this)),this.rawSocket.on("close",function(t){return function(){return t.isOpen()&&t.close({noreplyWait:!1}),t.emit("close")}}(this)),this.rawSocket.on("timeout",function(t){return function(){return t.open=!1,t.emit("timeout")}}(this))}return extend(TcpConnection,t),TcpConnection.isAvailable=function(){return!process.browser},TcpConnection.prototype.clientPort=function(){return this.rawSocket.localPort},TcpConnection.prototype.clientAddress=function(){return this.rawSocket.localAddress},TcpConnection.prototype.close=C(0,2,(function(t,r){var e,n,o;return null!=r?(n=t,e=r):"[object Object]"===Object.prototype.toString.call(t)?(n=t,e=null):"function"==typeof t?(n={},e=t):n={},new Promise((o=this,function(t,r){var e;return e=function(e,n){var p,c,u;return c=function(){return null!=e?r(e):t(n)},p=function(){var t;return c(),null!=(t=o.rawSocket)&&t.removeAllListeners(),o.rawSocket=null,o.emit("close")},null!=o.rawSocket?"closed"===o.rawSocket.readyState?p():(null!=(u=o.rawSocket)&&u.once("close",p),o.rawSocket.end()):process.nextTick(c)},TcpConnection.__super__.close.call(o,n,e)})).nodeify(e)})),TcpConnection.prototype.cancel=function(){return this.rawSocket.destroy(),TcpConnection.__super__.cancel.call(this)},TcpConnection.prototype._writeQuery=function(t,r){var e;return(e=Buffer.alloc(8)).writeUInt32LE(4294967295&t,0),e.writeUInt32LE(Math.floor(t/4294967295),4),this.rawSocket.write(e),this.write(Buffer.from(r))},TcpConnection.prototype.write=function(t){var r;return(r=Buffer.alloc(4)).writeUInt32LE(t.length,0),this.rawSocket.write(r),this.rawSocket.write(t)},TcpConnection}(t),n=function(t){function HttpConnection(t,r){var e,n,o,p;if(!HttpConnection.isAvailable())throw new a.ReqlDriverError("XMLHttpRequest is not available in this environment");HttpConnection.__super__.constructor.call(this,t,r),e="https"===t.protocol?"https":this.DEFAULT_PROTOCOL,n=e+"://"+this.host+":"+this.port+t.pathname+"ajax/reql/",(o=new XMLHttpRequest).open("POST",n+"open-new-connection?cacheBuster="+Math.random(),!0),o.responseType="text",o.onreadystatechange=(p=this,function(t){if(4===o.readyState)return 200===o.status?(p._url=n,p._connId=o.response,p.emit("connect")):p.emit("error",new a.ReqlDriverError("XHR error, http status "+o.status+"."))}),o.send(),this.xhr=o}return extend(HttpConnection,t),HttpConnection.prototype.DEFAULT_PROTOCOL="http",HttpConnection.isAvailable=function(){return"undefined"!=typeof XMLHttpRequest},HttpConnection.prototype.cancel=function(){var t;if(null!=this._connId)return this.xhr.abort(),(t=new XMLHttpRequest).open("POST",this._url+"close-connection?conn_id="+this._connId,!0),t.responseType="arraybuffer",t.send(),this._url=null,this._connId=null,HttpConnection.__super__.cancel.call(this)},HttpConnection.prototype.close=C(0,2,(function(t,r){var e,n;if(null!=r?(n=t,e=r):"[object Object]"===Object.prototype.toString.call(t)?(n=t,e=null):(n={},e=t),null!=e&&"function"!=typeof e)throw new a.ReqlDriverError("Final argument to `close` must be a callback function or object.");return HttpConnection.__super__.close.call(this,n,e)})),HttpConnection.prototype._writeQuery=function(t,r){var e;return(e=Buffer.alloc(encodeURI(r).split(/%..|./).length-1+8)).writeUInt32LE(4294967295&t,0),e.writeUInt32LE(Math.floor(t/4294967295),4),e.write(r,8),this.write(e,t)},HttpConnection.prototype.write=function(t,r){var e,n,o,p;for((o=new XMLHttpRequest).open("POST",this._url+"?conn_id="+this._connId,!0),o.responseType="arraybuffer",o.onreadystatechange=(p=this,function(t){var r,e;if(4===o.readyState&&200===o.status)return e=Buffer.from(function(){var t,e,n,p;for(p=[],t=0,e=(n=new Uint8Array(o.response)).length;t<e;t++)r=n[t],p.push(r);return p}()),p._data(e)}),o.onerror=function(t){return function(e){return t.outstandingCallbacks[r].cb(new Error("This HTTP connection is not open"))}}(this),n=new Uint8Array(t.length),e=0;e<t.length;)n[e]=t[e],e++;return o.send(n),this.xhr=o},HttpConnection}(t),D.isConnection=function(r){return r instanceof t},D.connect=C(0,2,(function(t,r){var e;return"function"==typeof t?(e={},r=t):e="string"==typeof t?t:Object.assign({},t),new Promise((function(t,r){var p,c;if(null!=e.authKey&&(null!=e.password||null!=e.user||null!=e.username))throw new a.ReqlDriverError("Cannot use both authKey and password");if(e.user&&e.username)throw new a.ReqlDriverError("Cannot use both user and username");return e.authKey?(e.user="admin",e.password=e.authKey):null!=e.username&&(e.user=e.username),p=function(t,r){if(o.isAvailable())return new o(t,r);if(n.isAvailable())return new n(t,r);throw new a.ReqlDriverError("Neither TCP nor HTTP avaiable in this environment")},c=function(e,n){return e?r(e):t(n)},p(e,c)})).nodeify(r)})),D.Connection=t,D.HttpConnection=n,D.TcpConnection=o,D};let net,rethinkdb;net=returnNet(),rethinkdb=returnAst(),rethinkdb.net=net,rethinkdb.connect=net.connect,rethinkdb.Error=returnErrors(),rethinkdb._bluebird=Promise,module.exports=rethinkdb;