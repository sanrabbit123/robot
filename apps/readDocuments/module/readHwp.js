(()=>{var t={895:t=>{var e,a=function(t){for(var e,a=0,n="";a<t.length;a++)(e=t[a].toString(16).toUpperCase()).length<2&&(e="0"+e),n+=a?" "+e:e;return n};void 0===e&&(e={record:{},node:{},tag:{},enum:{}}),e.enum.LineType1=["None","Solid","Dash","Dot","DashDot","DashDotDot","LongDash","Circle","DoubleSlim","SlimThick","ThickSlim","SlimThickSlim"],e.enum.LineType2=["Solid","Dash","Dot","DashDot","DashDotDot","LongDash","Circle","DoubleSlim","SlimThick","ThickSlim","SlimThickSlim"],e.enum.LineType3=[null,"Solid","Dot","Thick","Dash","DashDot","DashDotDot"],e.enum.LineWidth=["0.1mm","0.12mm","0.15mm","0.2mm","0.25mm","0.3mm","0.4mm","0.5mm","0.6mm","0.7mm","1.0mm","1.5mm","2.0mm","3.0mm","4.0mm","5.0mm"],e.enum.NumberType1=["Digit","CircledDigit","RomanCapital","RomanSmall","LatinCapital","LatinSmall","CircledLatinCapital","CircledLatinSmall","HangulSyllable","CircledHangulSyllable","HangulJamo","CircledHangulJamo","HangulPhonetic","Ideograph","CircledIdeograph"],e.enum.NumberType2=["Digit","CircledDigit","RomanCapital","RomanSmall","LatinCapital","LatinSmall","CircledLatinCapital","CircledLatinSmall","HangulSyllable","CircledHangulSyllable","HangulJamo","CircledHangulJamo","HangulPhonetic","Ideograph","CircledIdeograph","DecagonCircle","DecagonCircleHanja",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Symbol","UserChar"],e.enum.AlignmentType1=["Justify","Left","Right","Center","Distribute","DistributeSpace"],e.enum.AlignmentType2=["Left","Center","Right"],e.enum.ArrowType=["Normal","Arrow","Spear","ConcaveArrow","EmptyDiamond","EmptyCircle","EmptyBox","FilledDiamond","FilledCircle","FilledBox"],e.enum.ArrowSize=["SmallSmall","SmallMedium","SmallLarge","MediumSmall","MediumMedium","MediumLarge","LargeSmall","LargeMedium","LargeLarge"],e.enum.LangType=["Hangul","Latin","Hanja","Japanese","Other","Symbol","User"],e.enum.HatchStyle=["Horizontal","Vertical","Slash","BackSlash","Cross","CrossDiagonal"],e.enum.InfillMode=["Tile","TileHorzTop","TileHorzBottom","TileVertLeft","TileVertRight","Total","Center","CenterTop","CenterBottom","LeftCenter","LeftTop","LeftBottom","RightCenter","RightTop","RightBottom","Zoom"],e.enum.LineWrapType=["Break","Squeeze","Keep"],e.enum.TextWrapType=["Square","TopAndBottom","BehindText","InFrontOfText","Tight","Through"],e.enum.FieldType=["Clickhere","Hyperlink","Bookmark","Formula","Summery","UserInfo","Date","DocDate","Path","Crossref","Mailmerge","Memo","RevisionChange","RevisionSign","RevisionDelete","RevisionAttach","RevisionClipping","RevisionSawtooth","RevisionThinking","RevisionPraise","RevisionLine","RevisionSimpleChange","RevisionHyperlink","RevisionLineAttach","RevisionLineLink","RevisionLineTransfer","RevisionRightmove","RevisionLeftmove","RevisionTransfer","RevisionSplit"],e.enum.BinItemType=["Link","Embedding","Storage"],e.enum.FontType=["rep","ttf","hft"],e.enum.GradationType=[null,"Linear","Radial","Conical","Square"],e.enum.ShadowType=[null,"Drop","Cont"],e.enum.ImageEffectType=["RealPic","GrayScale","BlackWhite"],e.enum.UnderlineType=[null,"Bottom","Center","Top"],e.enum.StrikeoutType=["None","Continuous"],e.enum.TabItemType=["Left","Right","Center","Decimal"],e.enum.TextOffsetType=["percent","hwpunit"],e.enum.VerAlignType=["Baseline","Top","Center","Bottom"],e.enum.HeadingType=["None","Outline","Number","Bullet"],e.enum.BreakLatinWordType=["KeepWord","Hyphenation","BreakWord"],e.enum.LineSpacingType=["Percent","Fixed","BetweenLines","AtLeast"],e.enum.StyleType=["Para","Char"],e.enum.ItemType=["Bstr","Integer","Set","Array","BinData"],e.enum.PageStartsOnType=["Both","Even","Odd"],e.enum.GutterType=["LeftOnly","LeftRight","TopBottom"],e.enum.NoteNumberingType=["Continuous","OnSection","OnPage"],e.enum.FootNoteShapePlaceType=["EachColumn","MergedColumn","RightMostColumn"],e.enum.EndNoteShapePlaceType=["EndOfDocument","EndOfSection"],e.enum.PageBorderFillType=["Both","Even","Odd"],e.enum.FillAreaType=["Paper","Page","Border"],e.enum.MasterPageType=["Both","Even","Odd"],e.enum.VertAlignType=["Top","Center","Bottom"],e.enum.ExtMasterPageType=["LastPage","OptionalPage"],e.enum.ColDefType=["Newspaper","BalancedNewspaper","Parallel"],e.enum.LayoutType=["Left","Right","Mirror"],e.enum.PageBreakType=["None","Table","Cell"],e.enum.NumberingType=["None","Figure","Table","Equation"],e.enum.TextFlowType=["BothSides","LeftOnly","RightOnly","LargestOnly"],e.enum.WidthRelToType=["Paper","Page","Column","Para","Absolute"],e.enum.HeightRelToType=["Paper","Page","Absolute"],e.enum.VertRelToType=["Paper","Page","Para"],e.enum.VertAlignType=["Top","Center","Bottom","Inside","Outside"],e.enum.HorzRelToType=["Paper","Page","Column","Para"],e.enum.HorzAlignType=["Left","Center","Right","Inside","Outside"],e.enum.SideType=["Left","Right","Top","Bottom"],e.enum.EndCapType=["Round","Flat"],e.enum.OutlineStyleType=["Normal","Outer","Inner"],e.enum.ArcType=["Normal","Pie","Chord"],e.enum.SegmentType=["Line","Curve"],e.enum.ObjetType=["Unknown","Embedded","Link","Static","Equation"],e.enum.DrawAspectType=["Content","ThumbNail","Icon","DocPrint"],e.enum.AlignType=["Left","Right","Center","Full","Table"],e.enum.PosType=["None","TopLeft","TopCenter","TopRight","BottomLeft","BottomCenter","BottomRight","OutsideTop","OutsideBottom","InsideTop","InsideBottom"],e.enum.TargetProgramType=["None","Hwp70","Word"],e.node.HWPML=function(){this.name="HWPML",this.attr={},this.children=[],this.attr.Version="2.8",this.attr.SubVersion="8.0.0.0",this.attr.Style="embed"},e.node.HEAD=function(){this.name="HEAD",this.attr={},this.children=[],this.attr.SecCnt=null},e.node.DOCSUMMARY=function(){this.name="DOCSUMMARY",this.attr={},this.children=[]},e.node.TITLE=function(){this.name="TITLE",this.attr={},this.children=[]},e.node.SUBJECT=function(){this.name="SUBJECT",this.attr={},this.children=[]},e.node.AUTHOR=function(){this.name="AUTHOR",this.attr={},this.children=[]},e.node.DATE=function(){this.name="DATE",this.attr={},this.children=[]},e.node.KEYWORDS=function(){this.name="KEYWORDS",this.attr={},this.children=[]},e.node.COMMENTS=function(){this.name="COMMENTS",this.attr={},this.children=[]},e.node.FORBIDDENSTRING=function(){this.name="FORBIDDENSTRING",this.attr={},this.children=[]},e.node.FORBIDDEN=function(){this.name="FORBIDDEN",this.attr={},this.children=[],this.encoding="base64",this.attr.Id=null},e.node.DOCSETTING=function(){this.name="DOCSETTING",this.attr={},this.children=[]},e.node.BEGINNUMBER=function(){this.name="BEGINNUMBER",this.attr={},this.children=[],this.attr.Page=null,this.attr.Footnote=null,this.attr.Endnote=null,this.attr.Picture=null,this.attr.Table=null,this.attr.Equation=null,this.attr.TotalPage=null},e.node.CARETPOS=function(){this.name="CARETPOS",this.attr={},this.children=[],this.attr.List=null,this.attr.Para=null,this.attr.Pos=null},e.node.MAPPINGTABLE=function(){this.name="MAPPINGTABLE",this.attr={},this.children=[]},e.node.BINDATALIST=function(){this.name="BINDATALIST",this.attr={},this.children=[],this.attr.Count="0"},e.node.BINITEM=function(){this.name="BINITEM",this.attr={},this.children=[],this.attr.Type=null,this.attr.APath=null,this.attr.RPath=null,this.attr.BinData=null,this.attr.Format=null},e.node.FACENAMELIST=function(){this.name="FACENAMELIST",this.attr={},this.children=[]},e.node.FONTFACE=function(){this.name="FONTFACE",this.attr={},this.children=[],this.attr.Lang=null,this.attr.Count=null},e.node.FONT=function(){this.name="FONT",this.attr={},this.children=[],this.attr.Id=null,this.attr.Type=null,this.attr.Name=null},e.node.SUBSTFONT=function(){this.name="SUBSTFONT",this.attr={},this.children=[],this.attr.Type=null,this.attr.Name=null},e.node.TYPEINFO=function(){this.name="TYPEINFO",this.attr={},this.children=[],this.attr.FamilyType=null,this.attr.SerifStyle=null,this.attr.Weight=null,this.attr.Proportion=null,this.attr.Contrast=null,this.attr.StrokeVariation=null,this.attr.ArmStyle=null,this.attr.Letterform=null,this.attr.Midline=null,this.attr.XHeight=null},e.node.BORDERFILLLIST=function(){this.name="BORDERFILLLIST",this.attr={},this.children=[],this.attr.Count=null},e.node.BORDERFILL=function(){this.name="BORDERFILL",this.attr={},this.children=[],this.attr.Id=null,this.attr.ThreeD="false",this.attr.Shadow="false",this.attr.Slash="0",this.attr.BackSlash="0",this.attr.CrookedSlash="0",this.attr.CounterSlash="0",this.attr.CounterBackSlash="0",this.attr.BreakCellSeparateLine="0",this.attr.CenterLine="0"},e.node.LEFTBORDER=function(){this.name="LEFTBORDER",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color="0"},e.node.RIGHTBORDER=function(){this.name="RIGHTBORDER",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color="0"},e.node.TOPBORDER=function(){this.name="TOPBORDER",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color="0"},e.node.BOTTOMBORDER=function(){this.name="BOTTOMBORDER",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color="0"},e.node.DIAGONAL=function(){this.name="DIAGONAL",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color="0"},e.node.FILLBRUSH=function(){this.name="FILLBRUSH",this.attr={},this.children=[]},e.node.WINDOWBRUSH=function(){this.name="WINDOWBRUSH",this.attr={},this.children=[],this.attr.FaceColor=null,this.attr.HatchColor=null,this.attr.HatchStyle=null,this.attr.Alpha=null},e.node.GRADATION=function(){this.name="GRADATION",this.attr={},this.children=[],this.attr.Type=null,this.attr.Angle="90",this.attr.CenterX="0",this.attr.CenterY="0",this.attr.Step="50",this.attr.ColorNum="2",this.attr.StepCenter="50",this.attr.Alpha=null},e.node.COLOR=function(){this.name="COLOR",this.attr={},this.children=[],this.attr.Value=null},e.node.IMAGEBRUSH=function(){this.name="IMAGEBRUSH",this.attr={},this.children=[],this.attr.Mode="Tile"},e.node.IMAGE=function(){this.name="IMAGE",this.attr={},this.children=[],this.attr.Bright="0",this.attr.Contrast="0",this.attr.Effect=null,this.attr.BinItem=null,this.attr.Alpha=null},e.node.CHARSHAPELIST=function(){this.name="CHARSHAPELIST",this.attr={},this.children=[],this.attr.Count=null},e.node.CHARSHAPE=function(){this.name="CHARSHAPE",this.attr={},this.children=[],this.attr.Id=null,this.attr.Height="1000",this.attr.TextColor="0",this.attr.ShadeColor="4294967295",this.attr.UseFontSpace="false",this.attr.UseKerning="false",this.attr.SymMark="0",this.attr.BorderFillId=null},e.node.FONTID=function(){this.name="FONTID",this.attr={},this.children=[],this.attr.Hangul=null,this.attr.Latin=null,this.attr.Hanja=null,this.attr.Japanese=null,this.attr.Other=null,this.attr.Symbol=null,this.attr.User=null},e.node.RATIO=function(){this.name="RATIO",this.attr={},this.children=[],this.attr.Hangul="100",this.attr.Latin="100",this.attr.Hanja="100",this.attr.Japanese="100",this.attr.Other="100",this.attr.Symbol="100",this.attr.User="100"},e.node.CHARSPACING=function(){this.name="CHARSPACING",this.attr={},this.children=[],this.attr.Hangul="0",this.attr.Latin="0",this.attr.Hanja="0",this.attr.Japanese="0",this.attr.Other="0",this.attr.Symbol="0",this.attr.User="0"},e.node.RELSIZE=function(){this.name="RELSIZE",this.attr={},this.children=[],this.attr.Hangul="100",this.attr.Latin="100",this.attr.Hanja="100",this.attr.Japanese="100",this.attr.Other="100",this.attr.Symbol="100",this.attr.User="100"},e.node.CHAROFFSET=function(){this.name="CHAROFFSET",this.attr={},this.children=[],this.attr.Hangul="0",this.attr.Latin="0",this.attr.Hanja="0",this.attr.Japanese="0",this.attr.Other="0",this.attr.Symbol="0",this.attr.User="0"},e.node.ITALIC=function(){this.name="ITALIC",this.attr={},this.children=[]},e.node.BOLD=function(){this.name="BOLD",this.attr={},this.children=[]},e.node.UNDERLINE=function(){this.name="UNDERLINE",this.attr={},this.children=[],this.attr.Type="Bottom",this.attr.Shape="Solid",this.attr.Color="0"},e.node.STRIKEOUT=function(){this.name="STRIKEOUT",this.attr={},this.children=[],this.attr.Type="Continuous",this.attr.Shape="Solid",this.attr.Color="0"},e.node.OUTLINE=function(){this.name="OUTLINE",this.attr={},this.children=[],this.attr.Type="Solid"},e.node.SHADOW=function(){this.name="SHADOW",this.attr={},this.children=[],this.attr.Type=null,this.attr.Color=null,this.attr.OffsetX="10",this.attr.OffsetY="10",this.attr.Alpha=null},e.node.EMBOSS=function(){this.name="EMBOSS",this.attr={},this.children=[]},e.node.ENGRAVE=function(){this.name="ENGRAVE",this.attr={},this.children=[]},e.node.SUPERSCRIPT=function(){this.name="SUPERSCRIPT",this.attr={},this.children=[]},e.node.SUBSCRIPT=function(){this.name="SUBSCRIPT",this.attr={},this.children=[]},e.node.TABDEFLIST=function(){this.name="TABDEFLIST",this.attr={},this.children=[],this.attr.Count=null},e.node.TABDEF=function(){this.name="TABDEF",this.attr={},this.children=[],this.attr.Id=null,this.attr.AutoTabLeft="false",this.attr.AutoTabRight="false"},e.node.TABITEM=function(){this.name="TABITEM",this.attr={},this.children=[],this.attr.Pos=null,this.attr.Type="Left",this.attr.Leader="Solid"},e.node.NUMBERINGLIST=function(){this.name="NUMBERINGLIST",this.attr={},this.children=[],this.attr.Count=null},e.node.NUMBERING=function(){this.name="NUMBERING",this.attr={},this.children=[],this.attr.Id=null,this.attr.Start="1"},e.node.PARAHEAD=function(){this.name="PARAHEAD",this.attr={},this.children=[],this.attr.Level=null,this.attr.Alignment="Left",this.attr.UseInstWidth="true",this.attr.AutoIndent="true",this.attr.WidthAdjust="0",this.attr.TextOffsetType="percent",this.attr.TextOffset="50",this.attr.NumFormat="Digit",this.attr.CharShape=null},e.node.BULLETLIST=function(){this.name="BULLETLIST",this.attr={},this.children=[],this.attr.Count=null},e.node.BULLET=function(){this.name="BULLET",this.attr={},this.children=[],this.attr.Id=null,this.attr.Char=null,this.attr.Image="false"},e.node.PARASHAPELIST=function(){this.name="PARASHAPELIST",this.attr={},this.children=[],this.attr.Count=null},e.node.PARASHAPE=function(){this.name="PARASHAPE",this.attr={},this.children=[],this.attr.Id=null,this.attr.Align="Justify",this.attr.VerAlign="Baseline",this.attr.HeadingType="None",this.attr.Heading=null,this.attr.Level="0",this.attr.TabDef=null,this.attr.BreakLatinWord="KeepWord",this.attr.BreakNonLatinWord="true",this.attr.Condense="0",this.attr.WidowOrphan="false",this.attr.KeepWithNext="false",this.attr.KeepLines="false",this.attr.PageBreakBefore="false",this.attr.FontLineHeight="false",this.attr.SnapToGrid="true",this.attr.LineWrap="break",this.attr.AutoSpaceEAsianEng="true",this.attr.AutoSpaceEAsianNum="true"},e.node.PARAMARGIN=function(){this.name="PARAMARGIN",this.attr={},this.children=[],this.attr.Indent="0",this.attr.Left="0",this.attr.Right="0",this.attr.Prev="0",this.attr.Next="0",this.attr.LineSpacingType="Percent",this.attr.LineSpacing="160"},e.node.PARABORDER=function(){this.name="PARABORDER",this.attr={},this.children=[],this.attr.BorderFill=null,this.attr.OffsetLeft=null,this.attr.OffsetRight=null,this.attr.OffsetTop=null,this.attr.OffsetBottom=null,this.attr.Connect="false",this.attr.IgnoreMargin="false"},e.node.STYLELIST=function(){this.name="STYLELIST",this.attr={},this.children=[],this.attr.Count=null},e.node.STYLE=function(){this.name="STYLE",this.attr={},this.children=[],this.attr.Id=null,this.attr.Type="Para",this.attr.Name=null,this.attr.EngName=null,this.attr.ParaShape=null,this.attr.CharShape=null,this.attr.NextStyle=null,this.attr.LangId=null,this.attr.LockForm=null},e.node.MEMOSHAPELIST=function(){this.name="MEMOSHAPELIST",this.attr={},this.children=[],this.attr.Count=null},e.node.MEMO=function(){this.name="MEMO",this.attr={},this.children=[],this.attr.Id=null,this.attr.Width="0",this.attr.LineType=null,this.attr.LineColor=null,this.attr.FillColor=null,this.attr.ActiveColor=null,this.attr.MemoType=null},e.node.BODY=function(){this.name="BODY",this.attr={},this.children=[]},e.node.SECTION=function(){this.name="SECTION",this.attr={},this.children=[],this.attr.Id=null},e.node.P=function(){this.name="P",this.attr={},this.children=[],this.attr.ParaShape=null,this.attr.Style=null,this.attr.InstId=null,this.attr.PageBreak="false",this.attr.ColumnBreak="false"},e.node.TEXT=function(){this.name="TEXT",this.attr={},this.children=[],this.attr.CharShape=null},e.node.CHAR=function(){this.name="CHAR",this.attr={},this.children=[],this.attr.Style=null},e.node.MARKPENBEGIN=function(){this.name="MARKPENBEGIN",this.attr={},this.children=[],this.attr.Color=null},e.node.MARKPENEND=function(){this.name="MARKPENEND",this.attr={},this.children=[]},e.node.TITLEMARK=function(){this.name="TITLEMARK",this.attr={},this.children=[],this.attr.Ignore=null},e.node.TAB=function(){this.name="TAB",this.attr={},this.children=[]},e.node.LINEBREAK=function(){this.name="LINEBREAK",this.attr={},this.children=[]},e.node.HYPEN=function(){this.name="HYPEN",this.attr={},this.children=[]},e.node.NBSPACE=function(){this.name="NBSPACE",this.attr={},this.children=[]},e.node.FWSPACE=function(){this.name="FWSPACE",this.attr={},this.children=[]},e.node.SECDEF=function(){this.name="SECDEF",this.attr={},this.children=[],this.attr.TextDirection="0",this.attr.SpaceColumns=null,this.attr.TabStop="8000",this.attr.OutlineShape="1",this.attr.LineGrid="0",this.attr.CharGrid="0",this.attr.FirstBorder="false",this.attr.FirstFill="false",this.attr.ExtMasterpageCount="0",this.attr.MemoShapeId=null,this.attr.TextVerticalWidthHead=null},e.node.PARAMETERSET=function(){this.name="PARAMETERSET",this.attr={},this.children=[],this.attr.SetId=null,this.attr.Count=null},e.node.PARAMETERARRAY=function(){this.name="PARAMETERARRAY",this.attr={},this.children=[],this.attr.Count=null},e.node.ITEM=function(){this.name="ITEM",this.attr={},this.children=[],this.attr.ItemId=null,this.attr.Type=null},e.node.STARTNUMBER=function(){this.name="STARTNUMBER",this.attr={},this.children=[],this.attr.PageStartsOn="Both",this.attr.Page="0",this.attr.Figure="0",this.attr.Table="0",this.attr.Equation="0"},e.node.HIDE=function(){this.name="HIDE",this.attr={},this.children=[],this.attr.Header="false",this.attr.Footer="false",this.attr.MasterPage="false",this.attr.Border="false",this.attr.Fill="false",this.attr.PageNumPos="false",this.attr.EmptyLine="false"},e.node.PAGEDEF=function(){this.name="PAGEDEF",this.attr={},this.children=[],this.attr.Landscape="0",this.attr.Width="59528",this.attr.Height="84188",this.attr.GutterType="LeftOnly"},e.node.PAGEMARGIN=function(){this.name="PAGEMARGIN",this.attr={},this.children=[],this.attr.Left="8504",this.attr.Right="8504",this.attr.Top="5668",this.attr.Bottom="4252",this.attr.Header="4252",this.attr.Footer="4252",this.attr.Gutter="0"},e.node.FOOTNOTESHAPE=function(){this.name="FOOTNOTESHAPE",this.attr={},this.children=[]},e.node.ENDNOTESHAPE=function(){this.name="ENDNOTESHAPE",this.attr={},this.children=[]},e.node.AUTONUMFORMAT=function(){this.name="AUTONUMFORMAT",this.attr={},this.children=[],this.attr.Type="Digit",this.attr.UserChar=null,this.attr.PrefixChar=null,this.attr.SuffixChar=")",this.attr.Superscript=null},e.node.NOTELINE=function(){this.name="NOTELINE",this.attr={},this.children=[],this.attr.Length=null,this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color=null},e.node.NOTESPACING=function(){this.name="NOTESPACING",this.attr={},this.children=[],this.attr.AboveLine=null,this.attr.BelowLine=null,this.attr.BetweenNotes=null},e.node.NOTENUMBERING=function(){this.name="NOTENUMBERING",this.attr={},this.children=[],this.attr.Type="Continuous",this.attr.NewNumber="1"},e.node.NOTEPLACEMENT=function(){this.name="NOTEPLACEMENT",this.attr={},this.children=[],this.attr.Place=null,this.attr.BeneathText=null},e.node.PAGEBORDERFILL=function(){this.name="PAGEBORDERFILL",this.attr={},this.children=[],this.attr.Type="Both",this.attr.BorderFill=null,this.attr.TextBorder="false",this.attr.HeaderInside="false",this.attr.FooterInside="false",this.attr.FillArea="Paper"},e.node.PAGEOFFSET=function(){this.name="PAGEOFFSET",this.attr={},this.children=[],this.attr.Left="1417",this.attr.Right="1417",this.attr.Top="1417",this.attr.Bottom="1417"},e.node.MASTERPAGE=function(){this.name="MASTERPAGE",this.attr={},this.children=[],this.attr.Type="Both",this.attr.TextWidth=null,this.attr.TextHeight=null,this.attr.HasTextRef="false",this.attr.HasNumRef="false"},e.node.PARALIST=function(){this.name="PARALIST",this.attr={},this.children=[],this.attr.TextDirection="0",this.attr.LineWrap="Break",this.attr.VertAlign="Top",this.attr.LinkListID=null,this.attr.LinkListIDNext=null},e.node.EXT_MASTERPAGE=function(){this.name="EXT_MASTERPAGE",this.attr={},this.children=[],this.attr.Type=null,this.attr.PageNumber=null,this.attr.PageDuplicate=null,this.attr.PageFront=null},e.node.COLDEF=function(){this.name="COLDEF",this.attr={},this.children=[],this.attr.Type="Newspaper",this.attr.Count="1",this.attr.Layout="Left",this.attr.SameSize="false",this.attr.SameGap="0"},e.node.COLUMNLINE=function(){this.name="COLUMNLINE",this.attr={},this.children=[],this.attr.Type="Solid",this.attr.Width="0.12mm",this.attr.Color=null},e.node.COLUMNTABLE=function(){this.name="COLUMNTABLE",this.attr={},this.children=[]},e.node.COLUMN=function(){this.name="COLUMN",this.attr={},this.children=[],this.attr.Width=null,this.attr.Gap=null},e.node.TABLE=function(){this.name="TABLE",this.attr={},this.children=[],this.attr.PageBreak="Cell",this.attr.RepeatHeader="true",this.attr.RowCount=null,this.attr.ColCount=null,this.attr.CellSpacing="0",this.attr.BorderFill=null},e.node.SHAPEOBJECT=function(){this.name="SHAPEOBJECT",this.attr={},this.children=[],this.attr.InstId=null,this.attr.ZOrder="0",this.attr.NumberingType="None",this.attr.TextWrap=null,this.attr.TextFlow="BothSides",this.attr.Lock="false"},e.node.SIZE=function(){this.name="SIZE",this.attr={},this.children=[],this.attr.Width=null,this.attr.Height=null,this.attr.WidthRelTo="Absolute",this.attr.HeightRelTo="Absolute",this.attr.Protect="false"},e.node.POSITION=function(){this.name="POSITION",this.attr={},this.children=[],this.attr.TreatAsChar=null,this.attr.AffectLSpacing="false",this.attr.VertRelTo=null,this.attr.VertAlign=null,this.attr.HorzRelTo=null,this.attr.HorzAlign=null,this.attr.VertOffset=null,this.attr.HorzOffset=null,this.attr.FlowWithText="false",this.attr.AllowOverlap="false",this.attr.HoldAnchorAndSO="false"},e.node.OUTSIDEMARGIN=function(){this.name="OUTSIDEMARGIN",this.attr={},this.children=[],this.attr.Left=null,this.attr.Right=null,this.attr.Top=null,this.attr.Bottom=null},e.node.CAPTION=function(){this.name="CAPTION",this.attr={},this.children=[],this.attr.Side="Left",this.attr.FullSize="false",this.attr.Width=null,this.attr.Gap=null,this.attr.LastWidth=null},e.node.SHAPECOMMENT=function(){this.name="SHAPECOMMENT",this.attr={},this.children=[]},e.node.INSIDEMARGIN=function(){this.name="INSIDEMARGIN",this.attr={},this.children=[],this.attr.Left=null,this.attr.Right=null,this.attr.Top=null,this.attr.Bottom=null},e.node.CELLZONELIST=function(){this.name="CELLZONELIST",this.attr={},this.children=[],this.attr.Count=null},e.node.CELLZONE=function(){this.name="CELLZONE",this.attr={},this.children=[],this.attr.StartRowAddr=null,this.attr.StartColAddr=null,this.attr.EndRowAddr=null,this.attr.EndColAddr=null,this.attr.BorderFill=null},e.node.ROW=function(){this.name="ROW",this.attr={},this.children=[]},e.node.CELL=function(){this.name="CELL",this.attr={},this.children=[],this.attr.Name=null,this.attr.ColAddr=null,this.attr.RowAddr=null,this.attr.ColSpan="1",this.attr.RowSpan="1",this.attr.Width=null,this.attr.Height=null,this.attr.Header="false",this.attr.HasMargin="false",this.attr.Protect="false",this.attr.Editable="false",this.attr.Dirty="false",this.attr.BorderFill=null},e.node.CELLMARGIN=function(){this.name="CELLMARGIN",this.attr={},this.children=[],this.attr.Left="0",this.attr.Right="0",this.attr.Top="0",this.attr.Bottom="0"},e.node.PICTURE=function(){this.name="PICTURE",this.attr={},this.children=[],this.attr.Reverse="false"},e.node.SHAPECOMPONENT=function(){this.name="SHAPECOMPONENT",this.attr={},this.children=[],this.attr.HRef=null,this.attr.XPos="0",this.attr.YPos="0",this.attr.GroupLevel="0",this.attr.OriWidth=null,this.attr.OriHeight=null,this.attr.CurWidth=null,this.attr.CurHeight=null,this.attr.HorzFlip="false",this.attr.VertFlip="false",this.attr.InstID=null},e.node.ROTATIONINFO=function(){this.name="ROTATIONINFO",this.attr={},this.children=[],this.attr.Angle="0",this.attr.CenterX=null,this.attr.CenterY=null},e.node.RENDERINGINFO=function(){this.name="RENDERINGINFO",this.attr={},this.children=[]},e.node.TRANSMATRIX=function(){this.name="TRANSMATRIX",this.attr={},this.children=[],this.attr.E1=null,this.attr.E2=null,this.attr.E3=null,this.attr.E4=null,this.attr.E5=null,this.attr.E6=null},e.node.SCAMATRIX=function(){this.name="SCAMATRIX",this.attr={},this.children=[],this.attr.E1=null,this.attr.E2=null,this.attr.E3=null,this.attr.E4=null,this.attr.E5=null,this.attr.E6=null},e.node.ROTMATRIX=function(){this.name="ROTMATRIX",this.attr={},this.children=[],this.attr.E1=null,this.attr.E2=null,this.attr.E3=null,this.attr.E4=null,this.attr.E5=null,this.attr.E6=null},e.node.LINESHAPE=function(){this.name="LINESHAPE",this.attr={},this.children=[],this.attr.Color=null,this.attr.Width=null,this.attr.Style="Solid",this.attr.EndCap="Flat",this.attr.HeadStyle="Normal",this.attr.TailStyle="Normal",this.attr.HeadSize="SmallSmall",this.attr.TailSize="SmallSmall",this.attr.OutlineStyle="Normal",this.attr.Alpha=null},e.node.IMAGERECT=function(){this.name="IMAGERECT",this.attr={},this.children=[],this.attr.X0=null,this.attr.Y0=null,this.attr.X1=null,this.attr.Y1=null,this.attr.X2=null,this.attr.Y2=null},e.node.IMAGECLIP=function(){this.name="IMAGECLIP",this.attr={},this.children=[],this.attr.Left=null,this.attr.Top=null,this.attr.Right=null,this.attr.Bottom=null},e.node.EFFECTS=function(){this.name="EFFECTS",this.attr={},this.children=[]},e.node.SHADOWEFFECT=function(){this.name="SHADOWEFFECT",this.attr={},this.children=[]},e.node.GLOW=function(){this.name="GLOW",this.attr={},this.children=[],this.attr.Alpha=null,this.attr.Radius=null},e.node.SOFTEDGE=function(){this.name="SOFTEDGE",this.attr={},this.children=[],this.attr.Radius=null},e.node.REFLECTION=function(){this.name="REFLECTION",this.attr={},this.children=[]},e.node.EFFECTSCOLOR=function(){this.name="EFFECTSCOLOR",this.attr={},this.children=[]},e.node.COLOREFFECT=function(){this.name="COLOREFFECT",this.attr={},this.children=[]},e.node.DRAWINGOBJECT=function(){this.name="DRAWINGOBJECT",this.attr={},this.children=[]},e.node.DRAWTEXT=function(){this.name="DRAWTEXT",this.attr={},this.children=[],this.attr.LastWidth=null,this.attr.Name=null,this.attr.Editable="false"},e.node.TEXTMARGIN=function(){this.name="TEXTMARGIN",this.attr={},this.children=[],this.attr.Left="238",this.attr.Right="238",this.attr.Top="238",this.attr.Bottom="238"},e.node.LINE=function(){this.name="LINE",this.attr={},this.children=[],this.attr.StartX=null,this.attr.StartY=null,this.attr.EndX=null,this.attr.EndY=null,this.attr.IsReverseHV="false"},e.node.RECTANGLE=function(){this.name="RECTANGLE",this.attr={},this.children=[],this.attr.Ratio=null,this.attr.X0=null,this.attr.Y0=null,this.attr.X1=null,this.attr.Y1=null,this.attr.X2=null,this.attr.Y2=null,this.attr.X3=null,this.attr.Y3=null},e.node.ELLIPSE=function(){this.name="ELLIPSE",this.attr={},this.children=[],this.attr.IntervalDirty="false",this.attr.HasArcProperty="false",this.attr.ArcType="Normal",this.attr.CenterX=null,this.attr.CenterY=null,this.attr.Axis1X=null,this.attr.Axis1Y=null,this.attr.Axis2X=null,this.attr.Axis2Y=null,this.attr.Start1X=null,this.attr.Start1Y=null,this.attr.End1X=null,this.attr.End1Y=null,this.attr.Start2X=null,this.attr.Start2Y=null,this.attr.End2X=null,this.attr.End2Y=null},e.node.ARC=function(){this.name="ARC",this.attr={},this.children=[],this.attr.Type="Normal",this.attr.CenterX=null,this.attr.CenterY=null,this.attr.Axis1X=null,this.attr.Axis1Y=null,this.attr.Axis2X=null,this.attr.Axis2Y=null},e.node.POLYGON=function(){this.name="POLYGON",this.attr={},this.children=[]},e.node.POINT=function(){this.name="POINT",this.attr={},this.children=[],this.attr.X=null,this.attr.Y=null},e.node.CURVE=function(){this.name="CURVE",this.attr={},this.children=[]},e.node.SEGMENT=function(){this.name="SEGMENT",this.attr={},this.children=[],this.attr.Type="Curve",this.attr.X1=null,this.attr.Y1=null,this.attr.X2=null,this.attr.Y2=null},e.node.CONNECTLINE=function(){this.name="CONNECTLINE",this.attr={},this.children=[],this.attr.Type=null,this.attr.StartX=null,this.attr.StartY=null,this.attr.EndX=null,this.attr.EndY=null,this.attr.StartSubjectID=null,this.attr.StartSubjectIndex=null,this.attr.EndSubjectID=null,this.attr.EndSubjectIndex=null},e.node.CONTROLPOINT=function(){this.name="CONTROLPOINT",this.attr={},this.children=[],this.attr.Type=null,this.attr.X=null,this.attr.Y=null},e.node.UNKNOWNOBJECT=function(){this.name="UNKNOWNOBJECT",this.attr={},this.children=[],this.attr.Ctrlid=null,this.attr.X0=null,this.attr.Y0=null,this.attr.X1=null,this.attr.Y1=null,this.attr.X2=null,this.attr.Y2=null,this.attr.X3=null,this.attr.Y3=null},e.node.FORMOBJECT=function(){this.name="FORMOBJECT",this.attr={},this.children=[],this.attr.Name=null,this.attr.ForeColor=null,this.attr.BackColor=null,this.attr.GroupName=null,this.attr.TabStop="true",this.attr.TabOrder=null,this.attr.Enabled="true",this.attr.BorderType="0",this.attr.DrawFrame="true",this.attr.Printable="true"},e.node.FORMCHARSHAPE=function(){this.name="FORMCHARSHAPE",this.attr={},this.children=[],this.attr.CharShape="0",this.attr.FollowContext="false",this.attr.AutoSize="false",this.attr.WordWrap="false"},e.node.BUTTONSET=function(){this.name="BUTTONSET",this.attr={},this.children=[],this.attr.Caption=null,this.attr.Value=null,this.attr.RadioGroupName=null,this.attr.TriState=null,this.attr.BackStyle=null},e.node.RADIOBUTTON=function(){this.name="RADIOBUTTON",this.attr={},this.children=[]},e.node.CHECKBUTTON=function(){this.name="CHECKBUTTON",this.attr={},this.children=[]},e.node.COMBOBOX=function(){this.name="COMBOBOX",this.attr={},this.children=[],this.attr.ListBoxRows=null,this.attr.ListBoxWidth=null,this.attr.Text=null,this.attr.EditEnable=null},e.node.EDIT=function(){this.name="EDIT",this.attr={},this.children=[],this.attr.MultiLine=null,this.attr.PasswordChar=null,this.attr.MaxLength=null,this.attr.ScrollBars=null,this.attr.TabKeyBehavior=null,this.attr.Number=null,this.attr.ReadOnly=null,this.attr.AlignText=null},e.node.EDITTEXT=function(){this.name="EDITTEXT",this.attr={},this.children=[]},e.node.LISTBOX=function(){this.name="LISTBOX",this.attr={},this.children=[]},e.node.SCROLLBAR=function(){this.name="SCROLLBAR",this.attr={},this.children=[]},e.node.CONTAINER=function(){this.name="CONTAINER",this.attr={},this.children=[]},e.node.OLE=function(){this.name="OLE",this.attr={},this.children=[],this.attr.ObjetType=null,this.attr.ExtentX=null,this.attr.ExtentY=null,this.attr.BinItem=null,this.attr.DrawAspect=null,this.attr.HasMoniker="false",this.attr.EqBaseLine=null},e.node.EQUATION=function(){this.name="EQUATION",this.attr={},this.children=[],this.attr.LineMode="false",this.attr.BaseUnit="1000",this.attr.TextColor="0",this.attr.BaseLine=null,this.attr.Version=null},e.node.SCRIPT=function(){this.name="SCRIPT",this.attr={},this.children=[]},e.node.TEXTART=function(){this.name="TEXTART",this.attr={},this.children=[],this.attr.Text=null,this.attr.X0=null,this.attr.Y0=null,this.attr.X1=null,this.attr.Y1=null,this.attr.X2=null,this.attr.Y2=null,this.attr.X3=null,this.attr.Y3=null},e.node.TEXTARTSHAPE=function(){this.name="TEXTARTSHAPE",this.attr={},this.children=[],this.attr.FontName=null,this.attr.FontStyle="Regular",this.attr.FontType="ttf",this.attr.TextShape="0",this.attr.LineSpacing="120",this.attr.CharSpacing="100",this.attr.Align="Left"},e.node.OUTLINEDATA=function(){this.name="OUTLINEDATA",this.attr={},this.children=[],this.attr.Count=null},e.node.FILEDBEGIN=function(){this.name="FILEDBEGIN",this.attr={},this.children=[],this.attr.Type=null,this.attr.Name=null,this.attr.InstId=null,this.attr.Editable="true",this.attr.Dirty="false",this.attr.Property=null,this.attr.Command=null},e.node.FIELDEND=function(){this.name="FIELDEND",this.attr={},this.children=[],this.attr.Type=null,this.attr.Editable="true",this.attr.Property=null},e.node.BOOKMARK=function(){this.name="BOOKMARK",this.attr={},this.children=[],this.attr.Name=null},e.node.HEADER=function(){this.name="HEADER",this.attr={},this.children=[]},e.node.FOOTER=function(){this.name="FOOTER",this.attr={},this.children=[]},e.node.FOOTNOTE=function(){this.name="FOOTNOTE",this.attr={},this.children=[]},e.node.ENDNOTE=function(){this.name="ENDNOTE",this.attr={},this.children=[]},e.node.AUTONUM=function(){this.name="AUTONUM",this.attr={},this.children=[]},e.node.NEWNUM=function(){this.name="NEWNUM",this.attr={},this.children=[]},e.node.PAGENUMCTRL=function(){this.name="PAGENUMCTRL",this.attr={},this.children=[],this.attr.PageStartsOn="Both"},e.node.PAGEHIDING=function(){this.name="PAGEHIDING",this.attr={},this.children=[],this.attr.HideHeader="false",this.attr.HideFooter="false",this.attr.HideMasterPage="false",this.attr.HideBorder="false",this.attr.HideFill="false",this.attr.HidePageNum="false"},e.node.PAGENUM=function(){this.name="PAGENUM",this.attr={},this.children=[],this.attr.Pos="TopLeft",this.attr.FormatType="Digit",this.attr.SideChar=null},e.node.INDEXMARK=function(){this.name="INDEXMARK",this.attr={},this.children=[]},e.node.KEYFIRST=function(){this.name="KEYFIRST",this.attr={},this.children=[]},e.node.KEYSECOND=function(){this.name="KEYSECOND",this.attr={},this.children=[]},e.node.COMPOSE=function(){this.name="COMPOSE",this.attr={},this.children=[]},e.node.COMPCHARSHAPE=function(){this.name="COMPCHARSHAPE",this.attr={},this.children=[],this.attr.ShapeID=null},e.node.DUTMAL=function(){this.name="DUTMAL",this.attr={},this.children=[]},e.node.MAINTEXT=function(){this.name="MAINTEXT",this.attr={},this.children=[]},e.node.SUBTEXT=function(){this.name="SUBTEXT",this.attr={},this.children=[]},e.node.HIDDENCOMMENT=function(){this.name="HIDDENCOMMENT",this.attr={},this.children=[]},e.node.TAIL=function(){this.name="TAIL",this.attr={},this.children=[]},e.node.BINDATASTORAGE=function(){this.name="BINDATASTORAGE",this.attr={},this.children=[]},e.node.BINDATA=function(){this.name="BINDATA",this.attr={},this.children=[],this.attr.Id=null,this.attr.Size=null,this.attr.Encoding="Base64",this.attr.Compress="true"},e.node.SCRIPTCODE=function(){this.name="SCRIPTCODE",this.attr={},this.children=[],this.attr.Type="JScript",this.attr.Version=null},e.node.SCRIPTHEADER=function(){this.name="SCRIPTHEADER",this.attr={},this.children=[]},e.node.SCRIPTSOURCE=function(){this.name="SCRIPTSOURCE",this.attr={},this.children=[]},e.node.PRESCRIPT=function(){this.name="PRESCRIPT",this.attr={},this.children=[],this.attr.Count=null},e.node.POSTSCRIPT=function(){this.name="POSTSCRIPT",this.attr={},this.children=[],this.attr.Count=null},e.node.SCRIPTFUNCTION=function(){this.name="SCRIPTFUNCTION",this.attr={},this.children=[]},e.node.XMLTEMPLATE=function(){this.name="XMLTEMPLATE",this.attr={},this.children=[]},e.node.SCHEMA=function(){this.name="SCHEMA",this.attr={},this.children=[]},e.node.INSTANCE=function(){this.name="INSTANCE",this.attr={},this.children=[]},e.node.COMPATIBLEDOCUMENT=function(){this.name="COMPATIBLEDOCUMENT",this.attr={},this.children=[],this.attr.TargetProgram="None"},e.node.LAYOUTCOMPATIBILITY=function(){this.name="LAYOUTCOMPATIBILITY",this.attr={},this.children=[],this.attr.ApplyFontWeightToBold="false",this.attr.UseInnerUnderline="false",this.attr.FixedUnderlineWidth="false",this.attr.DoNotApplyStrikeout="false",this.attr.UseLowercaseStrikeout="false",this.attr.ExtendLineheightToOffset="false",this.attr.TreatQuotationAsLatin="false",this.attr.DoNotAlignWhitespaceOnRight="false",this.attr.DoNotAdjustWordInJustify="false",this.attr.BaseCharUnitOnEAsian="false",this.attr.BaseCharUnitOfIndentOnFirstChar="false",this.attr.AdjustLineheightToFont="false",this.attr.AdjustBaselineInFixedLinespacing="false",this.attr.ExcludeOverlappingParaSpacing="false",this.attr.ApplyNextspacingOfLastPara="false",this.attr.ApplyAtLeastToPercent100Pct="false",this.attr.DoNotApplyAutoSpaceEAsianEng="false",this.attr.DoNotApplyAutoSpaceEAsianNum="false",this.attr.AdjustParaBorderfillToSpacing="false",this.attr.ConnectParaBorderfillOfEqualBorder="false",this.attr.AdjustParaBorderOffsetWithBorder="false",this.attr.ExtendLineheightToParaBorderOffset="false",this.attr.ApplyParaBorderToOutside="false",this.attr.BaseLinespacingOnLinegrid="false",this.attr.ApplyCharSpacingToCharGrid="false",this.attr.DoNotApplyGridInHeaderfooter="false",this.attr.ExtendHeaderfooterToBody="false",this.attr.AdjustEndnotePositionToFootnote="false",this.attr.DoNotApplyImageEffect="false",this.attr.DoNotApplyShapeComment="false",this.attr.DoNotAdjustEmptyAnchorLine="false",this.attr.OverlapBothAllowOverlap="false",this.attr.DoNotApplyVertOffsetOfForward="false",this.attr.ExtendVertLimitToPageMargins="false",this.attr.DoNotHoldAnchorOfTable="false",this.attr.DoNotFormattingAtBeneathAnchor="false",this.attr.DoNotApplyExtensionCharCompose="false"},e.tag.table=[],void 0===e&&(e={record:{},node:{},tag:{},enum:{}}),e.tag.BEGIN=16,e.tag.DOCUMENT_PROPERTIES=16,e.tag.ID_MAPPINGS=17,e.tag.BIN_DATA=18,e.tag.FACE_NAME=19,e.tag.BORDER_FILL=20,e.tag.CHAR_SHAPE=21,e.tag.TAB_DEF=22,e.tag.NUMBERING=23,e.tag.BULLET=24,e.tag.PARA_SHAPE=25,e.tag.STYLE=26,e.tag.DOC_DATA=27,e.tag.DISTRIBUTE_DOC_DATA=28,e.tag.COMPATIBLE_DOCUMENT=30,e.tag.LAYOUT_COMPATIBILITY=31,e.tag.FORBIDDEN_CHAR=94,e.tag.PARA_HEADER=66,e.tag.PARA_TEXT=67,e.tag.PARA_CHAR_SHAPE=68,e.tag.PARA_LINE_SEG=69,e.tag.PARA_RANGE_TAG=70,e.tag.CTRL_HEADER=71,e.tag.LIST_HEADER=72,e.tag.PAGE_DEF=73,e.tag.FOOTNOTE_SHAPE=74,e.tag.PAGE_BORDER_FILL=75,e.tag.SHAPE_COMPONENT=76,e.tag.TABLE=77,e.tag.SHAPE_COMPONENT_LINE=78,e.tag.SHAPE_COMPONENT_RECTANGLE=79,e.tag.SHAPE_COMPONENT_ELLIPSE=80,e.tag.SHAPE_COMPONENT_ARC=81,e.tag.SHAPE_COMPONENT_POLYGON=82,e.tag.SHAPE_COMPONENT_CURVE=83,e.tag.SHAPE_COMPONENT_OLE=84,e.tag.SHAPE_COMPONENT_PICTURE=85,e.tag.SHAPE_COMPONENT_CONTAINER=86,e.tag.CTRL_DATA=87,e.tag.EQEDIT=88,e.tag.SHAPE_COMPONENT_TEXTART=90,e.tag.FORM_OBJECT=91,e.tag.MEMO_SHAPE=92,e.tag.MEMO_LIST=93,e.tag.CHART_DATA=95,e.tag.SHAPE_COMPONENT_UNKNOWN=115,e.record.DOCUMENT_PROPERTIES=function(t){var e=this.attr={};this.data=t,this.name="DOCUMENT_PROPERTIES",e.SecCnt=this.data.readUInt16LE(0),e.BeginNumber={},e.BeginNumber.Page=this.data.readUInt16LE(2),e.BeginNumber.Footnote=this.data.readUInt16LE(4),e.BeginNumber.Endnote=this.data.readUInt16LE(6),e.BeginNumber.Picture=this.data.readUInt16LE(8),e.BeginNumber.Table=this.data.readUInt16LE(10),e.BeginNumber.Equation=this.data.readUInt16LE(12),e.CaretPos={},e.CaretPos.List=this.data.readUInt32LE(14),e.CaretPos.Para=this.data.readUInt32LE(18),e.CaretPos.Pos=this.data.readUInt32LE(22)},e.record.ID_MAPPINGS=function(t){var e=this.attr={};this.data=t,this.name="ID_MAPPINGS",e.BinDataCount=this.data.readInt32LE(0),e.FontCount=[];for(var a={value:4},n=0;n<7;n++)e.FontCount[n]={},e.FontCount[n].value=this.data.readInt32LE(a.value),a.value+=4;e.BorderFillCount=this.data.readInt32LE(a.value),a.value+=4,e.CharShapeCount=this.data.readInt32LE(a.value),a.value+=4,e.TabDefCount=this.data.readInt32LE(a.value),a.value+=4,e.NumberingCount=this.data.readInt32LE(a.value),a.value+=4,e.BulletCount=this.data.readInt32LE(a.value),a.value+=4,e.ParaShapeCount=this.data.readInt32LE(a.value),a.value+=4,e.StyleCount=this.data.readInt32LE(a.value),a.value+=4,a.value>=this.data.length||(e.MemoCount=this.data.readInt32LE(a.value),a.value+=4)},e.record.BIN_DATA=function(t){var a,n=this.attr={};this.data=t,this.name="BIN_DATA",a=this.data.slice(0,2),n.Type=15&a[0],void 0!==e.enum.BinItemType[n.Type]&&(n.Type=e.enum.BinItemType[n.Type]),n._Compress=(48&a[0])>>4,n._AccessStatus=(192&a[0])>>6;var i={value:2};switch(""+n.Type){case"Embedding":case"Storage":for(n.BinData=this.data.readUInt16LE(i.value),i.value+=2,a=this.data.readUInt16LE(i.value),i.value+=2,n.Format="";a-- >0;)n.Format+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;break;default:console.warn("Warning [BIN_DATA]: not processing BinItem type '%s'",n.Type)}},e.record.FACE_NAME=function(t){var a,n=this.attr={};this.data=t,this.name="FACE_NAME",a=this.data.slice(0,1),n.Type=3&a[0],void 0!==e.enum.FontType[n.Type]&&(n.Type=e.enum.FontType[n.Type]),n.HasDefault=!!((32&a[0])>>5),n.HasShape=!!((64&a[0])>>6),n.HasSubst=!!((128&a[0])>>7),a=this.data.readUInt16LE(1);var i={value:3};for(n.Name="";a-- >0;)n.Name+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;if(n.HasSubst)for(n.SubstFont={},a=this.data.slice(i.value,i.value+1),i.value+=1,n.SubstFont.Type=3&a[0],void 0!==e.enum.FontType[n.SubstFont.Type]&&(n.SubstFont.Type=e.enum.FontType[n.SubstFont.Type]),a=this.data.readUInt16LE(i.value),i.value+=2,n.SubstFont.Name="";a-- >0;)n.SubstFont.Name+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;n.HasShape&&(n.TypeInfo={},n.TypeInfo.FamilyType=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.SerifStyle=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.Weight=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.Proportion=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.Contrast=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.StrokeVariation=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.ArmStyle=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.Letterform=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.Midline=this.data.readUInt8(i.value),i.value+=1,n.TypeInfo.XHeight=this.data.readUInt8(i.value),i.value+=1),n.HasDefault},e.record.BORDER_FILL=function(t){var a,n=this.attr={};this.data=t,this.name="BORDER_FILL",a=this.data.slice(0,2),n.ThreeD=!!(1&a[0]),n.Shadow=!!((2&a[0])>>1),n.Slash=(28&a[0])>>2,n.BackSlash=(224&a[0])>>5,n.LeftBorder={},n.LeftBorder.Type=this.data.readUInt8(2),void 0!==e.enum.LineType1[n.LeftBorder.Type]&&(n.LeftBorder.Type=e.enum.LineType1[n.LeftBorder.Type]),n.LeftBorder.Width=this.data.readUInt8(3),void 0!==e.enum.LineWidth[n.LeftBorder.Width]&&(n.LeftBorder.Width=e.enum.LineWidth[n.LeftBorder.Width]),n.LeftBorder.Color=this.data.readUInt32LE(4),n.RightBorder={},n.RightBorder.Type=this.data.readUInt8(8),void 0!==e.enum.LineType1[n.RightBorder.Type]&&(n.RightBorder.Type=e.enum.LineType1[n.RightBorder.Type]),n.RightBorder.Width=this.data.readUInt8(9),void 0!==e.enum.LineWidth[n.RightBorder.Width]&&(n.RightBorder.Width=e.enum.LineWidth[n.RightBorder.Width]),n.RightBorder.Color=this.data.readUInt32LE(10),n.TopBorder={},n.TopBorder.Type=this.data.readUInt8(14),void 0!==e.enum.LineType1[n.TopBorder.Type]&&(n.TopBorder.Type=e.enum.LineType1[n.TopBorder.Type]),n.TopBorder.Width=this.data.readUInt8(15),void 0!==e.enum.LineWidth[n.TopBorder.Width]&&(n.TopBorder.Width=e.enum.LineWidth[n.TopBorder.Width]),n.TopBorder.Color=this.data.readUInt32LE(16),n.BottomBorder={},n.BottomBorder.Type=this.data.readUInt8(20),void 0!==e.enum.LineType1[n.BottomBorder.Type]&&(n.BottomBorder.Type=e.enum.LineType1[n.BottomBorder.Type]),n.BottomBorder.Width=this.data.readUInt8(21),void 0!==e.enum.LineWidth[n.BottomBorder.Width]&&(n.BottomBorder.Width=e.enum.LineWidth[n.BottomBorder.Width]),n.BottomBorder.Color=this.data.readUInt32LE(22),n.Diagonal={},n.Diagonal.Type=this.data.readUInt8(26),void 0!==e.enum.LineType1[n.Diagonal.Type]&&(n.Diagonal.Type=e.enum.LineType1[n.Diagonal.Type]),n.Diagonal.Width=this.data.readUInt8(27),void 0!==e.enum.LineWidth[n.Diagonal.Width]&&(n.Diagonal.Width=e.enum.LineWidth[n.Diagonal.Width]),n.Diagonal.Color=this.data.readUInt32LE(28),n.FillBrush={},n.FillBrush._BrushType=this.data.readUInt32LE(32);var i={value:36};switch(""+n.FillBrush._BrushType){case"0":n.FillBrush._Unknown=this.data.readInt32LE(i.value),i.value+=4;break;case"1":n.FillBrush.WindowBrush={},n.FillBrush.WindowBrush.FaceColor=this.data.readUInt32LE(i.value),i.value+=4,n.FillBrush.WindowBrush.HatchColor=this.data.readUInt32LE(i.value),i.value+=4,n.FillBrush.WindowBrush.HatchStyle=this.data.readInt32LE(i.value),void 0!==e.enum.HatchStyle[n.FillBrush.WindowBrush.HatchStyle]&&(n.FillBrush.WindowBrush.HatchStyle=e.enum.HatchStyle[n.FillBrush.WindowBrush.HatchStyle]),i.value+=4,n.FillBrush.WindowBrush._Unknown=this.data.readInt32LE(i.value),i.value+=4,n.FillBrush.WindowBrush.Alpha=this.data.readUInt8(i.value),i.value+=1;break;case"4":n.FillBrush.Gradation={},n.FillBrush.Gradation.Type=this.data.readUInt8(i.value),void 0!==e.enum.GradationType[n.FillBrush.Gradation.Type]&&(n.FillBrush.Gradation.Type=e.enum.GradationType[n.FillBrush.Gradation.Type]),i.value+=1,n.FillBrush.Gradation.Angle=this.data.readInt32LE(i.value),i.value+=4,n.FillBrush.Gradation.CenterX=this.data.readInt32LE(i.value),i.value+=4,n.FillBrush.Gradation.CenterY=this.data.readInt32LE(i.value),i.value+=4,n.FillBrush.Gradation.Step=this.data.readUInt32LE(i.value),i.value+=4,n.FillBrush.Gradation.ColorNum=this.data.readUInt32LE(i.value),i.value+=4,n.FillBrush.Gradation._Colors=[];for(var r=0;r<n.FillBrush.Gradation.ColorNum;r++)n.FillBrush.Gradation._Colors[r]={},n.FillBrush.Gradation._Colors[r].value=this.data.readUInt32LE(i.value),i.value+=4;n.FillBrush.Gradation._Unknown=this.data.readInt32LE(i.value),i.value+=4,n.FillBrush.Gradation.StepCenter=this.data.readUInt8(i.value),i.value+=1,n.FillBrush.Gradation.Alpha=this.data.readUInt8(i.value),i.value+=1;break;default:console.warn("Warning [?>FillBrush]: not processing FillBrush Type '%s'",n._BrushType)}},e.record.CHAR_SHAPE=function(t){var a,n=this.attr={};this.data=t,this.name="CHAR_SHAPE",n._FontIDs=[];for(var i={value:0},r=0;r<7;r++)n._FontIDs[r]={},n._FontIDs[r].value=this.data.readUInt16LE(i.value),i.value+=2;n._FontRatios=[];for(var s=0;s<7;s++)n._FontRatios[s]={},n._FontRatios[s].value=this.data.readUInt8(i.value),i.value+=1;n._FontCharSpacings=[];for(var l=0;l<7;l++)n._FontCharSpacings[l]={},n._FontCharSpacings[l].value=this.data.readInt8(i.value),i.value+=1;n._FontRelSizes=[];for(var h=0;h<7;h++)n._FontRelSizes[h]={},n._FontRelSizes[h].value=this.data.readUInt8(i.value),i.value+=1;n._FontCharOffsets=[];for(var o=0;o<7;o++)n._FontCharOffsets[o]={},n._FontCharOffsets[o].value=this.data.readInt8(i.value),i.value+=1;n.Height=this.data.readInt32LE(i.value),i.value+=4,n.Shadow={},n.Underline={},n.Strikeout={},a=this.data.slice(i.value,i.value+4),i.value+=4,n._Italic=!!(1&a[0]),n._Bold=!!((2&a[0])>>1),n.Underline.Type=(12&a[0])>>2,void 0!==e.enum.UnderlineType[n.Underline.Type]&&(n.Underline.Type=e.enum.UnderlineType[n.Underline.Type]),n.Underline.Shape=(240&a[0])>>4,void 0!==e.enum.LineType2[n.Underline.Shape]&&(n.Underline.Shape=e.enum.LineType2[n.Underline.Shape]),n.OutlineType=7&a[1],void 0!==e.enum.LineType3[n.OutlineType]&&(n.OutlineType=e.enum.LineType3[n.OutlineType]),n.Shadow.Type=(24&a[1])>>3,void 0!==e.enum.ShadowType[n.Shadow.Type]&&(n.Shadow.Type=e.enum.ShadowType[n.Shadow.Type]),n._Emboss=!!((32&a[1])>>5),n._Engrave=!!((64&a[1])>>6),n._SuperScript=!!((128&a[1])>>7),n._SubScript=!!(1&a[2]),n.Strikeout.Type=(28&a[2])>>2,void 0!==e.enum.StrikeoutType[n.Strikeout.Type]&&(n.Strikeout.Type=e.enum.StrikeoutType[n.Strikeout.Type]),n.SymMark=((224&a[2])>>5)+((1&a[3])<<3),n.UseFontSpace=!!((2&a[3])>>1),n.Strikeout.Shape=(60&a[3])>>2,void 0!==e.enum.LineType2[n.Strikeout.Shape]&&(n.Strikeout.Shape=e.enum.LineType2[n.Strikeout.Shape]),n.UseKerning=!!((64&a[3])>>6),n.Shadow.OffsetX=this.data.readInt8(i.value),i.value+=1,n.Shadow.OffsetY=this.data.readInt8(i.value),i.value+=1,n.TextColor=this.data.readUInt32LE(i.value),i.value+=4,n.Underline.Color=this.data.readUInt32LE(i.value),i.value+=4,n.ShadeColor=this.data.readUInt32LE(i.value),i.value+=4,n.Shadow.Color=this.data.readUInt32LE(i.value),i.value+=4,i.value>=this.data.length||(n.BorderFillId=this.data.readUInt16LE(i.value),i.value+=2,i.value>=this.data.length||(n.Strikeout.Color=this.data.readUInt32LE(i.value),i.value+=4))},e.record.TAB_DEF=function(t){var a,n=this.attr={};this.data=t,this.name="TAB_DEF",a=this.data.slice(0,4),n.AutoTabLeft=!!(1&a[0]),n.AutoTabRight=!!((2&a[0])>>1),n._count=this.data.readInt16LE(4);var i={value:6};n._count&&(n.TabItem={},n.TabItem.Pos=this.data.readUInt32LE(i.value),i.value+=4,n.TabItem.Type=this.data.readUInt8(i.value),void 0!==e.enum.TabItemType[n.TabItem.Type]&&(n.TabItem.Type=e.enum.TabItemType[n.TabItem.Type]),i.value+=1,n.TabItem.Leader=this.data.readUInt8(i.value),void 0!==e.enum.LineType2[n.TabItem.Leader]&&(n.TabItem.Leader=e.enum.LineType2[n.TabItem.Leader]),i.value+=1)},e.record.NUMBERING=function(t){var a,n=this.attr={};this.data=t,this.name="NUMBERING",n.ParaHeads=[];for(var i={value:0},r=0;r<7;r++)for(n.ParaHeads[r]={},a=this.data.slice(i.value,i.value+4),i.value+=4,n.ParaHeads[r].Alignment=3&a[0],void 0!==e.enum.AlignmentType2[n.ParaHeads[r].Alignment]&&(n.ParaHeads[r].Alignment=e.enum.AlignmentType2[n.ParaHeads[r].Alignment]),n.ParaHeads[r].UseInstWidth=!!((4&a[0])>>2),n.ParaHeads[r].AutoIndent=!!((8&a[0])>>3),n.ParaHeads[r].TextOffsetType=(16&a[0])>>4,void 0!==e.enum.TextOffsetType[n.ParaHeads[r].TextOffsetType]&&(n.ParaHeads[r].TextOffsetType=e.enum.TextOffsetType[n.ParaHeads[r].TextOffsetType]),n.ParaHeads[r].NumFormat=((224&a[0])>>5)+((1&a[1])<<3),void 0!==e.enum.NumberType1[n.ParaHeads[r].NumFormat]&&(n.ParaHeads[r].NumFormat=e.enum.NumberType1[n.ParaHeads[r].NumFormat]),n.ParaHeads[r].WidthAdjust=this.data.readUInt16LE(i.value),i.value+=2,n.ParaHeads[r].TextOffset=this.data.readUInt16LE(i.value),i.value+=2,n.ParaHeads[r].CharShape=this.data.readUInt32LE(i.value),i.value+=4,a=this.data.readUInt16LE(i.value),i.value+=2,n.ParaHeads[r].value="";a-- >0;)n.ParaHeads[r].value+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;n.Start=this.data.readUInt16LE(i.value),i.value+=2},e.record.BULLET=function(t){this.attr={},this.data=t,this.name="BULLET"},e.record.PARA_SHAPE=function(t){var a,n=this.attr={};this.data=t,this.name="PARA_SHAPE",n.ParaMargin={},n.ParaBorder={},a=this.data.slice(0,4),n.ParaMargin.LineSpacingType=3&a[0],void 0!==e.enum.LineSpacingType[n.ParaMargin.LineSpacingType]&&(n.ParaMargin.LineSpacingType=e.enum.LineSpacingType[n.ParaMargin.LineSpacingType]),n.Align=(28&a[0])>>2,void 0!==e.enum.AlignmentType1[n.Align]&&(n.Align=e.enum.AlignmentType1[n.Align]),n.BreakLatinWord=(96&a[0])>>5,void 0!==e.enum.BreakLatinWordType[n.BreakLatinWord]&&(n.BreakLatinWord=e.enum.BreakLatinWordType[n.BreakLatinWord]),n.BreakNonLatinWord=!!((128&a[0])>>7),n.SnapToGrid=!!(1&a[1]),n.Condense=(254&a[1])>>1,n.WidowOrphan=!!(1&a[2]),n.KeepWithNext=!!((2&a[2])>>1),n.KeepLines=!!((4&a[2])>>2),n.PageBreakBefore=!!((8&a[2])>>3),n.VerAlign=(48&a[2])>>4,void 0!==e.enum.VerAlignType[n.VerAlign]&&(n.VerAlign=e.enum.VerAlignType[n.VerAlign]),n.FontLineHeight=!!((64&a[2])>>6),n.HeadingType=((128&a[2])>>7)+((1&a[3])<<1),void 0!==e.enum.HeadingType[n.HeadingType]&&(n.HeadingType=e.enum.HeadingType[n.HeadingType]),n.Level=(14&a[3])>>1,n.ParaBorder.Connect=!!((16&a[3])>>4),n.ParaBorder.IgnoreMargin=!!((32&a[3])>>5),n.ParaMargin.Left=this.data.readInt32LE(4),n.ParaMargin.Right=this.data.readInt32LE(8),n.ParaMargin.Indent=this.data.readInt32LE(12),n.ParaMargin.Prev=this.data.readInt32LE(16),n.ParaMargin.Next=this.data.readInt32LE(20),n.ParaMargin.LineSpacing=this.data.readInt32LE(24),n.TabDef=this.data.readUInt16LE(28),n.Heading=this.data.readUInt16LE(30),n.ParaBorder.BorderFill=this.data.readUInt16LE(32),n.ParaBorder.OffsetLeft=this.data.readInt16LE(34),n.ParaBorder.OffsetRight=this.data.readInt16LE(36),n.ParaBorder.OffsetTop=this.data.readInt16LE(38),n.ParaBorder.OffsetBottom=this.data.readInt16LE(40),a=this.data.slice(42,46),n.LineWrap=3&a[0],void 0!==e.enum.LineWrapType[n.LineWrap]&&(n.LineWrap=e.enum.LineWrapType[n.LineWrap]),n.AutoSpaceEAsianEng=!!((16&a[0])>>4),n.AutoSpaceEAsianNum=!!((32&a[0])>>5),46>=this.data.length||(a=this.data.slice(46,50),n.ParaMargin.LineSpacingType=31&a[0],void 0!==e.enum.LineSpacingType[n.ParaMargin.LineSpacingType]&&(n.ParaMargin.LineSpacingType=e.enum.LineSpacingType[n.ParaMargin.LineSpacingType]),n.ParaMargin.LineSpacing=this.data.readUInt32LE(50))},e.record.STYLE=function(t){var a,n=this.attr={};this.data=t,this.name="STYLE",a=this.data.readUInt16LE(0);var i={value:2};for(n.Name="";a-- >0;)n.Name+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;for(a=this.data.readUInt16LE(i.value),i.value+=2,n.EngName="";a-- >0;)n.EngName+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2;a=this.data.slice(i.value,i.value+1),i.value+=1,n.Type=7&a[0],void 0!==e.enum.StyleType[n.Type]&&(n.Type=e.enum.StyleType[n.Type]),n.NextStyle=this.data.readUInt8(i.value),i.value+=1,n.LangId=this.data.readInt16LE(i.value),i.value+=2,n.ParaShape=this.data.readUInt16LE(i.value),i.value+=2,n.CharShape=this.data.readUInt16LE(i.value),i.value+=2},e.record.DOC_DATA=function(t){this.attr={},this.data=t,this.name="DOC_DATA"},e.record.DISTRIBUTE_DOC_DATA=function(t){var e=this.attr={};this.data=t,this.name="DISTRIBUTE_DOC_DATA",e.Data=this.data.slice(0,256)},e.record.COMPATIBLE_DOCUMENT=function(t){var e=this.attr={};this.data=t,this.name="COMPATIBLE_DOCUMENT",e.TargetProgram=this.data.readUInt32LE(0)},e.record.LAYOUT_COMPATIBILITY=function(t){var e=this.attr={};this.data=t,this.name="LAYOUT_COMPATIBILITY",e._Char=this.data.readUInt32LE(0),e._Para=this.data.readUInt32LE(4),e._Sec=this.data.readUInt32LE(8),e._Obj=this.data.readUInt32LE(12),e._Field=this.data.readUInt32LE(16)},e.record.FORBIDDEN_CHAR=function(t){var e=this.attr={};this.data=t,this.name="FORBIDDEN_CHAR",e._f0_len=this.data.readUInt32LE(0),e._f1_len=this.data.readUInt32LE(4),e._f2_len=this.data.readUInt32LE(8),e._f3_len=this.data.readUInt32LE(12);var a={value:16},n=function(n,i){if(0==n)e[i]=" ";else for(e[i]="";n-- >0;)e[i]+=String.fromCharCode(t.readUInt16LE(a.value)),a.value+=2};n(e._f0_len,"_f0"),n(e._f1_len,"_f1"),n(e._f2_len,"_f2"),n(e._f3_len,"_f3")},e.record.PARA_HEADER=function(t){var e,a=this.attr={};this.data=t,this.name="PARA_HEADER",a._text=this.data.readUInt32LE(0),a._control_mask=this.data.readUInt32LE(4),a.ParaShape=this.data.readUInt16LE(8),a.Style=this.data.readUInt8(10),e=this.data.slice(11,12),a.PageBreak=!!((4&e[0])>>2),a.ColumnBreak=!!((8&e[0])>>3),a.CharShapeCount=this.data.readUInt16LE(12),a.RangeTagCount=this.data.readUInt16LE(14),a.AlignInfoCount=this.data.readUInt16LE(16),a.InstId=this.data.readUInt32LE(18)},e.record.PARA_TEXT=function(t){var e;this.attr={},this.data=t,this.name="PARA_TEXT";var a,n,i=[],r=0;this.text=[],e=0;var s=function(t){var n=e;(0!=i.length||t)&&(e?(this.text.push({type:e,start:r/2,data:i}),e=0):this.text.push({type:"text",start:r/2,data:i}),t?(this.text.push({type:t,start:a/2}),r=a+2):r=n?a+2:a,i=[])}.bind(this);for(a=0;a<t.length;a+=2)if(n=t.readUInt16LE(a),e)n==e?s():i.push(n);else switch(n){case 0:case 25:case 26:case 27:case 28:case 29:case 13:break;case 10:case 24:case 30:case 31:s(n);break;default:n<32?(s(),e=n):i.push(n)}s()},e.record.PARA_CHAR_SHAPE=function(t){var e;for(this.attr={},this.data=t,this.name="PARA_CHAR_SHAPE",this.values=[],e=0;e<t.length;e+=8)this.values.push({start:t.readUInt32LE(e),charShape:t.readUInt32LE(e+4)})},e.record.PARA_LINE_SEG=function(t){this.attr={},this.data=t,this.name="PARA_LINE_SEG"},e.record.PARA_RANGE_TAG=function(t){var e=this.attr={};this.data=t,this.name="PARA_RANGE_TAG",e._Data=[];for(var a={value:0},n=0;a.value<this.data.length;n++)e._Data[n]={},e._Data[n].start=this.data.readUInt32LE(a.value),a.value+=4,e._Data[n].end=this.data.readUInt32LE(a.value),a.value+=4,e._Data[n].data=this.data.readUInt32LE(a.value),a.value+=4},e.record.CTRL_HEADER=function(t){var a,n=this.attr={};this.data=t,this.name="CTRL_HEADER",a=this.data.readUInt32LE(0),n._Type=String.fromCharCode(a>>24,a>>16&255,a>>8&255,255&a);var i={value:4};switch(""+n._Type){case"eqed":case"tbl ":case"gso ":if(n.ShapeObject={},n.ShapeObject.Size={},n.ShapeObject.Position={},n.ShapeObject.OutsideMargin={},n.ShapeObject.ShapeComment={},a=this.data.slice(i.value,i.value+4),i.value+=4,n.ShapeObject.Position.TreatAsChar=!!(1&a[0]),n.ShapeObject.Position.AffectLSpacing=!!((4&a[0])>>2),n.ShapeObject.Position.VertRelTo=(24&a[0])>>3,void 0!==e.enum.VertRelToType[n.ShapeObject.Position.VertRelTo]&&(n.ShapeObject.Position.VertRelTo=e.enum.VertRelToType[n.ShapeObject.Position.VertRelTo]),n.ShapeObject.Position.VertAlign=(224&a[0])>>5,void 0!==e.enum.VertAlignType[n.ShapeObject.Position.VertAlign]&&(n.ShapeObject.Position.VertAlign=e.enum.VertAlignType[n.ShapeObject.Position.VertAlign]),n.ShapeObject.Position.HorzRelTo=3&a[1],void 0!==e.enum.HorzRelToType[n.ShapeObject.Position.HorzRelTo]&&(n.ShapeObject.Position.HorzRelTo=e.enum.HorzRelToType[n.ShapeObject.Position.HorzRelTo]),n.ShapeObject.Position.HorzAlign=(28&a[1])>>2,void 0!==e.enum.HorzAlignType[n.ShapeObject.Position.HorzAlign]&&(n.ShapeObject.Position.HorzAlign=e.enum.HorzAlignType[n.ShapeObject.Position.HorzAlign]),n.ShapeObject.Position.FlowWithText=!!((32&a[1])>>5),n.ShapeObject.Position.AllowOverlap=!!((64&a[1])>>6),n.ShapeObject.Size.WidthRelTo=((128&a[1])>>7)+((3&a[2])<<1),void 0!==e.enum.WidthRelToType[n.ShapeObject.Size.WidthRelTo]&&(n.ShapeObject.Size.WidthRelTo=e.enum.WidthRelToType[n.ShapeObject.Size.WidthRelTo]),n.ShapeObject.Size.HeightRelTo=(12&a[2])>>2,void 0!==e.enum.HeightRelToType[n.ShapeObject.Size.HeightRelTo]&&(n.ShapeObject.Size.HeightRelTo=e.enum.HeightRelToType[n.ShapeObject.Size.HeightRelTo]),n.ShapeObject.Size.Protect=!!((16&a[2])>>4),n.ShapeObject.TextWrap=(224&a[2])>>5,void 0!==e.enum.TextWrapType[n.ShapeObject.TextWrap]&&(n.ShapeObject.TextWrap=e.enum.TextWrapType[n.ShapeObject.TextWrap]),n.ShapeObject.TextFlow=3&a[3],void 0!==e.enum.TextFlowType[n.ShapeObject.TextFlow]&&(n.ShapeObject.TextFlow=e.enum.TextFlowType[n.ShapeObject.TextFlow]),n.ShapeObject.NumberingType=(28&a[3])>>2,void 0!==e.enum.NumberingType[n.ShapeObject.NumberingType]&&(n.ShapeObject.NumberingType=e.enum.NumberingType[n.ShapeObject.NumberingType]),n.ShapeObject.Position.VertOffset=this.data.readInt32LE(i.value),i.value+=4,n.ShapeObject.Position.HorzOffset=this.data.readInt32LE(i.value),i.value+=4,n.ShapeObject.Size.Width=this.data.readUInt32LE(i.value),i.value+=4,n.ShapeObject.Size.Height=this.data.readUInt32LE(i.value),i.value+=4,n.ShapeObject.ZOrder=this.data.readInt32LE(i.value),i.value+=4,n.ShapeObject.OutsideMargin.Left=this.data.readUInt16LE(i.value),i.value+=2,n.ShapeObject.OutsideMargin.Right=this.data.readUInt16LE(i.value),i.value+=2,n.ShapeObject.OutsideMargin.Top=this.data.readUInt16LE(i.value),i.value+=2,n.ShapeObject.OutsideMargin.Bottom=this.data.readUInt16LE(i.value),i.value+=2,n.ShapeObject.InstId=this.data.readUInt32LE(i.value),i.value+=4,i.value>=this.data.length)return;if(n.ShapeObject._unknown=this.data.readUInt32LE(i.value),i.value+=4,i.value>=this.data.length)return;for(a=this.data.readUInt16LE(i.value),i.value+=2,n.ShapeObject.ShapeComment.value="";a-- >0;)n.ShapeObject.ShapeComment.value+=String.fromCharCode(this.data.readUInt16LE(i.value)),i.value+=2}switch(""+n._Type){case"eqed":case"tbl ":case"gso ":break;case"secd":n.Hide={},n.StartNumber={},a=this.data.slice(i.value,i.value+4),i.value+=4,n.Hide.Header=!!(1&a[0]),n.Hide.Footer=!!((2&a[0])>>1),n.Hide.MasterPage=!!((4&a[0])>>2),n.Hide.Border=!!((8&a[0])>>3),n.Hide.Fill=!!((16&a[0])>>4),n.Hide.PageNumPos=!!((32&a[0])>>5),n.FirstBorder=!!(1&a[1]),n.FirstFill=!!((2&a[1])>>1),n.TextDirection=7&a[2],n.Hide.EmptyLine=!!((8&a[2])>>3),n.StartNumber.PageStartsOn=(48&a[2])>>4,void 0!==e.enum.PageStartsOnType[n.StartNumber.PageStartsOn]&&(n.StartNumber.PageStartsOn=e.enum.PageStartsOnType[n.StartNumber.PageStartsOn]),n.SpaceColumns=this.data.readUInt16LE(i.value),i.value+=2,n.LineGrid=this.data.readUInt16LE(i.value),i.value+=2,n.CharGrid=this.data.readUInt16LE(i.value),i.value+=2,n.TabStop=this.data.readUInt32LE(i.value),i.value+=4,n.StartNumber.Page=this.data.readUInt16LE(i.value),i.value+=2,n.StartNumber.Figure=this.data.readUInt16LE(i.value),i.value+=2,n.StartNumber.Table=this.data.readUInt16LE(i.value),i.value+=2,n.StartNumber.Equation=this.data.readUInt16LE(i.value),i.value+=2;break;case"cold":a=this.data.slice(i.value,i.value+2),i.value+=2,n.Type=3&a[0],void 0!==e.enum.ColDefType[n.Type]&&(n.Type=e.enum.ColDefType[n.Type]),n.Count=((252&a[0])>>2)+((3&a[1])<<6),n.Layout=(12&a[1])>>2,void 0!==e.enum.LayoutType[n.Layout]&&(n.Layout=e.enum.LayoutType[n.Layout]),n.SameSize=!!((16&a[1])>>4);break;case"pgnp":a=this.data.slice(i.value,i.value+4),i.value+=4,n.FormatType=a[0],void 0!==e.enum.NumberType1[n.FormatType]&&(n.FormatType=e.enum.NumberType1[n.FormatType]),n.Pos=15&a[1],void 0!==e.enum.PosType[n.Pos]&&(n.Pos=e.enum.PosType[n.Pos]);break;default:console.warn("Warning [CTRL_HEADER]: not processing Control Type '%s'",n._Type)}},e.record.LIST_HEADER=function(t){var a,n=this.attr={};this.data=t,this.name="LIST_HEADER",n._ParaCount=this.data.readInt32LE(0),a=this.data.slice(4,6),n.TextDirection=7&a[0],n.LineWrap=(24&a[0])>>3,void 0!==e.enum.LineWrapType[n.LineWrap]&&(n.LineWrap=e.enum.LineWrapType[n.LineWrap]),n.VertAlign=(96&a[0])>>5,void 0!==e.enum.VertAlignType[n.VertAlign]&&(n.VertAlign=e.enum.VertAlignType[n.VertAlign]),this.offset=6},e.record.CTRL_DATA=function(t){this.attr={},this.data=t,this.name="CTRL_DATA"},e.record.TABLE=function(t){var a,n=this.attr={};this.data=t,this.name="TABLE",a=this.data.slice(0,4),n.PageBreak=3&a[0],void 0!==e.enum.PageBreakType[n.PageBreak]&&(n.PageBreak=e.enum.PageBreakType[n.PageBreak]),n.RepeatHeader=!!((4&a[0])>>2),n.RowCount=this.data.readUInt16LE(4),n.ColCount=this.data.readUInt16LE(6),n.CellSpacing=this.data.readUInt16LE(8),n.InsideMargin={},n.InsideMargin.Left=this.data.readUInt16LE(10),n.InsideMargin.Right=this.data.readUInt16LE(12),n.InsideMargin.Top=this.data.readUInt16LE(14),n.InsideMargin.Bottom=this.data.readUInt16LE(16),n._RowSizes=[];for(var i={value:18},r=0;r<n.RowCount;r++)n._RowSizes[r]={},n._RowSizes[r].value=this.data.readUInt16LE(i.value),i.value+=2;n.BorderFill=this.data.readUInt16LE(i.value),i.value+=2},e.record.LIST_CELL=function(t){var e,a=this.attr={};this.data=t,this.name="LIST_CELL",e=this.data.slice(0,2),a.HasMargin=!!(1&e[0]),a.Protect=!!((2&e[0])>>1),a.Header=!!((4&e[0])>>2),a.Editable=!!((8&e[0])>>3),a.ColAddr=this.data.readUInt16LE(2),a.RowAddr=this.data.readUInt16LE(4),a.ColSpan=this.data.readUInt16LE(6),a.RowSpan=this.data.readUInt16LE(8),a.Width=this.data.readUInt32LE(10),a.Height=this.data.readUInt32LE(14),a.CellMargin={},a.CellMargin.Left=this.data.readUInt16LE(18),a.CellMargin.Right=this.data.readUInt16LE(20),a.CellMargin.Top=this.data.readUInt16LE(22),a.CellMargin.Bottom=this.data.readUInt16LE(24),a.BorderFill=this.data.readUInt16LE(26)},e.record.SHAPE_COMPONENT=function(t){var n,i=this.attr={};this.data=t,this.name="SHAPE_COMPONENT",n=this.data.readUInt32LE(0),i._Type=String.fromCharCode(n>>24,n>>16&255,n>>8&255,255&n),n=this.data.readUInt32LE(4),i._Type2=String.fromCharCode(n>>24,n>>16&255,n>>8&255,255&n);var r={value:8};i._IsDup=i._Type==i._Type2,i._IsDup||(r.value-=4),i.XPos=this.data.readInt32LE(r.value),r.value+=4,i.YPos=this.data.readInt32LE(r.value),r.value+=4,i.GroupLevel=this.data.readUInt16LE(r.value),r.value+=2,i._LocalFileVersion=this.data.readUInt16LE(r.value),r.value+=2,i.OriWidth=this.data.readInt32LE(r.value),r.value+=4,i.OriHeight=this.data.readInt32LE(r.value),r.value+=4,i.CurWidth=this.data.readInt32LE(r.value),r.value+=4,i.CurHeight=this.data.readInt32LE(r.value),r.value+=4,n=this.data.slice(r.value,r.value+4),r.value+=4,i.HorzFlip=!!(1&n[0]),i.VertFlip=!!((2&n[0])>>1),i.RotationInfo={},i.RotationInfo.Angle=this.data.readUInt16LE(r.value),r.value+=2,i.RotationInfo.CenterX=this.data.readInt32LE(r.value),r.value+=4,i.RotationInfo.CenterY=this.data.readInt32LE(r.value),r.value+=4,i.RenderingInfo={},i.RenderingInfo._Count=this.data.readUInt16LE(r.value),r.value+=2,i.RenderingInfo.TransMatrix={},i.RenderingInfo.TransMatrix.E1=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo.TransMatrix.E2=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo.TransMatrix.E3=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo.TransMatrix.E4=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo.TransMatrix.E5=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo.TransMatrix.E6=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices=[];for(var s=0;s<i.RenderingInfo._Count;s++)i.RenderingInfo._ScaRotMatrices[s]={},i.RenderingInfo._ScaRotMatrices[s].ScaMatrix={},i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E1=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E2=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E3=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E4=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E5=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].ScaMatrix.E6=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix={},i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E1=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E2=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E3=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E4=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E5=this.data.readDoubleLE(r.value),r.value+=8,i.RenderingInfo._ScaRotMatrices[s].RotMatrix.E6=this.data.readDoubleLE(r.value),r.value+=8;switch(""+i._Type){case"$ole":break;case"$con":i._Count=this.data.readUInt16LE(r.value),r.value+=2,i._CTypes=[];for(var l=0;l<i._Count;l++)i._CTypes[l]={},n=this.data.readUInt32LE(r.value),i._CTypes[l].value=String.fromCharCode(n>>24,n>>16&255,n>>8&255,255&n),r.value+=4;i.InstID=this.data.readUInt32LE(r.value),r.value+=4;break;case"$rec":case"$lin":case"$ell":case"$col":case"$pol":case"$arc":case"$cur":i.LineShape={},i.LineShape.Color=this.data.readUInt32LE(r.value),r.value+=4,i.LineShape.Width=this.data.readInt32LE(r.value),r.value+=4,n=this.data.slice(r.value,r.value+4),r.value+=4,i.LineShape.Style=63&n[0],void 0!==e.enum.LineType1[i.LineShape.Style]&&(i.LineShape.Style=e.enum.LineType1[i.LineShape.Style]),i.LineShape.EndCap=((192&n[0])>>6)+((3&n[1])<<2),void 0!==e.enum.EndCapType[i.LineShape.EndCap]&&(i.LineShape.EndCap=e.enum.EndCapType[i.LineShape.EndCap]),i.LineShape.HeadStyle=(252&n[1])>>2,void 0!==e.enum.ArrowType[i.LineShape.HeadStyle]&&(i.LineShape.HeadStyle=e.enum.ArrowType[i.LineShape.HeadStyle]),i.LineShape.TailStyle=63&n[2],void 0!==e.enum.ArrowType[i.LineShape.TailStyle]&&(i.LineShape.TailStyle=e.enum.ArrowType[i.LineShape.TailStyle]),i.LineShape.HeadSize=((192&n[2])>>6)+((3&n[3])<<2),void 0!==e.enum.ArrowSize[i.LineShape.HeadSize]&&(i.LineShape.HeadSize=e.enum.ArrowSize[i.LineShape.HeadSize]),i.LineShape.TailSize=(60&n[3])>>2,void 0!==e.enum.ArrowSize[i.LineShape.TailSize]&&(i.LineShape.TailSize=e.enum.ArrowSize[i.LineShape.TailSize]),i.LineShape._HeadFilled=!!((64&n[3])>>6),i.LineShape._TailFilled=!!((128&n[3])>>7);var h=function(t){if(i.LineShape["_"+t+"Filled"]){var e=i.LineShape[t+"Style"];"Empty"==e.slice(0,5)&&(i.LineShape[t+"Style"]="Filled"+e.slice(5))}};switch(h.call(this,"Head"),h.call(this,"Tail"),i.LineShape.OutlineStyle=this.data.readUInt8(r.value),void 0!==e.enum.OutlineStyleType[i.LineShape.OutlineStyle]&&(i.LineShape.OutlineStyle=e.enum.OutlineStyleType[i.LineShape.OutlineStyle]),r.value+=1,i.FillBrush={},i.FillBrush._BrushType=this.data.readUInt32LE(r.value),r.value+=4,""+i.FillBrush._BrushType){case"0":i.FillBrush._Unknown=this.data.readInt32LE(r.value),r.value+=4;break;case"1":i.FillBrush.WindowBrush={},i.FillBrush.WindowBrush.FaceColor=this.data.readUInt32LE(r.value),r.value+=4,i.FillBrush.WindowBrush.HatchColor=this.data.readUInt32LE(r.value),r.value+=4,i.FillBrush.WindowBrush.HatchStyle=this.data.readInt32LE(r.value),void 0!==e.enum.HatchStyle[i.FillBrush.WindowBrush.HatchStyle]&&(i.FillBrush.WindowBrush.HatchStyle=e.enum.HatchStyle[i.FillBrush.WindowBrush.HatchStyle]),r.value+=4,i.FillBrush.WindowBrush._Unknown=this.data.readInt32LE(r.value),r.value+=4,i.FillBrush.WindowBrush.Alpha=this.data.readUInt8(r.value),r.value+=1;break;case"4":i.FillBrush.Gradation={},i.FillBrush.Gradation.Type=this.data.readUInt8(r.value),void 0!==e.enum.GradationType[i.FillBrush.Gradation.Type]&&(i.FillBrush.Gradation.Type=e.enum.GradationType[i.FillBrush.Gradation.Type]),r.value+=1,i.FillBrush.Gradation.Angle=this.data.readInt32LE(r.value),r.value+=4,i.FillBrush.Gradation.CenterX=this.data.readInt32LE(r.value),r.value+=4,i.FillBrush.Gradation.CenterY=this.data.readInt32LE(r.value),r.value+=4,i.FillBrush.Gradation.Step=this.data.readUInt32LE(r.value),r.value+=4,i.FillBrush.Gradation.ColorNum=this.data.readUInt32LE(r.value),r.value+=4,i.FillBrush.Gradation._Colors=[];for(var o=0;o<i.FillBrush.Gradation.ColorNum;o++)i.FillBrush.Gradation._Colors[o]={},i.FillBrush.Gradation._Colors[o].value=this.data.readUInt32LE(r.value),r.value+=4;i.FillBrush.Gradation._Unknown=this.data.readInt32LE(r.value),r.value+=4,i.FillBrush.Gradation.StepCenter=this.data.readUInt8(r.value),r.value+=1,i.FillBrush.Gradation.Alpha=this.data.readUInt8(r.value),r.value+=1;break;default:console.warn("Warning [?>FillBrush]: not processing FillBrush Type '%s'",i._BrushType)}i.Shadow={},i.Shadow.Type=this.data.readUInt32LE(r.value),r.value+=4,i.Shadow.Color=this.data.readUInt32LE(r.value),r.value+=4,i.Shadow.OffsetX=this.data.readInt32LE(r.value),r.value+=4,i.Shadow.OffsetY=this.data.readInt32LE(r.value),r.value+=4,i.InstID=this.data.readUInt32LE(r.value),r.value+=4,i.LineShape.Alpha=this.data.readUInt8(r.value),r.value+=1,i.Shadow.Alpha=this.data.readUInt8(r.value),r.value+=1;break;default:console.warn("Warning [SHAPE_COMPONENT]: not processing ShapeComponent Type '%s'",i._Type),console.warn("%s | %s",i._Type,a(t.slice(r.value)))}},e.record.SHAPE_COMPONENT_LINE=function(t){var e,a=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_LINE",a.StartX=this.data.readInt32LE(0),a.StartY=this.data.readInt32LE(4),a.EndX=this.data.readInt32LE(8),a.EndY=this.data.readInt32LE(12),e=this.data.slice(16,18),a.IsReverseHV=!!(1&e[0])},e.record.SHAPE_COMPONENT_CONNECTLINE=function(t){var e=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_CONNECTLINE",e.StartX=this.data.readInt32LE(0),e.StartY=this.data.readInt32LE(4),e.EndX=this.data.readInt32LE(8),e.EndY=this.data.readInt32LE(12),e.Type=this.data.readInt32LE(16),e.StartSubjectID=this.data.readUInt32LE(20),e.StartSubjectIndex=this.data.readUInt32LE(24),e.EndSubjectID=this.data.readUInt32LE(28),e.EndSubjectIndex=this.data.readUInt32LE(32),e._Count=this.data.readUInt32LE(36),e._ControlPoints=[];for(var a={value:40},n=0;n<e._Count;n++)e._ControlPoints[n]={},e._ControlPoints[n].X=this.data.readInt32LE(a.value),a.value+=4,e._ControlPoints[n].Y=this.data.readInt32LE(a.value),a.value+=4,e._ControlPoints[n].Type=this.data.readUInt16LE(a.value),a.value+=2},e.record.SHAPE_COMPONENT_RECTANGLE=function(t){var e=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_RECTANGLE",e.Ratio=this.data.readUInt8(0),e.X0=this.data.readInt32LE(1),e.Y0=this.data.readInt32LE(5),e.X1=this.data.readInt32LE(9),e.Y1=this.data.readInt32LE(13),e.X2=this.data.readInt32LE(17),e.Y2=this.data.readInt32LE(21),e.X3=this.data.readInt32LE(25),e.Y3=this.data.readInt32LE(29)},e.record.SHAPE_COMPONENT_ELLIPSE=function(t){var a,n=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_ELLIPSE",a=this.data.slice(0,4),n.IntervalDirty=!!(1&a[0]),n.HasArcProperty=!!((2&a[0])>>1),n.ArcType=3&a[1],void 0!==e.enum.ArcType[n.ArcType]&&(n.ArcType=e.enum.ArcType[n.ArcType]),n.CenterX=this.data.readInt32LE(4),n.CenterY=this.data.readInt32LE(8),n.Axis1X=this.data.readInt32LE(12),n.Axis1Y=this.data.readInt32LE(16),n.Axis2X=this.data.readInt32LE(20),n.Axis2Y=this.data.readInt32LE(24),n.Start1X=this.data.readInt32LE(28),n.Start1Y=this.data.readInt32LE(32),n.End1X=this.data.readInt32LE(36),n.End1Y=this.data.readInt32LE(40),n.Start2X=this.data.readInt32LE(44),n.Start2Y=this.data.readInt32LE(48),n.End2X=this.data.readInt32LE(52),n.End2Y=this.data.readInt32LE(56)},e.record.SHAPE_COMPONENT_POLYGON=function(t){var e=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_POLYGON",e._Count=this.data.readUInt32LE(0),e._Points=[];for(var a={value:4},n=0;n<e._Count;n++)e._Points[n]={},e._Points[n].X=this.data.readInt32LE(a.value),a.value+=4,e._Points[n].Y=this.data.readInt32LE(a.value),a.value+=4},e.record.SHAPE_COMPONENT_ARC=function(t){var e=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_ARC",e._Type=this.data.readUInt8(0),e.CenterX=this.data.readInt32LE(1),e.CenterY=this.data.readInt32LE(5),e.Axis1X=this.data.readInt32LE(9),e.Axis1Y=this.data.readInt32LE(13),e.Axis2X=this.data.readInt32LE(17),e.Axis2Y=this.data.readInt32LE(21)},e.record.SHAPE_COMPONENT_CURVE=function(t){var a=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_CURVE",a._Count=this.data.readUInt32LE(0),a._Points=[];for(var n={value:4},i=0;i<a._Count;i++)a._Points[i]={},a._Points[i]._X=this.data.readInt32LE(n.value),n.value+=4,a._Points[i]._Y=this.data.readInt32LE(n.value),n.value+=4;a._Count--,a._Types=[];for(var r=0;r<a._Count;r++)a._Types[r]={},a._Types[r].value=this.data.readUInt8(n.value),void 0!==e.enum.SegmentType[a._Types[r].value]&&(a._Types[r].value=e.enum.SegmentType[a._Types[r].value]),n.value+=1;a._Count++},e.record.LIST_DRAWTEXT=function(t){var e=this.attr={};this.data=t,this.name="LIST_DRAWTEXT",e._Unknown1=this.data.readUInt16LE(0),e.TextMargin={},e.TextMargin.Left=this.data.readUInt16LE(2),e.TextMargin.Right=this.data.readUInt16LE(4),e.TextMargin.Top=this.data.readUInt16LE(6),e.TextMargin.Bottom=this.data.readUInt16LE(8),e.LastWidth=this.data.readUInt32LE(10)},e.record.EQEDIT=function(t){var e,a=this.attr={};this.data=t,this.name="EQEDIT",e=this.data.slice(0,4),a.LineMode=!!(1&e[0]),a.Script={},e=this.data.readUInt16LE(4);var n={value:6};for(a.Script.value="";e-- >0;)a.Script.value+=String.fromCharCode(this.data.readUInt16LE(n.value)),n.value+=2;for(a.BaseUnit=this.data.readUInt32LE(n.value),n.value+=4,a.TextColor=this.data.readUInt32LE(n.value),n.value+=4,a.BaseLine=this.data.readInt16LE(n.value),n.value+=2,a._unknown=this.data.readInt16LE(n.value),n.value+=2,e=this.data.readUInt16LE(n.value),n.value+=2,a.Version="";e-- >0;)a.Version+=String.fromCharCode(this.data.readUInt16LE(n.value)),n.value+=2},e.record.SHAPE_COMPONENT_PICTURE=function(t){this.attr={},this.data=t,this.name="SHAPE_COMPONENT_PICTURE"},e.record.SHAPE_COMPONENT_OLE=function(t){var a,n=this.attr={};this.data=t,this.name="SHAPE_COMPONENT_OLE",a=this.data.slice(0,4),n._DVASPECT=a[0],n.HasMoniker=!!(1&a[1]),n.EqBaseLine=(254&a[1])>>1,n.ObjetType=63&a[2],void 0!==e.enum.ObjetType[n.ObjetType]&&(n.ObjetType=e.enum.ObjetType[n.ObjetType]);var i={value:4};1&n._DVASPECT&&(n.DrawAspect="Content"),2&n._DVASPECT&&(n.DrawAspect="ThumbNail"),4&n._DVASPECT&&(n.DrawAspect="Icon"),8&n._DVASPECT&&(n.DrawAspect="DocPrint"),n.ExtentX=this.data.readInt32LE(i.value),i.value+=4,n.ExtentY=this.data.readInt32LE(i.value),i.value+=4,n.BinItem=this.data.readUInt16LE(i.value),i.value+=2,n.LineShape={}},e.record.SHAPE_COMPONENT_TEXTART=function(t){this.attr={},this.data=t,this.name="SHAPE_COMPONENT_TEXTART"},e.record.PAGE_DEF=function(t){var a,n=this.attr={};this.data=t,this.name="PAGE_DEF",n.Width=this.data.readUInt32LE(0),n.Height=this.data.readUInt32LE(4),n.PageMargin={},n.PageMargin.Left=this.data.readUInt32LE(8),n.PageMargin.Right=this.data.readUInt32LE(12),n.PageMargin.Top=this.data.readUInt32LE(16),n.PageMargin.Bottom=this.data.readUInt32LE(20),n.PageMargin.Header=this.data.readUInt32LE(24),n.PageMargin.Footer=this.data.readUInt32LE(28),n.PageMargin.Gutter=this.data.readUInt32LE(32),a=this.data.slice(36,40),n.Landscape=1&a[0],n.GutterType=(6&a[0])>>1,void 0!==e.enum.GutterType[n.GutterType]&&(n.GutterType=e.enum.GutterType[n.GutterType])},e.record.FOOTNOTE_SHAPE=function(t){var a,n=this.attr={};this.data=t,this.name="FOOTNOTE_SHAPE",n.AutoNumFormat={},n.NoteLine={},n.NoteSpacing={},n.NoteNumbering={},n.NotePlacement={},a=this.data.slice(0,4),n.AutoNumFormat.Type=a[0],void 0!==e.enum.NumberType2[n.AutoNumFormat.Type]&&(n.AutoNumFormat.Type=e.enum.NumberType2[n.AutoNumFormat.Type]),n.NotePlacement.Place=3&a[1],n.NoteNumbering.Type=(12&a[1])>>2,void 0!==e.enum.NoteNumberingType[n.NoteNumbering.Type]&&(n.NoteNumbering.Type=e.enum.NoteNumberingType[n.NoteNumbering.Type]),n.AutoNumFormat.Superscript=!!((16&a[1])>>4),n.NotePlacement.BeneathText=!!((32&a[1])>>5),n.AutoNumFormat.UserChar=this.data.readUInt16LE(4),n.AutoNumFormat.UserChar?n.AutoNumFormat.UserChar=String.fromCharCode(n.AutoNumFormat.UserChar):n.AutoNumFormat.UserChar=null,n.AutoNumFormat.PrefixChar=this.data.readUInt16LE(6),n.AutoNumFormat.PrefixChar?n.AutoNumFormat.PrefixChar=String.fromCharCode(n.AutoNumFormat.PrefixChar):n.AutoNumFormat.PrefixChar=null,n.AutoNumFormat.SuffixChar=this.data.readUInt16LE(8),n.AutoNumFormat.SuffixChar?n.AutoNumFormat.SuffixChar=String.fromCharCode(n.AutoNumFormat.SuffixChar):n.AutoNumFormat.SuffixChar=null,n.NoteNumbering.NewNumber=this.data.readUInt16LE(10),n.NoteLine.Length=this.data.readInt32LE(12),n.NoteSpacing.AboveLine=this.data.readUInt16LE(16),n.NoteSpacing.BelowLine=this.data.readUInt16LE(18),n.NoteSpacing.BetweenNotes=this.data.readUInt16LE(20),n.NoteLine.Type=this.data.readUInt8(22),void 0!==e.enum.LineType1[n.NoteLine.Type]&&(n.NoteLine.Type=e.enum.LineType1[n.NoteLine.Type]),n.NoteLine.Width=this.data.readUInt8(23),void 0!==e.enum.LineWidth[n.NoteLine.Width]&&(n.NoteLine.Width=e.enum.LineWidth[n.NoteLine.Width]),n.NoteLine.Color=this.data.readUInt32LE(24)},e.record.PAGE_BORDER_FILL=function(t){var a,n=this.attr={};this.data=t,this.name="PAGE_BORDER_FILL",a=this.data.slice(0,4),n.TextBorder=!!(1&a[0]),n.HeaderInside=!!((2&a[0])>>1),n.FooterInside=!!((4&a[0])>>2),n.FillArea=(24&a[0])>>3,void 0!==e.enum.FillAreaType[n.FillArea]&&(n.FillArea=e.enum.FillAreaType[n.FillArea]),n.PageOffset={},n.PageOffset.Left=this.data.readUInt16LE(4),n.PageOffset.Right=this.data.readUInt16LE(6),n.PageOffset.Top=this.data.readUInt16LE(8),n.PageOffset.Bottom=this.data.readUInt16LE(10),n.BorderFill=this.data.readUInt16LE(12)},e.record.MEMO_LIST=function(t){this.attr={},this.data=t,this.name="MEMO_LIST"},e.tag.table=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DOCUMENT_PROPERTIES","ID_MAPPINGS","BIN_DATA","FACE_NAME","BORDER_FILL","CHAR_SHAPE","TAB_DEF","NUMBERING","BULLET","PARA_SHAPE","STYLE","DOC_DATA","DISTRIBUTE_DOC_DATA",null,"COMPATIBLE_DOCUMENT","LAYOUT_COMPATIBILITY",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"PARA_HEADER","PARA_TEXT","PARA_CHAR_SHAPE","PARA_LINE_SEG","PARA_RANGE_TAG","CTRL_HEADER","LIST_HEADER","PAGE_DEF","FOOTNOTE_SHAPE","PAGE_BORDER_FILL","SHAPE_COMPONENT","TABLE","SHAPE_COMPONENT_LINE","SHAPE_COMPONENT_RECTANGLE","SHAPE_COMPONENT_ELLIPSE","SHAPE_COMPONENT_ARC","SHAPE_COMPONENT_POLYGON","SHAPE_COMPONENT_CURVE","SHAPE_COMPONENT_OLE","SHAPE_COMPONENT_PICTURE","SHAPE_COMPONENT_CONTAINER","CTRL_DATA","EQEDIT",null,"SHAPE_COMPONENT_TEXTART","FORM_OBJECT","MEMO_SHAPE","MEMO_LIST","FORBIDDEN_CHAR","CHART_DATA",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"SHAPE_COMPONENT_UNKNOWN"];var n=function(){this.children=[]},i=function(t){t+="";for(var e,a=!1,n="",i=0;i<t.length;i++)((e=t.charCodeAt(i))<32||e>127)&&(e<12593||e>12643)&&(e<44032||e>55203)?n+="&#"+e+";":" "==t[i]&&a?n+="&#32;":'"'==t[i]?n+="&quot;":"&"==t[i]?n+="&amp;":"<"==t[i]?n+="&lt;":">"==t[i]?n+="&gt;":n+=t[i],a=" "==t[i];return n};n.prototype.value=null,n.prototype.offset=0,n.prototype.getEncodedValue=function(t){if(null==this.value)return null;if("base64"===this.encoding)return i(Buffer.from(this.value,"utf16le").toString("base64"));if(this.children.length>0){var e=0,a="";return this.children.forEach((function(n){a+=i(this.value.slice(e,n.offset)),a+=t(n,"",""),e=n.offset}),this),a+i(this.value.slice(e))}return i(this.value)},n.prototype.toHML=function(t){return function e(a,n,r){var s,l,h="",o=a.getEncodedValue(e);for(l in"HWPML"==a.name&&(h+=n+'<?xml version="1.0" encoding="UTF-8" standalone="no" ?>\n'),h+=n+"<"+a.name,a.attr)null!=a.attr[l]&&(h+=" "+l+'="'+i(a.attr[l])+'"');if(a.children&&a.children.length>0){for(h+=">"+r,s=0;s<a.children.length;s++)h+=e(a.children[s],t?n+"  ":"",r);o&&(h+=o),h+=n+"</"+a.name+">"+r}else h+=null!=o?">"+o+"</"+a.name+">"+r:"/>"+r;return h}(this,"",t?"\n":"")},n.prototype.add=function(t){this.children.push(t),this.setCount()};var r=function(t,e,a){void 0===t.attr[e]&&console.warn("Warning [%s]: unexpected attr %s",t.name,e),t.attr[e]=a};for(var s in n.prototype.setAttrWithFilter=function(t,e){for(var a in e=e.bind(t),t)"_"!=a[0]&&"object"!=typeof t[a]&&e(a)&&r(this,a,t[a])},n.prototype.setAttr=function(t,e){if(e)e.forEach((function(e){r(this,e,t[e])}),this);else for(var a in t)"_"!=a[0]&&"object"!=typeof t[a]&&r(this,a,t[a])},n.prototype.setCount=function(){"Count"in this.attr&&(this.attr.Count=this.children.length)},n.prototype.getChild=function(t){t=t.toUpperCase();for(var a=0;a<this.children.length;a++)if(this.children[a].name===t)return this.children[a];var n=new e.node[t];return this.add(n),n},n.prototype.go=n.prototype.findChild=function(t){t=t.toUpperCase();for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},n.prototype.findChildren=function(t){return t=t.toUpperCase(),this.children.filter((function(e){return e.name===t}))},n.prototype.getChildWith=function(t,a,n){t=t.toUpperCase();for(var i=0;i<this.children.length;i++)if(this.children[i].name===t&&this.children[i].attr[a]===n)return this.children[i];var r=new e.node[t];return r.attr[a]=n,this.add(r),r},n.prototype.findChildWith=function(t,e,a){t=t.toUpperCase();for(var n=0;n<this.children.length;n++)if(this.children[n].name===t&&this.children[n].attr[e]===a)return this.children[n];return null},e.node)e.node[s].prototype=new n;var l=function(){};for(s in l.prototype.toString=function(){return function t(e,n){var i=n+e.name+" | "+a(e.data);return e.children&&e.children.forEach((function(e){i+="\n"+t(e,n+"\t")})),i}(this,"")},e.record)e.record[s].prototype=new l;var h=function(t,e){var a=e.readUInt32LE(t);t+=4,this.tag=1023&a,this.level=a>>10&1023,this.size=a>>20,4095==this.size&&(this.size=e.readUInt32LE(t),t+=4),this.data=e.slice(t,t+this.size),this._offset=t+this.size};h.prototype.resolve=function(t){var n,i=e.tag.table[this.tag];if(!i)return console.warn("Warning [%s]: unknown tag %d",t&&t.name||"(ROOT)",this.tag),this.children=[],this;if(!e.record[i])throw new Error("Non-existing record type: "+i);try{n=new e.record[i](this.data)}catch(t){throw console.error("Tag: %s",i),console.error("Data: %s",a(this.data)),t}return n.children=[],n},e.record.getTree=function(t,e){for(var a,n=[];t<e.length;)t=(a=new h(t,e))._offset,n.push(a);for(var i,r=n[0],s=r.resolve(),l=[s],o=1;o<n.length;o++)if(0==(a=n[o]).level)s=(r=a).resolve(),l.push(s);else{for(;r.level>=a.level;)if(r=r.parent,i=s.parent,delete s.parent,s=i,!r)throw new Error("Invalid record root!");i=a.resolve(s),s.children.push(i),a.parent=r,i.parent=s,r=a,s=i}return l},e.enum.get=function(t,a){return e.enum[t][a]?e.enum[t][a]:a},t.exports=e},122:(t,e,a)=>{var n=a(781),i=["write","end","destroy"],r=["resume","pause"],s=["data","close"],l=Array.prototype.slice;function h(t,e){if(t.forEach)return t.forEach(e);for(var a=0;a<t.length;a++)e(t[a],a)}t.exports=function(t,e){var a=new n,o=!1;return h(i,(function(e){a[e]=function(){return t[e].apply(t,arguments)}})),h(r,(function(t){a[t]=function(){a.emit(t);var n=e[t];if(n)return n.apply(e,arguments);e.emit(t)}})),h(s,(function(t){e.on(t,(function(){var e=l.call(arguments);e.unshift(t),a.emit.apply(a,e)}))})),e.on("end",(function(){if(!o){o=!0;var t=l.call(arguments);t.unshift("end"),a.emit.apply(a,t)}})),t.on("drain",(function(){a.emit("drain")})),t.on("error",d),e.on("error",d),a.writable=t.writable,a.readable=e.readable,a;function d(t){a.emit("error",t)}}},704:(t,e,a)=>{var n=a(781).Stream,i=e,r=a(547),s=a(795),l=a(122),h=a(508),o=a(549),d=a(563),u=a(815),c=global.setImmediate||process.nextTick;i.Stream=n,i.through=r,i.from=s,i.duplex=l,i.map=h,i.pause=o,i.split=d,i.pipeline=i.connect=i.pipe=u,i.concat=i.merge=function(){var t=[].slice.call(arguments);1===t.length&&t[0]instanceof Array&&(t=t[0]);var e=new n;e.setMaxListeners(0);var a=0;return e.writable=e.readable=!0,t.length?t.forEach((function(n){n.pipe(e,{end:!1});var i=!1;n.on("end",(function(){i||(i=!0,++a==t.length&&e.emit("end"))}))})):process.nextTick((function(){e.emit("end")})),e.write=function(t){this.emit("data",t)},e.destroy=function(){t.forEach((function(t){t.destroy&&t.destroy()}))},e},i.writeArray=function(t){if("function"!=typeof t)throw new Error("function writeArray (done): done must be function");var e=new n,a=[],i=!1;return e.write=function(t){a.push(t)},e.end=function(){i=!0,t(null,a)},e.writable=!0,e.readable=!1,e.destroy=function(){e.writable=e.readable=!1,i||t(new Error("destroyed before end"),a)},e},i.readArray=function(t){var e=new n,a=0,i=!1,r=!1;if(e.readable=!0,e.writable=!1,!Array.isArray(t))throw new Error("event-stream.read expects an array");return e.resume=function(){if(!r){i=!1;for(var n=t.length;a<n&&!i&&!r;)e.emit("data",t[a++]);a!=n||r||(r=!0,e.readable=!1,e.emit("end"))}},process.nextTick(e.resume),e.pause=function(){i=!0},e.destroy=function(){r=!0,e.emit("close")},e},i.readable=function(t,e){var a=new n,i=0,r=!1,s=!1,l=!1;if(a.readable=!0,a.writable=!1,"function"!=typeof t)throw new Error("event-stream.readable expects async function");function h(n,o){n?(a.emit("error",n),e||a.emit("end")):arguments.length>1&&a.emit("data",o),c((function(){if(!(s||r||l))try{l=!0,t.call(a,i++,(function(){l=!1,h.apply(null,arguments)}))}catch(t){a.emit("error",t)}}))}return a.on("end",(function(){s=!0})),a.resume=function(){r=!1,h()},process.nextTick(h),a.pause=function(){r=!0},a.destroy=function(){a.emit("end"),a.emit("close"),s=!0},a},i.mapSync=function(t){return i.through((function(e){var a;try{a=t(e)}catch(t){return this.emit("error",t)}void 0!==a&&this.emit("data",a)}))},i.log=function(t){return i.through((function(e){[].slice.call(arguments),t?console.error(t,e):console.error(e),this.emit("data",e)}))},i.child=function(t){return i.duplex(t.stdin,t.stdout)},i.parse=function(t){var e=!(!t||!t.error);return i.through((function(t){var a;try{t&&(a=JSON.parse(t.toString()))}catch(a){return e?this.emit("error",a):console.error(a,"attempting to parse:",t)}void 0!==a&&this.emit("data",a)}))},i.stringify=function(){var t=a(300).Buffer;return i.mapSync((function(e){return JSON.stringify(t.isBuffer(e)?e.toString():e)+"\n"}))},i.replace=function(t,e){return i.pipeline(i.split(t),i.join(e))},i.join=function(t){if("function"==typeof t)return i.wait(t);var e=!0;return i.through((function(a){return e||this.emit("data",t),e=!1,this.emit("data",a),!0}))},i.wait=function(t){var e=[];return i.through((function(t){e.push(t)}),(function(){var a=Buffer.isBuffer(e[0])?Buffer.concat(e):e.join("");this.emit("data",a),this.emit("end"),t&&t(null,a)}))},i.pipeable=function(){throw new Error("[EVENT-STREAM] es.pipeable is deprecated")}},795:(t,e,a)=>{"use strict";var n=a(781);t.exports=function t(e){if(Array.isArray(e)){var a=0,i=e.length;return t((function(t){return a<i?this.emit("data",e[a++]):this.emit("end"),!0}))}var r=new n,s=0;function l(){if(r.started=!0,!r.ended)for(;!r.ended&&!r.paused&&e.call(r,s++,(function(){r.ended||r.paused||process.nextTick(l)})););}return r.ended=!1,r.started=!1,r.readable=!0,r.writable=!1,r.paused=!1,r.ended=!1,r.pause=function(){r.started=!0,r.paused=!0},r.resume=function(){r.started=!0,r.paused=!1,l()},r.on("end",(function(){r.ended=!0,r.readable=!1,process.nextTick(r.destroy)})),r.destroy=function(){r.ended=!0,r.emit("close")},process.nextTick((function(){r.started||r.resume()})),r}},508:(t,e,a)=>{var n=a(781).Stream;t.exports=function(t,e){var a=new n,i=0,r=0,s=!1,l=!1,h=!1,o=0,d=!1,u=(e=e||{}).failures?"failure":"error",c={};function E(t,e){var n=o+1;if(e===n?(void 0!==t&&a.emit.apply(a,["data",t]),o++,n++):c[e]=t,c.hasOwnProperty(n)){var h=c[n];return delete c[n],E(h,n)}r++,i===r&&(l&&(l=!1,a.emit("drain")),s&&p())}function T(t,n,i){h||(d=!0,t&&!e.failures||E(n,i),t&&a.emit.apply(a,[u,t]),d=!1)}function p(t){if(s=!0,a.writable=!1,void 0!==t)return E(t,i);i==r&&(a.readable=!1,a.emit("end"),a.destroy())}return a.writable=!0,a.readable=!0,a.write=function(e){if(s)throw new Error("map stream is not writable");d=!1,i++;try{var a=(n=e,r=i,h=T,t.call(null,n,(function(t,e){h(t,e,r)})));return!(l=!1===a)}catch(t){if(d)throw t;return T(t),!l}var n,r,h},a.end=function(t){s||p(t)},a.destroy=function(){s=h=!0,a.writable=a.readable=l=!1,process.nextTick((function(){a.emit("close")}))},a.pause=function(){l=!0},a.resume=function(){l=!1},a}},549:(t,e,a)=>{t.exports=a(547)},563:(t,e,a)=>{var n=a(547),i=a(576).StringDecoder;t.exports=function(t,e,a){var r=new i,s="",l=a&&a.maxLength,h=!a||!1!==a.trailing;function o(t,a){if(e){try{a=e(a)}catch(e){return t.emit("error",e)}void 0!==a&&t.queue(a)}else t.queue(a)}function d(e,a){var n=((null!=s?s:"")+a).split(t);if(s=n.pop(),l&&s.length>l)return e.emit("error",new Error("maximum buffer reached"));for(var i=0;i<n.length;i++)o(e,n[i])}return"function"==typeof t&&(e=t,t=null),t||(t=/\r?\n/),n((function(t){d(this,r.write(t))}),(function(){r.end&&d(this,r.end()),h&&null!=s&&o(this,s),this.queue(null)}))}},815:(t,e,a)=>{var n=a(122),i=a(547);t.exports=function(){var t;if(0==(t=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:[].slice.call(arguments)).length)return i();if(1==t.length)return t[0];var e=t[0],a=t[t.length-1],r=n(e,a);function s(t){t.length<2||(t[0].pipe(t[1]),s(t.slice(1)))}function l(){var t=[].slice.call(arguments);t.unshift("error"),r.emit.apply(r,t)}s(t);for(var h=1;h<t.length-1;h++)t[h].on("error",l);return r}},547:(t,e,a)=>{var n=a(781);function i(t,e,a){t=t||function(t){this.queue(t)},e=e||function(){this.queue(null)};var i=!1,r=!1,s=[],l=!1,h=new n;function o(){for(;s.length&&!h.paused;){var t=s.shift();if(null===t)return h.emit("end");h.emit("data",t)}}function d(){h.writable=!1,e.call(h),!h.readable&&h.autoDestroy&&h.destroy()}return h.readable=h.writable=!0,h.paused=!1,h.autoDestroy=!(a&&!1===a.autoDestroy),h.write=function(e){return t.call(this,e),!h.paused},h.queue=h.push=function(t){return l||(null===t&&(l=!0),s.push(t),o()),h},h.on("end",(function(){h.readable=!1,!h.writable&&h.autoDestroy&&process.nextTick((function(){h.destroy()}))})),h.end=function(t){if(!i)return i=!0,arguments.length&&h.write(t),d(),h},h.destroy=function(){if(!r)return r=!0,i=!0,s.length=0,h.writable=h.readable=!1,h.emit("close"),h},h.pause=function(){if(!h.paused)return h.paused=!0,h},h.resume=function(){return h.paused&&(h.paused=!1,h.emit("resume")),o(),h.paused||h.emit("drain"),h},h}t.exports=i,i.through=i},409:(t,e,a)=>{var n=a(147),i=a(837),r=a(704),s=a(361).EventEmitter,l=function(){};l.ole_id=[208,207,17,224,161,177,26,225],l.prototype.load=function(t){var e;for(e=0;e<8;e++)if(l.ole_id[e]!=t[e])return!1;for(this.secSize=1<<t.readInt16LE(30),this.shortSecSize=1<<t.readInt16LE(32),this.SATSize=t.readInt32LE(44),this.dirSecId=t.readInt32LE(48),this.shortStreamMax=t.readInt32LE(56),this.SSATSecId=t.readInt32LE(60),this.SSATSize=t.readInt32LE(64),this.MSATSecId=t.readInt32LE(68),this.MSATSize=t.readInt32LE(72),this.partialMSAT=new Array(109),e=0;e<109;e++)this.partialMSAT[e]=t.readInt32LE(76+4*e);return!0};var h=function(t){this._doc=t};h.SecIdFree=-1,h.SecIdEndOfChain=-2,h.SecIdSAT=-3,h.SecIdMSAT=-4,h.prototype.load=function(t,e){var a=this,n=a._doc,i=n._header;a._table=new Array(t.length*(i.secSize/4)),n._readSectors(t,(function(t){var n;for(n=0;n<t.length/4;n++)a._table[n]=t.readInt32LE(4*n);e()}))},h.prototype.getSecIdChain=function(t){for(var e=t,a=[];e!=h.SecIdEndOfChain;)a.push(e),e=this._table[e];return a};var o=function(t){this._doc=t};function d(t,e){this._doc=t,this._dirEntry=e}function u(t){s.call(this),this._filename=t,this._skipBytes=0}o.EntryTypeEmpty=0,o.EntryTypeStorage=1,o.EntryTypeStream=2,o.EntryTypeRoot=5,o.NodeColorRed=0,o.NodeColorBlack=1,o.Leaf=-1,o.prototype.load=function(t,e){var a=this;this._doc._readSectors(t,(function(t){var n=t.length/128;a._entries=new Array(n);var i=0,r=!1;for(i=0;i<n;i++){var s=128*i,l=t.readInt16LE(64+s);l&&l--;var h={name:t.toString("utf16le",s,l+s),type:t.readInt8(s+66),nodeColor:t.readInt8(s+67),left:t.readInt32LE(s+68),right:t.readInt32LE(s+72),storageDirId:t.readInt32LE(s+76),secId:t.readInt32LE(s+116),size:t.readInt32LE(s+120)};r||h.type!=o.EntryTypeRoot||(r=!0,a.root=h),a._entries[i]=h}a._buildHierarchy(a.root),e()}))},o.prototype._buildHierarchy=function(t){var e=this._getChildIds(t);for(var a in t.storages={},t.streams={},e.forEach((function(e){var a=this._entries[e],n=a.name;a.type===o.EntryTypeStorage?t.storages[n]=a:a.type===o.EntryTypeStream&&(t.streams[n]=a)}),this),t.storages)this._buildHierarchy(t.storages[a])},o.prototype._getChildIds=function(t){var e=this,a=[];return a.push(t.storageDirId),function t(n){n.left!==o.Leaf&&(a.push(n.left),t(e._entries[n.left])),n.right!==o.Leaf&&(a.push(n.right),t(e._entries[n.right]))}(e._entries[t.storageDirId]),a},d.prototype.storage=function(t){return new d(this._doc,this._dirEntry.storages[t])},d.prototype.stream=function(t){var e=this._dirEntry.streams[t];if(!e)return null;var a=this._doc,n=e.size,i=a._SAT,s=!1;n<=a._header.shortStreamMax&&(s=!0,i=a._SSAT);var l=i.getSecIdChain(e.secId);return r.readable((function(t,e){var i=this;function r(t){n-t.length<0&&(t=t.slice(0,n)),n-=t.length,i.emit("data",t),e()}t>=l.length?i.emit("end"):s?a._readShortSector(l[t],r):a._readSector(l[t],r)}))},i.inherits(u,s),u.prototype.read=function(){this._read()},u.prototype.readWithCustomHeader=function(t,e){this._skipBytes=t,this._customHeaderCallback=e,this._read()},u.prototype._read=function(){var t=[this._openFile.bind(this),this._readHeader.bind(this),this._readMSAT.bind(this),this._readSAT.bind(this),this._readSSAT.bind(this),this._readDirectoryTree.bind(this)];0!=this._skipBytes&&t.splice(1,0,this._readCustomHeader.bind(this));var e=this;!function a(n){t.length==n?e.emit("ready"):t[n]((function(t){t?e.emit("err",t):a(n+1)}))}(0)},u.prototype._openFile=function(t){var e=this;n.open(this._filename,"r",438,(function(a,n){a?e.emit("err",a):(e._fd=n,t())}))},u.prototype._readCustomHeader=function(t){var e=this,a=Buffer.alloc(this._skipBytes);n.read(e._fd,a,0,this._skipBytes,0,(function(a,n,i){a?e.emit("err",a):e._customHeaderCallback(i)&&t()}))},u.prototype._readHeader=function(t){var e=this,a=Buffer.alloc(512);n.read(this._fd,a,0,512,0+this._skipBytes,(function(a,n,i){a?e.emit("err",a):(e._header=new l).load(i)?t():e.emit("err","Not a valid compound document.")}))},u.prototype._readMSAT=function(t){var e=this,a=e._header;if(e._MSAT=a.partialMSAT.slice(0),e._MSAT.length=a.SATSize,a.SATSize<=109||0==a.MSATSize)t();else{Buffer.alloc(a.secSize);var n=0,i=a.MSATSecId;!function r(){n>=a.MSATSize?t():e._readSector(i,(function(t){var s;for(s=0;s<a.secSize-4&&!(109>=a.SATSize);s+=4)e._MSAT[109]=t.readInt32LE(s);i=t.readInt32LE(a.secSize-4),n++,r()}))}()}},u.prototype._readSector=function(t,e){this._readSectors([t],e)},u.prototype._readSectors=function(t,e){var a=this,i=a._header,r=Buffer.alloc(t.length*i.secSize),s=0;!function l(){if(s>=t.length)e(r);else{var h=s*i.secSize,o=a._getFileOffsetForSec(t[s]);n.read(a._fd,r,h,i.secSize,o,(function(t,e,n){t?a.emit("err",t):(s++,l())}))}}()},u.prototype._readShortSector=function(t,e){this._readShortSectors([t],e)},u.prototype._readShortSectors=function(t,e){var a=this,i=a._header,r=Buffer.alloc(t.length*i.shortSecSize),s=0;!function l(){if(s>=t.length)e(r);else{var h=s*i.shortSecSize,o=a._getFileOffsetForShortSec(t[s]);n.read(a._fd,r,h,i.shortSecSize,o,(function(t,e,n){t?a.emit("err",t):(s++,l())}))}}()},u.prototype._readSAT=function(t){var e=this;e._SAT=new h(e),e._SAT.load(e._MSAT,t)},u.prototype._readSSAT=function(t){var e=this,a=e._header;e._SSAT=new h(e);var n=e._SAT.getSecIdChain(a.SSATSecId);n.length==a.SSATSize?e._SSAT.load(n,t):e.emit("err","Invalid Short Sector Allocation Table")},u.prototype._readDirectoryTree=function(t){var e=this,a=e._header;e._directoryTree=new o(this);var n=e._SAT.getSecIdChain(a.dirSecId);e._directoryTree.load(n,(function(){var a=e._directoryTree.root;e._rootStorage=new d(e,a),e._shortStreamSecIds=e._SAT.getSecIdChain(a.secId),t()}))},u.prototype._getFileOffsetForSec=function(t){var e=this._header.secSize;return this._skipBytes+(t+1)*e},u.prototype._getFileOffsetForShortSec=function(t){var e=t*this._header.shortSecSize,a=this._header.secSize,n=Math.floor(e/a),i=e%a,r=this._shortStreamSecIds[n];return this._getFileOffsetForSec(r)+i},u.prototype.storage=function(t){return this._rootStorage.storage(t)},u.prototype.stream=function(t){return this._rootStorage.stream(t)},e.OleCompoundDoc=u},300:t=>{"use strict";t.exports=require("buffer")},361:t=>{"use strict";t.exports=require("events")},147:t=>{"use strict";t.exports=require("fs")},781:t=>{"use strict";t.exports=require("stream")},576:t=>{"use strict";t.exports=require("string_decoder")},837:t=>{"use strict";t.exports=require("util")},796:t=>{"use strict";t.exports=require("zlib")}},e={};function a(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,a),r.exports}(()=>{"use strict";a(147);var t=a(895),e=a(409),n=a(796),i=t.enum,r=t.node,s=t.record,l=function(t,e){t(new Error(e))},h=function(t,e){l(t,e?"TODO: "+e:"TODO")},o=function(t,e){var a=[];t.on("error",(function(t){e(t)})),t.on("data",(function(t){a.push(t)})),t.on("end",(function(){var t=a;a=null,e(null,Buffer.concat(t))}))},d=function(t,e,a){o(e,(function(e,i){e?a(e):t.compressed?n.inflateRaw(i,(function(t,e){t?a(t):a(null,e)})):a(null,i)}))},u=function(t,e,a){for(var n="",i=e;i<e+a;i+=2)n+=String.fromCharCode(t.readUInt16LE(i));return n},c=e.OleCompoundDoc,E=function(){this._doc=null,this._hml=null,this._hwp_meta=null,this._hwp5_records={}};E.debug=!1,E.prototype._loaded=!1,E.prototype._loading=!1;var T=function(){E.debug&&console.warn.apply(console,arguments)};E.prototype.loadFromHWP=function(t,e,a){var n=this;if(this._loaded||this._loading)l(e,"HWP document is alreadly loaded!");else{this._loading=!0;var i=function(t){n._loading=!1,e(t)};this._doc=new c(t),this._doc.on("err",(function(t){i(t)})),this._doc.on("ready",(function(){o(n._doc.stream("FileHeader"),(function(t,e){if(t)i(t);else if("HWP Document File"===e.toString("utf8",0,17)){n._hml=new r.HWPML;var s,o=e.readUInt32LE(32),d={};d.version=[o>>24,255&o>>16,255&o>>8,255&o],s=e.readUInt32LE(36),d.compressed=!!(1&s),d.encrypted=!!(2&s),d.distributed=!!(4&s),d.encrypted||d.distributed?h(i,"Can't open "+(d.encrypted?"encrypted":"distributed")+" HWP file."):(n._hwp_meta=d,n._setHead((function(t){t?i(t):n._setBody((function(t){t?i(t):n._setTail((function(t){t?i(t):(n._loaded=!0,i(null))}),a)}),a)}),a))}else l(i,"Invalid header string!")}))})),this._doc.read()}};var p=function(t){var e=t.attr.FillBrush;if(!e)return null;var a,n=new r.FILLBRUSH,i=null;if(e.WindowBrush&&(i=new r.WINDOWBRUSH).setAttr(e.WindowBrush),e.Gradation)for((i=new r.GRADATION).setAttr(e.Gradation),a=0;a<e.Gradation.ColorNum;a++){var s=new r.COLOR;s.attr.Value=e.Gradation._Colors[a].value,i.add(s)}return i&&n.add(i),n.children.length>0?n:null};E.prototype._setHead=function(t,e){if(this._hml&&!this._hml.findChild("HEAD")){var a=this._hwp_meta,n=this._hml.getChild("HEAD"),h=this,c=n.getChild("DOCSUMMARY");!function(t,e){o(t,(function(t,a){if(t)e(t);else{for(var n,i,r,s,l={},h=a.readUInt32LE(52),o=0;o<h;o++){switch(n=a.readUInt32LE(56+8*o),i=a.readUInt32LE(60+8*o)+48,a.readUInt32LE(i)){case 1:s=null;break;case 2:s=a.readInt16LE(i+4);break;case 18:s=a.readUInt16LE(i+4);break;case 3:case 10:case 19:s=a.readUInt32LE(i+4);break;case 8:case 30:r=a.readUInt32LE(i+4),s=a.toString("ascii",i+8,i+8+r-1);break;case 65:r=a.readUInt32LE(i+4),s=a.slice(i+8,i+8+r);break;case 31:r=a.readUInt32LE(i+4),"\0"===(s=u(a,i+8,2*r))[s.length-1]&&(s=s.slice(0,-1));break;case 64:s=a.readUInt32LE(i+4)/1e7,s+=429.4967296*a.readUInt32LE(i+8),s-=11644473600,s=new Date(1e3*s)}l[n]=s}e(null,l)}}))}(this._doc.stream("HwpSummaryInformation"),(function(l,o){if(l)t(l);else{var u=function(t){return t&&!t.match(/^(?:[\r\n])*$/)};u(o[2])&&(c.getChild("TITLE").value=o[2]),u(o[3])&&(c.getChild("SUBJECT").value=o[3]),u(o[4])&&(c.getChild("AUTHOR").value=o[4]),u(o[20])&&(c.getChild("DATE").value=o[20]),u(o[5])&&(c.getChild("KEYWORDS").value=o[5]),u(o[6])&&(c.getChild("COMMENTS").value=o[6]);var E=n.getChild("DOCSETTING");d(a,h._doc.stream("DocInfo"),(function(a,l){try{if(a)return void t(a);var o=s.getTree(0,l);e.saveTree&&(h._hwp5_records.docInfo=o),o.forEach((function(t){var e;switch(t.name){case"DOCUMENT_PROPERTIES":n.attr.SecCnt=t.attr.SecCnt,E.getChild("BEGINNUMBER").setAttr(t.attr.BeginNumber),E.getChild("CARETPOS").setAttr(t.attr.CaretPos);break;case"ID_MAPPINGS":var a,s,l=n.getChild("MAPPINGTABLE"),h=t.attr.FontCount.map((function(t){return t.value})),o=0,d=0,u=1,c=0,f=0,S=1,m=0,A=0;t.children.forEach((function(t){switch(t.name){case"BIN_DATA":a=l.getChild("BINDATALIST"),e=new r.BINITEM,a.add(e),e.setAttr(t.attr);break;case"FACE_NAME":for(a=l.getChild("FACENAMELIST");o<6&&h[o]==d;)o++,d=0;var E=a.getChildWith("FONTFACE","Lang",i.LangType[o]);(e=new r.FONT).attr.Id=d++,E.add(e),e.attr.Name=t.attr.Name,e.attr.Type=t.attr.Type,t.attr.SubstFont&&e.getChild("SUBSTFONT").setAttr(t.attr.SubstFont),t.attr.TypeInfo&&e.getChild("TYPEINFO").setAttr(t.attr.TypeInfo);break;case"BORDER_FILL":a=l.getChild("BORDERFILLLIST"),(e=new r.BORDERFILL).attr.Id=u++,a.add(e),e.setAttr(t.attr),e.getChild("LEFTBORDER").setAttr(t.attr.LeftBorder),e.getChild("RIGHTBORDER").setAttr(t.attr.RightBorder),e.getChild("TOPBORDER").setAttr(t.attr.TopBorder),e.getChild("BOTTOMBORDER").setAttr(t.attr.BottomBorder),e.getChild("DIAGONAL").setAttr(t.attr.Diagonal);var I=p(t);I&&e.add(I);break;case"CHAR_SHAPE":for(a=l.getChild("CHARSHAPELIST"),(e=new r.CHARSHAPE).attr.Id=c++,a.add(e),e.setAttr(t.attr,"Height TextColor ShadeColor UseFontSpace UseKerning SymMark BorderFillId".split(" ")),s=0;s<7;s++)e.getChild("FONTID").attr[i.LangType[s]]=t.attr._FontIDs[s].value,e.getChild("RATIO").attr[i.LangType[s]]=t.attr._FontRatios[s].value,e.getChild("CHARSPACING").attr[i.LangType[s]]=t.attr._FontCharSpacings[s].value,e.getChild("RELSIZE").attr[i.LangType[s]]=t.attr._FontRelSizes[s].value,e.getChild("CHAROFFSET").attr[i.LangType[s]]=t.attr._FontCharOffsets[s].value;t.attr._Italic&&e.getChild("ITALIC"),t.attr._Bold&&e.getChild("BOLD"),null!=t.attr.Underline.Type&&("Center"==t.attr.Underline.Type&&null!=t.attr.Strikeout.Type&&"None"!=t.attr.Strikeout.Type&&t.attr.Underline.Color==t.attr.Strikeout.Color&&t.attr.Underline.Shape==t.attr.Strikeout.Shape||e.getChild("UNDERLINE").setAttr(t.attr.Underline)),null!=t.attr.Strikeout.Type&&"None"!=t.attr.Strikeout.Type&&e.getChild("STRIKEOUT").setAttr(t.attr.Strikeout),null!=t.attr.Shadow.Type&&e.getChild("SHADOW").setAttr(t.attr.Shadow),t.attr._Emboss&&e.getChild("EMBOSS"),t.attr._Engrave&&e.getChild("ENGRAVE"),t.attr._SuperScript&&e.getChild("SUPERSCRIPT"),t.attr._SubScript&&e.getChild("SUBSCRIPT");break;case"TAB_DEF":a=l.getChild("TABDEFLIST"),(e=new r.TABDEF).attr.Id=f++,a.add(e),e.setAttr(t.attr,"AutoTabLeft AutoTabRight".split(" "));break;case"NUMBERING":for(a=l.getChild("NUMBERINGLIST"),(e=new r.NUMBERING).attr.Id=S++,a.add(e),e.setAttr(t.attr,["Start"]),s=0;s<7;s++){var L=new r.PARAHEAD;L.attr.Level=s+1,L.setAttrWithFilter(t.attr.ParaHeads[s],(function(t){return"value"!=t})),L.value=t.attr.ParaHeads[s].value,e.add(L)}break;case"PARA_SHAPE":a=l.getChild("PARASHAPELIST"),(e=new r.PARASHAPE).attr.Id=m++,a.add(e),e.setAttr(t.attr),e.getChild("PARAMARGIN").setAttr(t.attr.ParaMargin),e.getChild("PARABORDER").setAttr(t.attr.ParaBorder);break;case"STYLE":a=l.getChild("STYLELIST"),(e=new r.STYLE).attr.Id=A++,a.add(e),e.setAttr(t.attr);break;case"FORBIDDEN_CHAR":for(e=new r.FORBIDDENSTRING,s=0;s<4;s++){var g=new r.FORBIDDEN;g.attr.Id=s,g.value=t.attr["_f"+s],e.add(g)}n.add(e);break;default:console.warn("Warning [head>mapping]: not processing record %s",t.name),T(t.toString())}}));break;case"COMPATIBLE_DOCUMENT":break;default:console.warn("Warning [head]: not processing record %s",t.name),T(t.toString())}})),t(null)}catch(e){t(e)}}))}}))}else l(t,"Invalid _setHead invocation!")},E.prototype._setBody=function(t,e){if(this._hml&&!this._hml.findChild("BODY")){var a=this._hml.getChild("BODY"),n=this._hml.getChild("HEAD").attr.SecCnt;try{e.saveTree&&(this._hwp5_records.sections=[]),this._setSections(a,this._doc.storage("BodyText"),0,n,t,e)}catch(e){return void t(e)}}else l(t,"Invalid _setBody invocation!")},E.prototype._setSections=function(t,e,a,n,i,l){var h=this;a!=n?d(this._hwp_meta,e.stream("Section"+a),(function(o,d){try{if(o)return void i(o);var u=new r.SECTION,c=s.getTree(0,d);l.saveTree&&h._hwp5_records.sections.push(c),u.attr.Id=a,h._getHMLs(u,c),t.add(u),h._setSections(t,e,a+1,n,i)}catch(t){return void i(t)}})):i(null)},E.prototype._getHMLs=function(t,e){e.forEach((function(e){var a=this._getHML(t,e);a&&t.add(a)}),this)};var f={9:"TAB",10:"LINEBREAK",24:"HYPEN",30:"NBSPACE",31:"FWSPACE"},S={};!function(){for(var t in f)S[f[t]]=!0}(),E.prototype._getHML=function(t,e){var a=null;switch(e.name){case"PARA_HEADER":(a=new r.P).setAttr(e.attr,"ParaShape Style PageBreak ColumnBreak InstId".split(" ")),0==a.attr.InstId&&delete a.attr.InstId;var n,l,h=[],o=[],d=[],u=[],c=0;for(j=0;j<e.children.length;j++)"CTRL_HEADER"==(l=(n=e.children[j]).name)?(o[n.attr._Type]||(o[n.attr._Type]=[]),o[n.attr._Type].push(n),d[n.attr._Type]=0):"PARA_RANGE_TAG"==l?n.attr._Data.forEach((function(t){u.push([t.start,t.data>>24,!0,16777215&t.data]),u.push([t.end,t.data>>24,!1,16777215&t.data])})):(h[l]||(h[l]=[]),h[l].push(n));if(u.sort((function(t,e){return t[0]-e[0]})),!h.PARA_TEXT)break;if(!h.PARA_CHAR_SHAPE||h.PARA_CHAR_SHAPE.length>1||h.PARA_TEXT.length>1)throw new Error("TODO: Other than 1 PARA_TEXT or CHAR_SHAPE");var E,m,A,I,L,g,C=null,v=h.PARA_TEXT[0].text,O=0,N=h.PARA_CHAR_SHAPE[0].values,y=0,R=[],P=function(t,e,a){for(;c<u.length;){var n=null,i=u[c],s=i[0]-O;if(s<e)console.warn("Warning [text]: out-of-range (too early) range tag");else{if(s>a)break;2===i[1]?i[2]?(n=new r.MARKPENBEGIN).attr.Color=i[3]:n=new r.MARKPENEND:console.warn("Warning [text]: not processing range tag %d",u[c][1]),n&&(n.offset=s-e,t.add(n)),c++}}},_=function(t){if(C){var e=null;R.forEach((function(t){null==e&&"CHAR"==t.name?e=t:e?"CHAR"==t.name?e.value+=t.value:S[t.name]?(t.offset=e.value.length,e.add(t)):(C.add(e),e=null,C.add(t)):S[t.name]?((e=new r.CHAR).value="",t.offset=0,e.add(t)):C.add(t)})),null!=e&&C.add(e)}t||(C=new r.TEXT,a.add(C),R=[])};if(0==N.length||0!=N[0].start)throw new Error("PARA_CHAR_SHAPE must have a CHAR_SHAPE starts from 0!");for(j=0;j<v.length;j++){for(L=j+1<v.length?v[j+1].start:h.PARA_TEXT[0].data.length/2;y<N.length&&N[y].start<v[j].start;)console.warn("Warning [text]: ShapeInd pointing in non-texts"),y++;switch(y<N.length&&v[j].start>=N[y].start&&(_(!1),C.attr.CharShape=N[y].charShape,y++),v[j].type){case"text":for(E=0;y<N.length&&N[y].start<L;)g=new r.CHAR,m=N[y].start-v[j].start,g.value=String.fromCharCode.apply(String,v[j].data.slice(E,m)),P(g,E,m),R.push(g),_(!1),C.attr.CharShape=N[y].charShape,y++,E=m;(g=new r.CHAR).value=String.fromCharCode.apply(String,v[j].data.slice(E)),P(g,E,v[j].data.length),R.push(g);break;case 1:case 12:case 14:case 2:case 3:case 11:case 15:case 16:case 17:case 18:case 21:case 22:case 23:if(!o[A=String.fromCharCode(v[j].data[1]>>8,255&v[j].data[1],v[j].data[0]>>8,255&v[j].data[0])]||o[A].length<=d[A]){console.error("Error [text]: control [%s] can't be found!",A);break}(I=this._getHML(C,o[A][d[A]++]))&&R.push(I);break;case 9:case 10:case 24:case 30:case 31:R.push(new r[f[v[j].type]]);break;default:console.warn("Warning [text]: not processing text %s",v[j].type)}"text"!=v[j].type&&"data"in v[j]&&(O+=v[j].data.length+2)}R.length&&_(!0),c<u.length&&(console.warn("Warning [text]: out-of-range (too late) range tag"),T(e.toString()));break;case"PAGE_DEF":(a=new r.PAGEDEF).setAttr(e.attr),a.getChild("PAGEMARGIN").setAttr(e.attr.PageMargin);break;case"FOOTNOTE_SHAPE":var B=!1;t.findChild("FOOTNOTESHAPE")?(B=!0,a=new r.ENDNOTESHAPE):a=new r.FOOTNOTESHAPE,e.attr.NotePlacement.Place=i.get((B?"End":"Foot")+"NoteShapePlaceType",e.attr.NotePlacement.Place),a.getChild("AUTONUMFORMAT").setAttr(e.attr.AutoNumFormat),a.getChild("NOTELINE").setAttr(e.attr.NoteLine),a.getChild("NOTESPACING").setAttr(e.attr.NoteSpacing),a.getChild("NOTENUMBERING").setAttr(e.attr.NoteNumbering),a.getChild("NOTEPLACEMENT").setAttr(e.attr.NotePlacement);break;case"PAGE_BORDER_FILL":var H=t.findChildren("PAGEBORDERFILL").length;(a=new r.PAGEBORDERFILL).setAttr(e.attr),a.attr.Type=i.get("PageBorderFillType",H),a.getChild("PAGEOFFSET").setAttr(e.attr.PageOffset);break;case"CTRL_HEADER":var M=null;switch(e.attr.ShapeObject&&((M=new r.SHAPEOBJECT).setAttrWithFilter(e.attr.ShapeObject,(function(t){return!("TextWrap"==t&&1==this.Position.TreatAsChar)})),M.getChild("SIZE").setAttr(e.attr.ShapeObject.Size),M.getChild("POSITION").setAttr(e.attr.ShapeObject.Position),M.getChild("OUTSIDEMARGIN").setAttr(e.attr.ShapeObject.OutsideMargin),e.attr.ShapeObject.ShapeComment.value&&(M.getChild("SHAPECOMMENT").value=e.attr.ShapeObject.ShapeComment.value)),e.attr._Type){case"secd":(a=new r.SECDEF).setAttr(e.attr),a.getChild("STARTNUMBER").setAttr(e.attr.StartNumber),a.getChild("HIDE").setAttr(e.attr.Hide),this._getHMLs(a,e.children);break;case"cold":(a=new r.COLDEF).setAttr(e.attr);break;case"pgnp":(a=new r.PAGENUM).setAttr(e.attr);break;case"tbl ":a=new r.TABLE;var U=e.children[0];if("TABLE"!=U.name){console.warn("Warning [body>control>tbl]: expected TABLE, got %s",U.name);break}a.setAttr(U.attr),a.getChild("INSIDEMARGIN").setAttr(U.attr.InsideMargin);var D,F,b,w,G,W,x,k,X,Y=1;for(j=0;j<U.attr._RowSizes.length;j++)for(x=new r.ROW,a.add(x),D=U.attr._RowSizes[j].value,F=0;F<D;F++){if("LIST_HEADER"!=(w=e.children[Y++]).name){console.warn("Warning [body>control>tbl>list]: expected LIST_HEADER, got %s",w.name);break}for(G=new s.LIST_CELL(w.data.slice(w.offset)),(k=new r.CELL).setAttr(G.attr),G.attr.HasMargin&&k.getChild("CELLMARGIN").setAttr(G.attr.CellMargin),(X=new r.PARALIST).setAttr(w.attr),x.add(k),k.add(X),b=0;b<w.attr._ParaCount;b++){if("PARA_HEADER"!=(W=e.children[Y++]).name){console.warn("Warning [body>control>tbl>list]: expected PARA_HEADER, got %s",W.name);break}X.add(this._getHML(k,W))}}break;case"gso ":a=this._getHML(t,e.children[0]);break;case"eqed":if(a=new r.EQUATION,1!=e.children.length||"EQEDIT"!=e.children[0].name){console.warn("Warning [body>control>eqed]: strange eqed");break}a.setAttr(e.children[0].attr),a.getChild("SCRIPT").value=e.children[0].attr.Script.value;break;default:console.warn("Warning [body>control]: not processing control header '%s'",e.attr._Type),T(e.toString())}M&&a&&a.children.unshift(M);break;case"SHAPE_COMPONENT":var j,z,V=null,K=new r.SHAPECOMPONENT;K.setAttr(e.attr),K.getChild("ROTATIONINFO").setAttr(e.attr.RotationInfo),(z=K.getChild("RENDERINGINFO")).getChild("TRANSMATRIX").setAttr(e.attr.RenderingInfo.TransMatrix),e.attr.RenderingInfo._ScaRotMatrices.forEach((function(t){var e=new r.SCAMATRIX,a=new r.ROTMATRIX;e.setAttr(t.ScaMatrix),a.setAttr(t.RotMatrix),z.add(e),z.add(a)}));var q=function(n,i){i||(i=function(t){a.setAttr(t.attr)}),n?V=a.getChild("DRAWINGOBJECT"):a.add(K);var l=null,h=null;e.children.forEach((function(e){switch(e.name){case"LIST_HEADER":var o=new s.LIST_DRAWTEXT(e.data.slice(e.offset));(l=new r.DRAWTEXT).setAttr(o.attr),l.getChild("TEXTMARGIN").setAttr(o.attr.TextMargin),(h=l.getChild("PARALIST")).setAttr(e.attr),V.add(l);break;case"PARA_HEADER":if(null==h){console.warn("Warning [%s>SHAPE_COMPONENT]: PARA_HEADER without LIST_HEADER",t.name);break}h.add(this._getHML(l,e));break;case"SHAPE_COMPONENT":"CONTAINER"!=a.name&&console.warn("Warning [%s>SHAPE_COMPONENT]: SHAPE_COMPONENT in %s",t.name,a.name),a.add(this._getHML(a,e));break;default:if(n&&e.name=="SHAPE_COMPONENT_"+n){i(e);break}console.warn("Warning [%s>SHAPE_COMPONENT]: not processing child record %s",t.name,e.name),T(e.toString())}}),this)}.bind(this);switch(e.children.forEach.bind(e.children),e.attr._Type){case"$lin":a=new r.LINE,q("LINE");break;case"$col":a=new r.CONNECTLINE,q("LINE",(function(t){var e=new s.SHAPE_COMPONENT_CONNECTLINE(t.data);a.setAttr(e.attr),e.attr._ControlPoints.forEach((function(t){var e=new r.CONTROLPOINT;e.setAttr(t),a.add(e)}))}));break;case"$rec":a=new r.RECTANGLE,q("RECTANGLE");break;case"$ell":a=new r.ELLIPSE,q("ELLIPSE");break;case"$arc":a=new r.ARC,q("ARC");break;case"$pol":a=new r.POLYGON,q("POLYGON",(function(t){t.attr._Points.forEach((function(t){var e=new r.POINT;e.setAttr(t),a.add(e)}))}));break;case"$cur":a=new r.CURVE,q("CURVE",(function(t){var e,n,i=t.attr;for(e=1;e<i._Count;e++)(n=new r.SEGMENT).attr.X1=i._Points[e-1]._X,n.attr.Y1=i._Points[e-1]._Y,n.attr.X2=i._Points[e]._X,n.attr.Y2=i._Points[e]._Y,n.attr.Type=i._Types[e-1].value,a.add(n)}));break;case"$con":a=new r.CONTAINER,q();break;case"$ole":a=new r.OLE,q("OLE");break;case"$pic":a=new r.PICTURE;break;default:console.warn("Warning [%s>SHAPE_COMPONENT]: not processing shape type %s",t.name,e.attr._Type),T(e.toString())}if(V){var J=[];if(J.unshift(K),e.attr.LineShape){var $=new r.LINESHAPE;$.setAttr(e.attr.LineShape),J.unshift($)}var Z=p(e);if(Z&&J.unshift(Z),e.attr.Shadow){var Q=new r.SHADOW;Q.setAttr(e.attr.Shadow),J.unshift(Q)}J.forEach((function(t){V.children.unshift(t)}))}break;default:console.warn("Warning [%s]: not processing record %s",t.name,e.name),T(e.toString())}return a},E.prototype._setTail=function(t,e){t(null)},E.prototype.loadFromHML=function(t,e,a){this._loaded||this._loading?l(e,"HWP document is alreadly loaded!"):h(e)},E.prototype.toHML=function(t){return this._loaded&&this._hml?this._hml.toHML(t):null},E.prototype.convertTo=function(t){return this._loaded&&this._hml?t(this._hml):null},global.hwp=(t,e)=>{let a=new E;a.loadFromHWP(t,(t=>{t?e(t):e(null,a)}),{type:"hwp"})}})()})();
const readHwp = function (fileName) {
    return new Promise((resolve, reject) => {
        global.hwp(fileName, (err, doc) => {
            if (err) {
                reject(err);
            }
            resolve(doc.toHML().split("</HEAD")[1].replace(/\<\/P\>/gi, "\n").replace(/\<[^\>]+\>/gi, '').replace(/\>/gi, '').replace(/\&\#[0-9]+\;/gi, "\n"));
        });
    })
}
module.exports = readHwp;




