const serviceTong = {
  "de002": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 0
      },
      {
        "serid": "s2011_aa02s",
        "case": 0
      },
      {
        "serid": "s2011_aa03s",
        "case": 0
      }
    ],
    "online": false
  },
  "de003": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 0
      },
      {
        "serid": "s2011_aa02s",
        "case": 1
      },
      {
        "serid": "s2011_aa03s",
        "case": 0
      }
    ],
    "online": false
  },
  "de045": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 1
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de039": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 2
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de047": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 2
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de001": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 3
      },
      {
        "serid": "s2011_aa02s",
        "case": 3
      },
      {
        "serid": "s2011_aa03s",
        "case": 2
      }
    ],
    "online": true
  },
  "de004": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 4
      },
      {
        "serid": "s2011_aa02s",
        "case": 3
      },
      {
        "serid": "s2011_aa03s",
        "case": 2
      }
    ],
    "online": true
  },
  "de015": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 4
      },
      {
        "serid": "s2011_aa02s",
        "case": 3
      },
      {
        "serid": "s2011_aa03s",
        "case": 2
      }
    ],
    "online": false
  },
  "de027": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 4
      },
      {
        "serid": "s2011_aa02s",
        "case": 3
      },
      {
        "serid": "s2011_aa03s",
        "case": 2
      }
    ],
    "online": false
  },
  "de043": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 4
      },
      {
        "serid": "s2011_aa02s",
        "case": 3
      },
      {
        "serid": "s2011_aa03s",
        "case": 2
      }
    ],
    "online": false
  },
  "de013": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 4
      },
      {
        "serid": "s2011_aa03s",
        "case": 3
      }
    ],
    "online": false
  },
  "de009": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de023": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de025": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de026": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 2
      },
      {
        "serid": "s2011_aa03s",
        "case": 1
      }
    ],
    "online": false
  },
  "de030": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 5
      },
      {
        "serid": "s2011_aa02s",
        "case": 5
      },
      {
        "serid": "s2011_aa03s",
        "case": 3
      }
    ],
    "online": false
  },
  "de010": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 6
      },
      {
        "serid": "s2011_aa03s",
        "case": 4
      }
    ],
    "online": true
  },
  "de021": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 7
      },
      {
        "serid": "s2011_aa03s",
        "case": 5
      }
    ],
    "online": false
  },
  "de028": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 8
      },
      {
        "serid": "s2011_aa03s",
        "case": 6
      }
    ],
    "online": false
  },
  "de006": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 7
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de034": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de041": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de046": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 6
      },
      {
        "serid": "s2011_aa02s",
        "case": 8
      },
      {
        "serid": "s2011_aa03s",
        "case": 6
      }
    ],
    "online": false
  },
  "de032": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 8
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de029": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 9
      },
      {
        "serid": "s2011_aa02s",
        "case": 10
      },
      {
        "serid": "s2011_aa03s",
        "case": 8
      }
    ],
    "online": false
  },
  "de036": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 9
      },
      {
        "serid": "s2011_aa02s",
        "case": 11
      },
      {
        "serid": "s2011_aa03s",
        "case": 9
      }
    ],
    "online": false
  },
  "de035": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 9
      },
      {
        "serid": "s2011_aa02s",
        "case": 11
      },
      {
        "serid": "s2011_aa03s",
        "case": 9
      }
    ],
    "online": false
  },
  "de040": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 12
      },
      {
        "serid": "s2011_aa02s",
        "case": 15
      },
      {
        "serid": "s2011_aa03s",
        "case": 13
      }
    ],
    "online": false
  },
  "de031": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 9
      },
      {
        "serid": "s2011_aa02s",
        "case": 12
      },
      {
        "serid": "s2011_aa03s",
        "case": 10
      }
    ],
    "online": false
  },
  "de018": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 8
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de019": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 8
      },
      {
        "serid": "s2011_aa02s",
        "case": 9
      },
      {
        "serid": "s2011_aa03s",
        "case": 7
      }
    ],
    "online": false
  },
  "de033": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 10
      },
      {
        "serid": "s2011_aa02s",
        "case": 13
      },
      {
        "serid": "s2011_aa03s",
        "case": 10
      }
    ],
    "online": false
  },
  "de014": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 10
      },
      {
        "serid": "s2011_aa02s",
        "case": 14
      },
      {
        "serid": "s2011_aa03s",
        "case": 11
      }
    ],
    "online": true
  },
  "de037": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 11
      },
      {
        "serid": "s2011_aa02s",
        "case": 13
      },
      {
        "serid": "s2011_aa03s",
        "case": 12
      }
    ],
    "online": true
  },
  "de017": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 12
      },
      {
        "serid": "s2011_aa02s",
        "case": 15
      },
      {
        "serid": "s2011_aa03s",
        "case": 13
      }
    ],
    "online": true
  },
  "de038": {
    "service": [
      {
        "serid": "s2011_aa01s",
        "case": 12
      },
      {
        "serid": "s2011_aa02s",
        "case": 15
      },
      {
        "serid": "s2011_aa03s",
        "case": 13
      }
    ],
    "online": true
  }
};

module.exports = function (tools) {
  const { Mother, Notion, Filters } = tools;
  const { mongo, mongoinfo } = Mother;
  const MONGOC = new mongo(mongoinfo, { useUnifiedTopology: true });
  return async function (tong) {
    try {
      await MONGOC.connect();
      let row, totalTong, targetRow;
      let tempObj, tempObjDetail;
      totalTong = [];
      for (let i = 0; i < tong.length; i++) {
        if (serviceTong[tong[i].desid] !== undefined) {
          tong[i].information.business.service.cost.matrix.service = serviceTong[tong[i].desid].service;
          tong[i].information.business.service.cost.matrix.online = serviceTong[tong[i].desid].online;
        }
        totalTong.push(tong[i]);
      }
      return totalTong;
    } catch (e) {
      console.log(e);
    } finally {
      await MONGOC.close();
    }
  }
}
